{"version":3,"sources":["_app.js","controllers/_controllers.js","directives/_directives.js","filters/_filters.js","services/_services.js","controllers/admin/_admin.js","controllers/error/_error.js","controllers/map/_map.js","controllers/measurements/_measurements.js","controllers/preference/_preference.js","controllers/reports/_reports.js","controllers/stories/_stories.js","services/google-analytics/_google-analytics.js","services/measurements/_measurements.js","services/preference/_preference.js","services/settings/_settings.js","services/stories/_stories.js","app.js","controllers/gma-ctrl.js","application.min.js","controllers/join-ministry-ctrl.js","directives/gma-trend-directive.js","directives/image-resizer.js","filters/mcc-filter.js","filters/role-filter.js","controllers/admin/admin-ctrl.js","controllers/error/error-ctrl.js","controllers/map/map-ctrl.js","controllers/measurements/measurement-details-ctrl.js","controllers/measurements/measurements-ctrl.js","controllers/preference/user-preference-ctrl.js","controllers/reports/reports-ctrl.js","controllers/stories/stories-ctrl.js","services/google-analytics/google-analytics-service.js","services/measurements/assignments-service.js","services/measurements/churches-service.js","services/measurements/iso-countries-service.js","services/measurements/language-service.js","services/measurements/measurement-types-service.js","services/measurements/measurements-service.js","services/measurements/ministries-service.js","services/measurements/session-service.js","services/measurements/target-city-service.js","services/measurements/trainings-service.js","services/preference/user-preference-service.js","services/settings/settings-service.js","services/stories/stories-service.js"],"names":["angular","module","run","$rootScope","$route","$location","Session","Settings","GoogleAnalytics","current","isLoaded","init","window","parent","parentHash","location","hash","path","slice","$on","reload","startSession","ticket","config","$routeProvider","$httpProvider","$compileProvider","SettingsProvider","$provide","growlProvider","$rootScopeProvider","setConfig","gma","aHrefSanitizationWhitelist","imgSrcSanitizationWhitelist","interceptors","push","digestTtl","globalPosition","globalTimeToLive","success","error","warning","info","globalDisableCountDown","forEach","routes","route","i","otherwise","redirectTo","when","templateUrl","controller","decorator","$delegate","ngModel","scope","element","attrs","$injector","$interpolate","get","$set","name","invoke","this","$scope","$element","$attrs","form","ngForm","GMACtrl","$filter","$modal","Ministries","Assignments","$log","UserPreference","growl","Languages","gettextCatalog","flattenMinistries","arr","ministries","ministry","hasOwnProperty","sub_ministries","concat","_","sortBy","m","team_role","uniq","ministry_id","scrollToTop","setTimeout","scrollTo","mobileApps","tabs","langFlagClass","replace","appEnvironment","appName","appVersion","version","event","session","assignments","length","joinMinistry","$watch","oldVal","debug","min_choice","user_preferences","flat_assignments","getFlatMinistry","found_assignment","find","preferred_ministry","contains","deRegister","assignment","isUndefined","pluck","id","mccs","user_mcc","mcc","preferred_mcc","admin_mcc","default_mcc","mccSort","indexOf","undefined","hasRole","role","mccLabels","ds","gcm","llm","slm","value","periods","now","moment","date","clone","subtract","period","prevPeriod","index","nextPeriod","logout","then","api","invalidateSession","allowClose","instance","open","keyboard","backdrop","resolve","getMinistries","$promise","result","data","addTeamMember","username","user","cas_username","savePreference","user_preference","supported_staff","dimensions","DIM","guid","key_guid","e","status","getString","onError","response","code","showUserPreference","size","modelData","copy","locale","oldLocale","loadRemote","split","toLowerCase","setCurrentLanguage","Object","keys","tabFilter","tab","requiredRoles","hide_reports_tab","next","nextRoutePath","foundTab","findWhere","preventDefault","redirectToHomeTab","canAccessCurrentTab","loadLanguages","langList","getLanguages","$inject","JoinMinistryCtrl","$modalInstance","screen","join","close","cancel","dismiss","directive","restrict","require","link","chart","google","visualization","LineChart","$render","draw","$viewValue","width","height","chartArea","$q","dataURItoBlob","dataURI","byteString","atob","ab","ArrayBuffer","ia","Uint8Array","mimeString","charCodeAt","Blob","type","URL","webkitURL","getResizeArea","resizeAreaId","resizeArea","document","getElementById","createElement","style","visibility","body","appendChild","resizeImage","origImage","options","maxHeight","resizeMaxHeight","maxWidth","resizeMaxWidth","quality","resizeQuality","resizeType","canvas","Math","round","ctx","getContext","drawImage","toDataURL","createImage","url","callback","image","Image","onload","src","fileToDataURL","file","deferred","defer","reader","FileReader","target","readAsDataURL","promise","imageModel","ctrl","doResizing","imageResult","dataURL","blob","resized","match","applyScope","$apply","setValidity","val","$setValidity","bind","evt","files","stopPropagation","createObjectURL","filter","all_mccs","selected_mccs","filtered","items","item","AdminCtrl","MeasurementTypes","confirmMemberDrop","team","modalInstance","modalData","member","yes","no","getRoleName","getActualRoleName","draggedMember","confirmTeamDrop","source_team","source","target_team","draggedTeam","found_role","roles","r","text","checkIfDroppingOnChildTeam","sourceTeam","targetTeam","flatTeams","foundAsChild","sendAnalytics","throttle","leading","selectTab","getMinistry","initTeamAndMembers","measurementTypes","getMeasurementTypes","is_custom","lmi_show","perm_link_stub","visible","lmi_hide","initSubTabs","adminTabTemplates","getAdminSubTabTemplates","activePill","currentAdminTab","template","label","checked","ableToChangeParentMinistry","parentToFind","availableMinIds","getMCCValue","createMCCArray","splice","saveDetails","min_code","content_locales","private","where","parent_id","saveDetailsResource","updateMinistry","addNewMeasurement","newMeasurement","add","addMeasurementType","new_measurement","fromJson","toJson","editMeasurement","measurement","isLocaleLoaded","contentLocales","original","supportedLanguages","filterByLangCode","lang","iso_code","save","changeLocale","getMeasurementType","measurement_type_id","localized_name","localize_name","localized_description","localize_description","availableLanguages","updateMeasurementType","allCurrentTeams","activeTeamMembers","team_members","activeTeam","membersLoaded","setActiveTeam","loadMinistryMembers","memberSearch","inheritedLeader","inheritedAdmin","deletedUser","formerMember","checkFormer","checkDeleted","checkLeader","checkAdmin","addNewTeamMember","activeTeamName","newMember","updateUserRole","old_role","userInfo","c","assignment_id","trim","saveAssignment","post_data","key_username","addNewSubMinistry","newMinistry","createMinistry","got_ministry","isDefined","memberDraggableOptions","containment","refreshPositions","cursorAt","bottom","helper","tr","$","closest","first_name","last_name","email","hide","teamDraggableOptions","teamOnStart","ui","draggedType","memberOnStart","teamOnDrop","removeClass","hide_after_drop","teamBeforeDrop","teamOnOver","teamCollapsed","addClass","trigger","teamOnOut","isMemberDraggable","getCurrentUserRole","ErrorCtrl","loginUrl","login","MapCtrl","$compile","Trainings","Churches","ISOCountries","TargetCity","Stories","initialize","map","maps","Map","defaultMapOptions","setOptions","draggableCursor","addListener","bounds","getBounds","ne","getNorthEast","sw","getSouthWest","lat","lng","loadChurches","markers","church","churchWindow","InfoWindow","churchWindowContent","trainingWindow","trainingWindowContent","targetCityWindow","targetCityWindowContent","newChurchWindow","cancelAddNewIcon","newChurchWindowContent","newTrainingWindow","newTrainingContent","newTargetCityWindow","newTargetCityContent","church_lines","icons","MarkerImage","versionUrl","Size","Point","cluster","multiplying","group","targetpoint","training","targetCity","side","display","search","controls","ControlPosition","TOP_RIGHT","TOP_LEFT","autocomplete","places","Autocomplete","bindTo","place","getPlace","geometry","viewport","fitBounds","setCenter","setZoom","load_training_markers","latitude","longitude","zoom","location_zoom","default_map_views","default_map_view","view","LatLng","parseInt","getISOCountries","getCountries","toDelete","trainings","t","iconFilters","setMap","removedObject","marker","MarkerWithLabel","position","title","icon","labelContent","labelAnchor","labelClass","labelInBackground","draggable","setAnimation","Animation","DROP","getContent","setContent","nextSibling","edit_training","editable","parent_ids","getParentMinistryIds","created_by","person_id","isLeaderAdmin","getPosition","updateTraining","sessionToken","onSaveChurch","setDraggable","load_target_city_markers","targetCities","target_city_id","isTargetCitiesVisible","edit_targetCity","updateTargetCity","parentId","ids","confirmModalCtrl","isTargetCityVisible","area_code","ministry_scope","area_codes","new_church","new_training","new_targetCity","edit_church","SetParentMode","churches","training_types","target_point","mult_church","parent_lines","jesus_film","map_scope_filter","targetCitySubStages","stage","center","panControl","zoomControl","zoomControlOptions","LEFT_CENTER","mapTypeControl","mapTypeControlOptions","MapTypeControlStyle","DROPDOWN_MENU","streetViewControl","overviewMapControl","supportsGeoLocation","navigator","geolocation","format","loadTrainings","loadTargetCities","debounce","params","lat_min","lat_max","long_min","long_max","searchTargetCities","show_tree","show_all","getTrainings","getZoom","getChurches","onGetChurches","line","setVisible","show","onAddChurch","church_id","addChurch","newChurch","jf_contrib","addTraining","addTargetCity","createTargetCity","onAddTraining","getCenter","cluster_count","zIndex","BOUNCE","onAddTargetCity","onAddIcon","security","SetParent","new_parentLine","Polyline","geodesic","strokeColor","strokeOpacity","strokeWeight","SymbolPath","FORWARD_OPEN_ARROW","offset","repeat","move_event","setPath","latLng","onkeydown","keyCode","removeListener","RemoveParent","parents","saveChurch","makeMovableIcon","MoveChurch","MoveTraining","MoveTargetCity","updateChurch","DeleteChurch","end_date","endOf","updateTrainingCompletion","l","remove","churchIconToUse","development","jesusFilmSign","toString","p","par","parentLine","coordinates","number","div_","onAdd","div","className","innerHTML","panes","getPanes","overlayMouseTarget","x","y","overlayProjection","getProjection","fromLatLngToDivPixel","left","top","onRemove","parentNode","removeChild","prototype","OverlayView","addTrainingStage","insert","number_completed","newPhase","phase","current_stage","training_id","addTrainingCompletion","onAddTrainingCompletion","editMode","Id","gcm_training_completions","DeleteTraining","deleteTraining","DeleteTargetCity","target_city","deleteTargetCity","deleteTrainingComplete","training_complete","deleteTrainingCompletion","setMyDefaultMapView","setMinistryDefaultView","d","myLocation","getCurrentPosition","coords","addStoryToIcon","imageFile","storiesConfig","iconName","saveStory","story","stories","createStory","form_data","FormData","append","uploadStoryImage","story_id","img","canAddStories","jQuery","MeasurementDetailsCtrl","Measurements","details","spinner","ns","gmaNamespace","perm_link","da","total","local","my_measurements","trend","arrayToDataTable","filterSource","key","measurements","editForm","$dirty","measurement_type_ids","related_entity_id","$modelValue","saveMeasurement","approveSelfAssigned","state","blocked","MeasurementsCtrl","$interval","decideLocaleToLoad","defaultLocale","setMeasurementStates","measurementState","states_from_config","default_measurement_states","currentLanguage","old","newVal","getMeasurements","loadMeasurements","language","hasOther","section","column","saveMeasurements","lmiForm","type_id","input","$valid","$setPristine","editMeasurementDetails","getMeasurement","autoSave","toggleMeasurementState","checkMeasureState","supported_staff_only","leader_only","UserPreferenceCtrl","static_locale","getMappedMCCS","staticLocales","static_locales","extend","changeMCCS","mini","ReportsCtrl","walterMeanAvg","values","sort","a","b","shift","pop","table","Table","dataTable","historical","chartData","DataTable","tableData","rows","addColumn","dates","addRows","row","addRow","tableDataTable","reverse","legend","alignment","orientation","StoriesCtrl","showUploadError","storiesLoaded","feedsLoaded","storiesNav","currentPage","perPage","stories_per_page","feedsNav","feeds_count","storiesParams","self_only","searchStories","loadNewsFeeds","page","per_page","getNewsFeeds","recentNewsFeeds","entries","totalItems","meta","visibleStories","newStory","removeImage","originalParams","created_at","Date","found_story","image_url","equals","viewStory","isSelfOnlyEnabled","editStory","originalStory","updated_at","updateStory","isStoryEditable","GoogleAnalyticsService","googleAnalytics","ga","appId","appInstallerId","host","screenName","category","action","factory","$resource","getAssignment","method","getAssignments","isArray","getChurch","$http","token","st","session_ticket","$broadcast","request","withCredentials","headers","attempts","responseError","refresh","loginResponse","service_ticket","reject","post","put","getTargetCity","getHighest","array","max","getHighestCount","leaders_trained","training_completion","getPreference","flattenMinistry","mapped_mccs","each","customObject","mccLabel","SettingsService","apiUrl","base","appUrl","measurementsApi","$get","environment","mobileapps","namespace","googleanalytics","provider","getStory","formData","Content-Type","transformRequest","identity"],"mappings":"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","file":"application.min.js","sourcesContent":["(function ( angular ) {\r\n\t'use strict';\r\n\tangular.module( 'gma', [\r\n\t\t'ngRoute',\r\n\t\t'ui.bootstrap',\r\n\t\t'ngResource',\r\n\t\t'gma.controllers',\r\n\t\t'gma.directives',\r\n\t\t'gma.filters',\r\n\t\t'gma.services',\r\n\t\t'ngDragDrop',\r\n\t\t'angular-growl',\r\n        'gettext'\r\n\t] );\r\n})( angular );\r\n","(function ( angular ) {\r\n\t'use strict';\r\n\tangular.module( 'gma.controllers', [\r\n\t\t'gma.controllers.admin',\r\n\t\t'gma.controllers.error',\r\n\t\t'gma.controllers.map',\r\n\t\t'gma.controllers.measurements',\r\n\t\t'gma.controllers.reports',\r\n\t\t'gma.controllers.preference',\r\n        'gma.controllers.stories'\r\n\t] );\r\n})( angular );\r\n","(function ( angular ) {\n\t'use strict';\n\tangular.module( 'gma.directives', [] );\n})( angular );\n","(function ( angular ) {\n\t'use strict';\n\tangular.module( 'gma.filters', [] );\n})( angular );\n","(function ( angular ) {\r\n\t'use strict';\r\n\tangular.module( 'gma.services', [\r\n\t\t'gma.services.googleAnalytics',\r\n\t\t'gma.services.measurements',\r\n\t\t'gma.services.settings',\r\n\t\t'gma.services.preference',\r\n\t\t'gma.services.stories'\r\n\t] );\r\n})( angular );\r\n","(function ( angular ) {\n\t'use strict';\n\tangular.module( 'gma.controllers.admin', [] );\n})( angular );\n","(function ( angular ) {\n\t'use strict';\n\tangular.module( 'gma.controllers.error', [] );\n})( angular );\n","(function ( angular ) {\n\t'use strict';\n\tangular.module( 'gma.controllers.map', [] );\n})( angular );\n","(function ( angular ) {\n\t'use strict';\n\tangular.module( 'gma.controllers.measurements', [] );\n})( angular );\n","(function ( angular ) {\r\n    'use strict';\r\n    angular.module( 'gma.controllers.preference', [] );\r\n})( angular );\r\n","(function ( angular ) {\n\t'use strict';\n\tangular.module( 'gma.controllers.reports', [] );\n})( angular );\n","(function ( angular ) {\r\n    'use strict';\r\n    angular.module( 'gma.controllers.stories', [] );\r\n})( angular );\r\n","(function ( angular ) {\r\n\t'use strict';\r\n\tangular.module( 'gma.services.googleAnalytics', [] );\r\n})( angular );\r\n","(function ( angular ) {\n\t'use strict';\n\tangular.module( 'gma.services.measurements', [] );\n})( angular );\n","(function ( angular ) {\r\n    'use strict';\r\n    angular.module( 'gma.services.preference', [] );\r\n})( angular );\r\n","(function ( angular ) {\n\t'use strict';\n\tangular.module( 'gma.services.settings', [] );\n})( angular );\n","(function ( angular ) {\r\n    'use strict';\r\n    angular.module( 'gma.services.stories', [] );\r\n})( angular );\r\n","(function () {\r\n    'use strict';\r\n    angular.module('gma')\r\n        .run(function ($rootScope, $route, $location, Session, Settings, GoogleAnalytics) {\r\n            // Object to hold current values: assignments, assignment, user ...\r\n            $rootScope.current = {\r\n                isLoaded: false\r\n            };\r\n\r\n            // Init Google Analytics\r\n            GoogleAnalytics.init();\r\n\r\n            // Support application inside an iframe, sync parent hash.\r\n            if (typeof window.parent !== 'undefined') {\r\n                var parentHash = window.parent.location.hash;\r\n                if (parentHash) {\r\n                    $location.path(parentHash.slice(1));\r\n                }\r\n\r\n                $rootScope.$on('$locationChangeSuccess', function () {\r\n                    window.parent.location.hash = '#' + $location.path();\r\n                });\r\n            }\r\n\r\n            // Reload the route since ng-view directive is inside a template.\r\n            $route.reload();\r\n\r\n            // Start the session with the API\r\n            //TODO fetch a ticket from refresh to start session\r\n            Session.startSession(Settings.ticket);\r\n        })\r\n        .config(function ($routeProvider, $httpProvider, $compileProvider, SettingsProvider, $provide, growlProvider, $rootScopeProvider) {\r\n            // Initialize Settings from wrapper provided config\r\n            SettingsProvider.setConfig(window.gma.config);\r\n\r\n            // Add itms-services scheme to safe aHref protocols\r\n            $compileProvider.aHrefSanitizationWhitelist(/^\\s*(https?|ftp|mailto|tel|file|itms-services):/);\r\n\r\n            // Define safe protocols for image src for this app\r\n            $compileProvider.imgSrcSanitizationWhitelist(/^\\s*(https?|ftp|file|data|blob):/);\r\n\r\n            // Register Session as an http interceptor\r\n            $httpProvider.interceptors.push('Session');\r\n\r\n            //increase digest cycle limit , default is 10\r\n            $rootScopeProvider.digestTtl(100);\r\n\r\n            //global configs for angular-growl\r\n            growlProvider.globalPosition('top-right');\r\n            growlProvider.globalTimeToLive({success: 5000, error: 10000, warning: 10000, info: 5000});\r\n            growlProvider.globalDisableCountDown(true);\r\n\r\n            // Setup application routes\r\n            angular.forEach(SettingsProvider.routes(), function (route, i) {\r\n                if (i === 0) {\r\n                    $routeProvider.otherwise({redirectTo: route.path});\r\n                }\r\n                $routeProvider\r\n                    .when(route.path, {\r\n                        templateUrl: route.templateUrl,\r\n                        controller: route.controller\r\n                    });\r\n            });\r\n            $routeProvider.when('/error/:reason', {\r\n                templateUrl: 'partials/error/error.html',\r\n                controller: 'ErrorCtrl'\r\n            });\r\n\r\n            // https://github.com/angular/angular.js/issues/1404\r\n            // Source: http://plnkr.co/edit/hSMzWC?p=preview\r\n            $provide.decorator('ngModelDirective', function ($delegate) {\r\n                var ngModel = $delegate[0], controller = ngModel.controller;\r\n                ngModel.controller = ['$scope', '$element', '$attrs', '$injector', function (scope, element, attrs, $injector) {\r\n                    var $interpolate = $injector.get('$interpolate');\r\n                    attrs.$set('name', $interpolate(attrs.name || '')(scope));\r\n                    $injector.invoke(controller, this, {\r\n                        '$scope': scope,\r\n                        '$element': element,\r\n                        '$attrs': attrs\r\n                    });\r\n                }];\r\n                return $delegate;\r\n            });\r\n\r\n            $provide.decorator('formDirective', function ($delegate) {\r\n                var form = $delegate[0], controller = form.controller;\r\n                form.controller = ['$scope', '$element', '$attrs', '$injector', function (scope, element, attrs, $injector) {\r\n                    var $interpolate = $injector.get('$interpolate');\r\n                    attrs.$set('name', $interpolate(attrs.name || attrs.ngForm || '')(scope));\r\n                    $injector.invoke(controller, this, {\r\n                        '$scope': scope,\r\n                        '$element': element,\r\n                        '$attrs': attrs\r\n                    });\r\n                }];\r\n                return $delegate;\r\n            });\r\n        });\r\n})();\r\n","(function (angular) {\r\n    'use strict';\r\n\r\n    function GMACtrl($scope, $filter, $location, $modal, Session, Ministries, Assignments, Settings, $log, GoogleAnalytics, UserPreference, growl, Languages, gettextCatalog) {\r\n        // Attach $location provider to scope, this is used to set active tabs\r\n        $scope.$location = $location;\r\n        $scope.mobileApps = Settings.mobileApps;\r\n        $scope.tabs = Settings.tabs;\r\n        $scope.langFlagClass = 'flag-us'; //used to show language flag indicator\r\n        // always redirect user to map tab when init\r\n        $location.path('/map').replace();\r\n\r\n        $scope.appEnvironment = Settings.appEnvironment;\r\n        $scope.appName = Settings.name;\r\n\t\t$scope.appVersion = Settings.version;\r\n        //---------------------------------------\r\n        // Assignments\r\n        //---------------------------------------\r\n\r\n        $scope.$on('sessionStart', function (event, session) {\r\n            if (typeof session.assignments === 'undefined' || session.assignments.length == 0) {\r\n                //Open Modal if user has no assignment\r\n                $scope.joinMinistry(false);\r\n            }\r\n        });\r\n\r\n        // Update current assignment when assignments is set - this occurs after a session is established\r\n        $scope.$watch('current.assignments', function (assignments, oldVal) {\r\n            if (assignments === oldVal) return;\r\n\r\n            $log.debug('Assignments Changed');\r\n\r\n            //first time when page loads\r\n            if (typeof assignments === 'object' && typeof oldVal === 'undefined') {\r\n                var min_choice = false;\r\n                if ($scope.current.hasOwnProperty('user_preferences') && typeof $scope.current.user_preferences !== 'undefined') {\r\n                    var flat_assignments = UserPreference.getFlatMinistry(assignments);\r\n                    //apply user preference\r\n                    var found_assignment = _.find(flat_assignments, function (ministry) {\r\n                        return (ministry.ministry_id === $scope.current.user_preferences.preferred_ministry);\r\n                    });\r\n\r\n                    if (typeof found_assignment !== 'undefined' && typeof found_assignment !== '') {\r\n                        min_choice = found_assignment;\r\n                    } else {\r\n                        min_choice = $filter('orderBy')(assignments, 'name')[0];\r\n\r\n                    }\r\n                } else {\r\n                    //load first ministry if user preferences not found\r\n                    min_choice = $filter('orderBy')(assignments, 'name')[0];\r\n\r\n                }\r\n                //redirect user to his home tab\r\n                if (min_choice !== false) {\r\n                    if (_.contains(['admin', 'inherited_admin', 'leader', 'inherited_leader','member'], min_choice.team_role)) {\r\n                        $location.path('/news').replace();\r\n                        var deRegister = $scope.$on('$routeChangeSuccess', function () {\r\n                            if (min_choice === false) return;\r\n                            $scope.current.assignment = min_choice;\r\n                            min_choice = false;\r\n                            deRegister();\r\n                        });\r\n                    } else {\r\n                        $scope.current.assignment = min_choice;\r\n                    }\r\n                }\r\n                $scope.current.ministries = flattenMinistries(assignments);\r\n\r\n            } else if (typeof assignments === 'object') {\r\n                if (angular.isUndefined($scope.current.assignment) || !_.contains(_.pluck(assignments, 'id'), $scope.current.assignment.id)) {\r\n\r\n                    $scope.current.assignment = $filter('orderBy')(assignments, 'name')[0];\r\n\r\n                }\r\n                $scope.current.ministries = flattenMinistries(assignments);\r\n            } else {\r\n                delete $scope.current.assignment;\r\n                $scope.current.ministries = [];\r\n            }\r\n\r\n        });\r\n\r\n        // Update assignment and mcc when assignment changes\r\n        $scope.$watch('current.assignment', function (assignment, oldVal) {\r\n            if (assignment === oldVal) return;\r\n\r\n            $log.debug('Assignment Changed: ' + assignment.name);\r\n\r\n            if (typeof assignment === 'object') {\r\n\r\n                if (assignment.mccs.length > 0) {\r\n                    //check if first time\r\n                    if (typeof oldVal === 'undefined') {\r\n                        if ($scope.current.hasOwnProperty('user_preferences') && typeof $scope.current.user_preferences !== 'undefined') {\r\n                            //apply user preference here\r\n                            var user_mcc = _.find(assignment.mccs, function (mcc) {\r\n                                return (mcc === $scope.current.user_preferences.preferred_mcc);\r\n                            });\r\n\r\n                            if (typeof user_mcc !== 'undefined' && typeof user_mcc !== '') {\r\n                                $scope.current.mcc = user_mcc;\r\n\r\n                            } else {\r\n                                //check for admin preferences\r\n                                var admin_mcc = _.find(assignment.mccs, function (mcc) {\r\n                                    return (mcc === $scope.current.assignment.default_mcc);\r\n                                });\r\n                                if (typeof admin_mcc !== 'undefined' && admin_mcc !== '') {\r\n                                    $scope.current.mcc = admin_mcc;\r\n                                } else {\r\n                                    //if admin preferences not found then use fist one\r\n                                    $scope.current.mcc = $filter('orderBy')(assignment.mccs, $scope.mccSort)[0];\r\n                                }\r\n                            }\r\n\r\n                        } else {\r\n                            // Set mcc if none is currently set or new assignment does not include current mcc\r\n                            if (typeof $scope.current.mcc === 'undefined' || assignment.mccs.indexOf($scope.current.mcc) < 0) {\r\n                                $scope.current.mcc = $filter('orderBy')(assignment.mccs, $scope.mccSort)[0];\r\n                            }\r\n                        }\r\n                    } else {\r\n                        // Set mcc if none is currently set or new assignment does not include current mcc\r\n                        if (typeof $scope.current.mcc === 'undefined' || assignment.mccs.indexOf($scope.current.mcc) < 0) {\r\n                            $scope.current.mcc = $filter('orderBy')(assignment.mccs, $scope.mccSort)[0];\r\n                        }\r\n                    }\r\n\r\n                }\r\n                else {\r\n                    // Delete current mcc if assignment has no mccs\r\n                    delete $scope.current.mcc;\r\n                }\r\n            }\r\n        });\r\n\r\n        /**\r\n         * Deep watch for mccs array\r\n         */\r\n        $scope.$watch('current.assignment.mccs', function (mccs, oldVal) {\r\n            if (mccs !== undefined && mccs.length !== 0) {\r\n                if (typeof $scope.current.mcc === 'undefined' || mccs.indexOf($scope.current.mcc) < 0) {\r\n                    $scope.current.mcc = $filter('orderBy')(mccs, $scope.mccSort)[0];\r\n                }\r\n            } else {\r\n                delete $scope.current.mcc;\r\n            }\r\n        }, true);\r\n\r\n        $scope.current.hasRole = function (role) {\r\n            if (typeof $scope.current.assignment === 'undefined' || typeof $scope.current.assignment.team_role === 'undefined') return false;\r\n            return (typeof role === 'string') ? role == $scope.current.assignment.team_role : _.contains(role, $scope.current.assignment.team_role);\r\n        };\r\n\r\n        function flattenMinistries(arr) {\r\n            var ministries = [];\r\n            angular.forEach(arr, function (ministry) {\r\n                ministries.push(ministry);\r\n                if (ministry.hasOwnProperty('sub_ministries') && typeof ministry.sub_ministries === 'object') {\r\n                    ministries = ministries.concat(flattenMinistries(ministry.sub_ministries));\r\n                }\r\n            });\r\n\r\n            //sort by team role\r\n            ministries = _.sortBy(ministries, function (m) {\r\n                return (m.team_role === 'leader' ? 0 : 1);\r\n            });\r\n            //remove duplicates\r\n            return _.uniq(ministries, false, function (m) {\r\n                return m.ministry_id;\r\n            });\r\n        }\r\n\r\n        //---------------------------------------\r\n        // Mission Critical Components (MCC)\r\n        //---------------------------------------\r\n\r\n        // MCC labels, this should be done in localization in the future.\r\n        $scope.mccLabels = {\r\n            ds: 'Digital Strategies',\r\n            gcm: 'Global Church Movements',\r\n            llm: 'Leader Led',\r\n            slm: 'Student Led'\r\n        };\r\n\r\n        $scope.mccSort = function (value) {\r\n            return $scope.mccLabels[value];\r\n        };\r\n\r\n        //---------------------------------------\r\n        // Periods\r\n        //---------------------------------------\r\n        var periods = [], now = moment().date(1);\r\n        for (var i = 0; i < 12; i++) {\r\n            periods.push(now.clone());\r\n            now.subtract(1, 'M');\r\n        }\r\n        $scope.periods = periods;\r\n        $scope.current.period = periods[0];\r\n\r\n        $scope.prevPeriod = function () {\r\n            var index = $scope.periods.indexOf($scope.current.period);\r\n            index = ( ( index + 1 ) >= $scope.periods.length ) ? 0 : index + 1;\r\n            $scope.current.period = $scope.periods[index];\r\n        };\r\n\r\n        $scope.nextPeriod = function () {\r\n            var index = $scope.periods.indexOf($scope.current.period);\r\n            index = ( ( index - 1 ) < 0 ) ? $scope.periods.length - 1 : index - 1;\r\n            $scope.current.period = $scope.periods[index];\r\n        };\r\n\r\n        //---------------------------------------\r\n        // Session\r\n        //---------------------------------------\r\n\r\n        $scope.logout = function () {\r\n            Session.logout().then(function () {\r\n                window.location = Settings.api.logout;\r\n            });\r\n        };\r\n\r\n        $scope.invalidateSession = function () {\r\n            Session.logout();\r\n        };\r\n\r\n        $scope.joinMinistry = function (allowClose) {\r\n            allowClose = typeof allowClose !== 'undefined' ? allowClose : true;\r\n\r\n            var instance = $modal.open({\r\n                templateUrl: 'partials/join-ministry.html',\r\n                controller: 'JoinMinistryCtrl',\r\n                keyboard: allowClose,\r\n                backdrop: allowClose ? true : 'static',\r\n                resolve: {\r\n                    'ministries': function () {\r\n                        return Ministries.getMinistries().$promise;\r\n                    },\r\n                    'allowClose': function () {\r\n                        return allowClose;\r\n                    }\r\n                }\r\n            });\r\n\r\n            instance.result.then(function (data) {\r\n\r\n                Assignments.addTeamMember({\r\n                    username: $scope.current.user.cas_username,\r\n                    ministry_id: data.ministry.ministry_id,\r\n                    team_role: 'self_assigned'\r\n                }, function (assignment) {\r\n                    if (typeof $scope.current.assignments === 'undefined' || $scope.current.assignments===[]) {\r\n                        // If assignments is empty, setting the array will also set the current assignment\r\n                        $scope.current.assignments = [assignment];\r\n\r\n                        //Also updating supported staff setting in user preference\r\n                        UserPreference.savePreference(data.user_preference)\r\n                            .success(function () {\r\n                                if (typeof $scope.current.user_preferences === 'undefined') {\r\n                                    $scope.current.user_preferences = {};\r\n                                }\r\n\r\n                                $scope.current.user_preferences.supported_staff = data.user_preference.supported_staff;\r\n                            });\r\n                    }\r\n                    else {\r\n                        // Add new assignment\r\n                        $scope.current.assignments.push(assignment);\r\n\r\n                        // Set new assignment as current\r\n                        $scope.current.assignment = assignment;\r\n                    }\r\n\r\n                    // Google Analytics\r\n                    GoogleAnalytics.event('assignments', 'join ministry', (function () {\r\n                        var dimensions = {};\r\n                        dimensions[GoogleAnalytics.DIM.guid] = $scope.current.user.key_guid;\r\n                        dimensions[GoogleAnalytics.DIM.ministry_id] = assignment.ministry_id;\r\n                        return dimensions;\r\n                    })());\r\n                }, function (e) {\r\n                    if (e.status === 400) {\r\n                        growl.error(gettextCatalog.getString('You are already assigned to requested ministry'));\r\n                    } else {\r\n                        growl.error(gettextCatalog.getString('Unable to join to requested ministry'));\r\n                    }\r\n                });\r\n            });\r\n            scrollToTop();\r\n        };\r\n\r\n        $scope.onError = function (response, code) {\r\n            $location.path('/error');\r\n        };\r\n\r\n        function scrollToTop() {\r\n            window.setTimeout(function () {\r\n                window.parent.scrollTo(0, 0);\r\n            }, 10);\r\n        }\r\n\r\n        //---------------------------------------\r\n        // User Preferences Dialog\r\n        //---------------------------------------\r\n\r\n        $scope.showUserPreference = function () {\r\n\r\n            $modal.open({\r\n                templateUrl: 'partials/preference/user-preference-modal.html',\r\n                controller: 'UserPreferenceCtrl',\r\n                keyboard: true,\r\n                backdrop: true,\r\n                size: 'model-lg',\r\n                resolve: {\r\n                    modelData: function () {\r\n                        return {\r\n                            mccLabels: angular.copy($scope.mccLabels)\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            scrollToTop();\r\n        };\r\n\r\n        /**\r\n         * Watches for changes to static_locale\r\n         * - update gettext language\r\n         * - load external language JSON\r\n         * - update language flag indicator css class\r\n         */\r\n        $scope.$watch('current.user_preferences.static_locale', function (locale, oldLocale) {\r\n            if (typeof locale === 'undefined' || locale === '') return;\r\n            //load json file from server\r\n            gettextCatalog.loadRemote('languages/' + locale + '.json')\r\n                .success(function (response) {\r\n                    //set css class to show language flag on top\r\n                    $scope.langFlagClass = 'flag-' + locale.split('-')[1].toLowerCase();\r\n                    //set current language, match with json file object name\r\n                    gettextCatalog.setCurrentLanguage(Object.keys(response)[0]);\r\n                })\r\n                .error(function (e) {\r\n                    if (e.status === 404) {\r\n                        growl.error(gettextCatalog.getString('Unable to load language data'));\r\n                    }\r\n                });\r\n        });\r\n\r\n        /**\r\n         * Sends true to show, false to hide\r\n         * @param tab\r\n         * @returns {boolean}\r\n         */\r\n        $scope.tabFilter = function (tab) {\r\n            //current may not be defined, so hide un-till user get an assignment\r\n            if (typeof $scope.current === 'undefined') return false;\r\n            //check for role first\r\n            if (!$scope.current.hasRole(tab.requiredRoles)) {\r\n                return false;\r\n            }\r\n\r\n            if (tab.path == '/reports') {\r\n                //user preferences not found\r\n                if (typeof $scope.current.user_preferences === 'undefined') {\r\n                    //send admin preferences\r\n                    return ($scope.current.hide_reports_tab != '1');\r\n                }\r\n                //lastly send user preferences\r\n                return ($scope.current.user_preferences.hide_reports_tab !== '1');\r\n            } else if (tab.path == '/measurements') {\r\n                //if current ministry has no mcc then hide the tab\r\n                return (typeof $scope.current.mcc !== 'undefined');\r\n            } else {\r\n                return true;\r\n            }\r\n\r\n        };\r\n\r\n        $scope.$on('$locationChangeStart', function (event, next, current) {\r\n            if ($scope.current.assignment === undefined) return true;\r\n            //get tab name\r\n            var nextRoutePath = next.split('#/')[1];\r\n            //get required role for requested tab\r\n            var foundTab = _.findWhere($scope.tabs, {path: '/' + nextRoutePath});\r\n\r\n            //check if user has permission to load this tab\r\n            if (typeof foundTab !== 'undefined' && !$scope.current.hasRole(foundTab.requiredRoles)) {\r\n                growl.error(gettextCatalog.getString('You are not authorised for this'));\r\n                event.preventDefault();\r\n                return false;\r\n            }\r\n        });\r\n\r\n        $scope.current.redirectToHomeTab = function () {\r\n\r\n            if ($scope.current.hasRole(['admin', 'inherited_admin', 'leader', 'inherited_leader'])) {\r\n                $location.path('/news').replace();\r\n            } else {\r\n                $location.path('/map').replace();\r\n            }\r\n        };\r\n\r\n        $scope.current.canAccessCurrentTab = function () {\r\n            if (typeof $scope.current.assignment === 'undefined') {\r\n                return false;\r\n            }\r\n\r\n            return ($scope.current.hasRole(_.findWhere($scope.tabs, {path: $location.path()}).requiredRoles));\r\n\r\n        };\r\n\r\n\r\n        $scope.current.loadLanguages = function () {\r\n\r\n            if (typeof $scope.current.langList !== 'undefined' && $scope.current.langList.length !== 0) {\r\n                return $scope.current.langList;\r\n            } else {\r\n\r\n                Languages.getLanguages()\r\n                    .success(function (response) {\r\n                        $scope.current.langList = _.sortBy(response, 'english_name');\r\n                        return $scope.current.langList;\r\n                    })\r\n                    .error(function () {\r\n                        growl.error(gettextCatalog.getString('Unable to load languages'));\r\n                        return false;\r\n                    });\r\n\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    angular.module('gma.controllers').controller('GMACtrl', GMACtrl);\r\n})(angular);\r\n",null,"(function () {\r\n    'use strict';\r\n\r\n    function JoinMinistryCtrl($scope, $modalInstance, ministries, allowClose, GoogleAnalytics) {\r\n        $scope.ministries = ministries;\r\n        $scope.allowClose = allowClose;\r\n\r\n        // Google Analytics\r\n        GoogleAnalytics.screen('Join Ministry', (function () {\r\n            var dimensions = {};\r\n            dimensions[GoogleAnalytics.DIM.guid] = $scope.current.user.key_guid;\r\n            return dimensions;\r\n        })());\r\n\r\n        window.setTimeout(function () {\r\n            window.parent.scrollTo(0, 0);\r\n        }, 10);\r\n\r\n        $scope.join = function () {\r\n            var data = {};\r\n            data.ministry = $scope.ministry;\r\n            data.user_preference = $scope.user_preference;\r\n            $modalInstance.close(data);\r\n        };\r\n\r\n        $scope.cancel = function () {\r\n            $modalInstance.dismiss('cancel');\r\n        };\r\n    }\r\n\r\n    angular.module('gma.controllers').controller('JoinMinistryCtrl', JoinMinistryCtrl);\r\n})();\r\n","(function () {\n\t'use strict';\n\n\tangular.module( 'gma.directives' )\n\t\t.directive( 'gmaTrend', [function () {\n\t\t\treturn {\n\t\t\t\trestrict: 'A',\n\t\t\t\trequire:  'ngModel',\n\t\t\t\tlink:     function ( $scope, $element, $attrs, ngModel ) {\n\t\t\t\t\tif ( !ngModel ) return;\n\t\t\t\t\tvar chart = new google.visualization.LineChart( $element.get( 0 ) );\n\n\t\t\t\t\tngModel.$render = function () {\n\t\t\t\t\t\tchart.draw( ngModel.$viewValue, {width: 550, height: 200, chartArea: {width: '65%'}} );\n\t\t\t\t\t};\n\n\t\t\t\t\t$scope.$on( '$destroy', function () {\n\t\t\t\t\t\tchart = null;\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\t\t}] )\n})();\n","/*\r\n * @source https://github.com/Mischi/angularjs-imageupload-directive\r\n * Made some changes\r\n */\r\n(function (angular) {\r\n    angular.module('gma.directives')\r\n        .directive('imageResizer', function ($q) {\r\n            'use strict';\r\n\r\n            var URL = window.URL || window.webkitURL;\r\n\r\n            /**\r\n             * http://stackoverflow.com/questions/4998908/convert-data-uri-to-file-then-append-to-formdata/5100158\r\n             */\r\n            function dataURItoBlob(dataURI) {\r\n                var byteString = atob(dataURI.split(',')[1]);\r\n                var ab = new ArrayBuffer(byteString.length);\r\n                var ia = new Uint8Array(ab);\r\n                // separate out the mime component\r\n                var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\r\n                for (var i = 0; i < byteString.length; i++) {\r\n                    ia[i] = byteString.charCodeAt(i);\r\n                }\r\n                return new Blob([ab], {type: mimeString});\r\n            }\r\n\r\n            var getResizeArea = function () {\r\n                var resizeAreaId = 'fileupload-resize-area';\r\n\r\n                var resizeArea = document.getElementById(resizeAreaId);\r\n\r\n                if (!resizeArea) {\r\n                    resizeArea = document.createElement('canvas');\r\n                    resizeArea.id = resizeAreaId;\r\n                    resizeArea.style.visibility = 'hidden';\r\n                    document.body.appendChild(resizeArea);\r\n                }\r\n\r\n                return resizeArea;\r\n            };\r\n\r\n            var resizeImage = function (origImage, options) {\r\n\r\n                var maxHeight = options.resizeMaxHeight || 128;\r\n                var maxWidth = options.resizeMaxWidth || 128;\r\n                var quality = options.resizeQuality || 0.8;\r\n                var type = options.resizeType || 'image/jpg';\r\n\r\n                var canvas = getResizeArea();\r\n\r\n                var height = origImage.height;\r\n                var width = origImage.width;\r\n\r\n                // calculate the width and height, constraining the proportions\r\n                if (width > height) {\r\n                    if (width > maxWidth) {\r\n                        height = Math.round(height *= maxWidth / width);\r\n                        width = maxWidth;\r\n                    }\r\n                } else {\r\n                    if (height > maxHeight) {\r\n                        width = Math.round(width *= maxHeight / height);\r\n                        height = maxHeight;\r\n                    }\r\n                }\r\n\r\n                canvas.width = width;\r\n                canvas.height = height;\r\n\r\n                //draw image on canvas\r\n                var ctx = canvas.getContext(\"2d\");\r\n                ctx.drawImage(origImage, 0, 0, width, height);\r\n\r\n                // get the data from canvas as 80% jpg (or specified type).\r\n                return canvas.toDataURL(type, quality);\r\n            };\r\n\r\n            var createImage = function (url, callback) {\r\n                var image = new Image();\r\n                image.onload = function () {\r\n                    callback(image);\r\n                };\r\n                image.src = url;\r\n            };\r\n\r\n            var fileToDataURL = function (file) {\r\n                var deferred = $q.defer();\r\n                var reader = new FileReader();\r\n                reader.onload = function (e) {\r\n                    deferred.resolve(e.target.result);\r\n                };\r\n                reader.readAsDataURL(file);\r\n                return deferred.promise;\r\n            };\r\n\r\n\r\n            return {\r\n                restrict: 'A',\r\n                require: 'ngModel',\r\n                scope: {\r\n                    imageModel: '=',\r\n                    resizeMaxHeight: '@?',\r\n                    resizeMaxWidth: '@?',\r\n                    resizeQuality: '@?',\r\n                    resizeType: '@?'\r\n                },\r\n                link: function (scope, element, attrs, ctrl) {\r\n\r\n                    var doResizing = function (imageResult, callback) {\r\n                        createImage(imageResult.url, function (image) {\r\n                            var dataURL = resizeImage(image, scope);\r\n                            var blob = dataURItoBlob(dataURL);\r\n                            imageResult.resized = {\r\n                                blob: blob, //added blob data also\r\n                                dataURL: dataURL,\r\n                                type: dataURL.match(/:(.+\\/.+);/)[1]\r\n                            };\r\n                            callback(imageResult);\r\n                        });\r\n                    };\r\n\r\n                    var applyScope = function (imageResult) {\r\n                        scope.$apply(function () {\r\n                            //do not support multiple image select\r\n                            scope.imageModel = imageResult;\r\n                        });\r\n                    };\r\n                    var setValidity = function (val) {\r\n                        scope.$apply(function () {\r\n                            ctrl.$setValidity('invalidImage', val);\r\n                        });\r\n                    };\r\n\r\n\r\n                    element.bind('change', function (evt) {\r\n                        //we do not support for multiple image select\r\n                        var files = evt.target.files;\r\n                        //additional check, be fail safe\r\n                        if (files.length === 0) {\r\n                            applyScope({});//empty scope\r\n                            evt.preventDefault();\r\n                            evt.stopPropagation();\r\n                            return false;\r\n                        }\r\n                        //check for file extension\r\n                        if (files[0].type.match('image/*') === null) {\r\n                            angular.element(evt.target).val(''); //empty file input\r\n                            applyScope({});//empty scope\r\n                            setValidity(false); //invalidate input\r\n                            evt.preventDefault();\r\n                            return false;\r\n                        }\r\n                        //validate input\r\n                        setValidity(true);\r\n                        //create a result object to store file info\r\n                        var imageResult = {\r\n                            file: files[0], //original file\r\n                            //Next attribute is required, don't try to remove it\r\n                            url: URL.createObjectURL(files[0])\r\n                        };\r\n                        //convert to base 64\r\n                        fileToDataURL(files[0]).then(function (dataURL) {\r\n                            imageResult.dataURL = dataURL;\r\n                        });\r\n\r\n                        if (scope.resizeMaxHeight || scope.resizeMaxWidth) {\r\n                            //resize image\r\n                            doResizing(imageResult, function (imageResult) {\r\n                                applyScope(imageResult);\r\n                            });\r\n                        }\r\n                        else {\r\n                            //no resizing\r\n                            applyScope(imageResult);\r\n                        }\r\n\r\n                    });\r\n                }\r\n            };\r\n        });\r\n})(angular);","(function () {\r\n    'use strict';\r\n\r\n    angular.module('gma.filters')\r\n        .filter('mccFilter', [function () {\r\n            return function (all_mccs, selected_mccs) {\r\n\r\n                var filtered = [];\r\n\r\n                if(typeof selected_mccs === 'undefined' || typeof all_mccs === 'undefined') return filtered;\r\n\r\n                angular.forEach(all_mccs, function (mcc) {\r\n                    if (selected_mccs.indexOf(mcc.value) !== -1) {\r\n                        filtered.push(mcc);\r\n                    }\r\n                });\r\n\r\n                return filtered;\r\n            };\r\n        }]);\r\n})();\r\n","(function () {\n\t'use strict';\n\n\tangular.module( 'gma.filters' )\n\t\t.filter( 'roleFilter', [function () {\n\t\t\treturn function ( items, role ) {\n\t\t\t\tvar filtered = [];\n\t\t\t\tangular.forEach( items, function ( item ) {\n\t\t\t\t\tif ( typeof role === 'string' && role == item.team_role ) {\n\t\t\t\t\t\tfiltered.push( item );\n\t\t\t\t\t} else if ( typeof role === 'object' && _.contains( role, item.team_role ) ) {\n\t\t\t\t\t\tfiltered.push( item );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\treturn filtered;\n\t\t\t};\n\t\t}] );\n})();\n","(function () {\r\n    'use strict';\r\n\r\n    function AdminCtrl($scope, $filter, $modal, Assignments, MeasurementTypes, GoogleAnalytics, Ministries, growl, UserPreference, gettextCatalog) {\r\n        $scope.current.isLoaded = false;\r\n\r\n        var sendAnalytics = _.throttle(function () {\r\n            GoogleAnalytics.screen('Admin', (function () {\r\n                var dimensions = {};\r\n                dimensions[GoogleAnalytics.DIM.guid] = $scope.current.user.key_guid;\r\n                dimensions[GoogleAnalytics.DIM.ministry_id] = $scope.current.assignment.ministry_id;\r\n                return dimensions;\r\n            })());\r\n        }, 1000, {leading: false});\r\n\r\n        $scope.$watch('current.assignment.ministry_id', function (ministry_id) {\r\n            if (typeof ministry_id === 'undefined') return;\r\n            if ($scope.current.canAccessCurrentTab()) {\r\n                //move user to first sub-tab if he is a leader\r\n                if (!$scope.current.hasRole(['admin', 'inherited_admin'])) {\r\n                    $scope.selectTab('team-members');\r\n                }\r\n\r\n                sendAnalytics();\r\n                $scope.current.isLoaded = false;\r\n                $scope.ministry = Ministries.getMinistry({ministry_id: ministry_id}, function () {\r\n                    $scope.current.isLoaded = true;\r\n                    //refresh the teams and team member view\r\n                    $scope.initTeamAndMembers();\r\n                    //load next data only if has permissions\r\n                    if ($scope.current.hasRole(['admin', 'inherited_admin'])) {\r\n                        //refresh the manage measurement view\r\n                        $scope.measurementTypes = [];\r\n                        $scope.current.loadLanguages();\r\n                        MeasurementTypes.getMeasurementTypes({ministry_id: ministry_id}).$promise.then(function (data) {\r\n                            angular.forEach(data, function (type) {\r\n                                if (type.is_custom && _.contains($scope.ministry.lmi_show, type.perm_link_stub)) {\r\n                                    type.visible = true;\r\n                                } else if (!type.is_custom && !_.contains($scope.ministry.lmi_hide, type.perm_link_stub)) {\r\n                                    type.visible = true;\r\n                                } else {\r\n                                    type.visible = false;\r\n                                }\r\n                                $scope.measurementTypes.push(type);\r\n                            });\r\n                        });\r\n                    }\r\n                });\r\n            } else {\r\n                $scope.current.redirectToHomeTab();\r\n            }\r\n        });\r\n\r\n        //function initializes sub-tabs of admin section\r\n        $scope.initSubTabs = function () {\r\n\r\n            //load all tab urls to scope\r\n            $scope.adminTabTemplates = getAdminSubTabTemplates();\r\n\r\n            //this is the default pill\r\n            if (typeof $scope.activePill === 'undefined') {\r\n                $scope.activePill = 'team-members';\r\n            }\r\n            //selecting current view for very first time\r\n            $scope.selectTab($scope.activePill);\r\n        };\r\n\r\n        //function selects current sub-tab for admin section\r\n        $scope.selectTab = function (tab) {\r\n\r\n            $scope.activePill = tab;\r\n\r\n            if (typeof tab === 'undefined') {\r\n                $scope.activePill = 'team-members';\r\n            }\r\n\r\n            //selecting current tab view\r\n            $scope.currentAdminTab = _.find(getAdminSubTabTemplates(), function (template) {\r\n                return (template.name === tab);\r\n            });\r\n        };\r\n\r\n        var getAdminSubTabTemplates = function () {\r\n\r\n            return [\r\n                {\r\n                    url: 'partials/admin/_team-members.html',\r\n                    name: 'team-members',\r\n                    label: 'Team & Members',\r\n                    requiredRoles: ['admin', 'inherited_admin', 'leader', 'inherited_leader']\r\n                },\r\n                {\r\n                    url: 'partials/admin/_edit-ministry.html',\r\n                    name: 'edit-ministry',\r\n                    label: 'Edit Ministry',\r\n                    requiredRoles: ['admin', 'inherited_admin']\r\n                },\r\n                {\r\n                    url: 'partials/admin/_measurement.html',\r\n                    name: 'measurement',\r\n                    label: 'Manage Measurements',\r\n                    requiredRoles: ['admin', 'inherited_admin']\r\n                }\r\n            ];\r\n        };\r\n\r\n        /** functions for edit-ministry and manage measurement tabs */\r\n        $scope.mccs = [\r\n            {value: 'ds', text: 'Digital Strategies', checked: false},\r\n            {value: 'gcm', text: 'Global Church Movements', checked: false},\r\n            {value: 'llm', text: 'Leader Led', checked: false},\r\n            {value: 'slm', text: 'Student Led', checked: false}\r\n        ];\r\n\r\n        $scope.ableToChangeParentMinistry = function (parentToFind) {\r\n            var availableMinIds = _.pluck($filter('roleFilter')($scope.current.ministries, ['admin', 'inherited_admin', 'leader', 'inherited_leader']), 'ministry_id');\r\n            return _.contains(availableMinIds, parentToFind);\r\n        };\r\n\r\n        $scope.getMCCValue = function (mcc) {\r\n            return _.contains($scope.ministry.mccs, mcc);\r\n        };\r\n\r\n        $scope.createMCCArray = function (status, value) {\r\n            if (status) {\r\n                if ($scope.ministry.mccs.indexOf(value) === -1) {\r\n                    $scope.ministry.mccs.push(value);\r\n                }\r\n            } else {\r\n                var index = $scope.ministry.mccs.indexOf(value);\r\n                if (index !== -1) {\r\n                    $scope.ministry.mccs.splice(index, 1);\r\n                }\r\n            }\r\n        };\r\n\r\n        $scope.saveDetails = function () {\r\n            //additional check if admin un-select all mccs then default_mcc should be empty\r\n            if (_.size($scope.mccs) == 0) {\r\n                $scope.ministry.default_mcc = '';\r\n            }\r\n\r\n            var ministry = {\r\n                ministry_id: $scope.ministry.ministry_id,\r\n                min_code: $scope.ministry.min_code,\r\n                name: $scope.ministry.name,\r\n                mccs: $scope.ministry.mccs,\r\n                content_locales: $scope.ministry.content_locales,\r\n                private: $scope.ministry.private,\r\n                hide_reports_tab: $scope.ministry.hide_reports_tab,\r\n                default_mcc: $scope.ministry.default_mcc,\r\n                lmi_hide: _.pluck(_.where($scope.measurementTypes, {\r\n                    is_custom: false,\r\n                    visible: false\r\n                }), 'perm_link_stub'),\r\n                lmi_show: _.pluck(_.where($scope.measurementTypes, {\r\n                    is_custom: true,\r\n                    visible: true\r\n                }), 'perm_link_stub')\r\n            };\r\n            if ($scope.ministry.hasOwnProperty('parent_id') && typeof $scope.ministry.parent_id === \"string\") {\r\n                ministry.parent_id = $scope.ministry.parent_id;\r\n            }\r\n            $scope.saveDetailsResource = Ministries.updateMinistry(ministry,\r\n                function () {\r\n                    //update current scope also\r\n                    $scope.current.assignment.name = angular.copy(ministry.name);\r\n                    $scope.current.assignment.mccs = angular.copy(ministry.mccs);\r\n                    $scope.current.assignment.content_locales = angular.copy(ministry.content_locales);\r\n                    growl.success(gettextCatalog.getString('Changes saved successfully'));\r\n                }, function (response) {\r\n                    growl.error(gettextCatalog.getString('Unable to save changes'));\r\n                });\r\n        };\r\n\r\n        $scope.addNewMeasurement = function () {\r\n            $modal.open({\r\n                templateUrl: 'partials/admin/add-measurement-type.html',\r\n                controller: function ($scope, $modalInstance) {\r\n                    $scope.newMeasurement = {};\r\n                    $scope.close = function () {\r\n                        $modalInstance.dismiss('cancel');\r\n                    };\r\n\r\n                    $scope.add = function () {\r\n                        $modalInstance.close($scope.newMeasurement);\r\n                    };\r\n                }\r\n            }).result.then(function (newMeasurement) {\r\n                    MeasurementTypes.addMeasurementType(newMeasurement, function (response) {\r\n                        growl.success(gettextCatalog.getString('Measurement was created successfully'));\r\n\r\n                        //push new measurement type to current list of measurement\r\n                        var new_measurement = angular.fromJson(angular.toJson(response));\r\n                        new_measurement.visible = false;\r\n                        $scope.measurementTypes.push(new_measurement);\r\n\r\n                    }, function () {\r\n                        growl.error(gettextCatalog.getString('Unable to create measurement'));\r\n                    });\r\n                });\r\n            scrollToTop();\r\n        };\r\n\r\n        $scope.editMeasurement = function (measurement) {\r\n\r\n            $modal.open({\r\n                templateUrl: 'partials/admin/edit-measurement-type.html',\r\n                controller: function ($scope, $modalInstance, modalData) {\r\n                    $scope.measurement = {};\r\n                    $scope.isLocaleLoaded = true;\r\n                    $scope.contentLocales = modalData.contentLocales;\r\n                    $scope.original = modalData.measurement;\r\n                    $scope.measurement.locale = modalData.supportedLanguages[0];\r\n\r\n                    $scope.close = function () {\r\n                        $modalInstance.dismiss('cancel');\r\n                    };\r\n\r\n                    $scope.filterByLangCode = function (lang) {\r\n\r\n                        return (_.contains(modalData.supportedLanguages, lang.iso_code)) ? lang : false;\r\n\r\n                    };\r\n                    $scope.save = function () {\r\n                        $modalInstance.close($scope.measurement);\r\n                    };\r\n\r\n                    $scope.changeLocale = function (locale) {\r\n                        if (locale === undefined || locale === '') return false;\r\n                        $scope.isLocaleLoaded = false;\r\n                        MeasurementTypes.getMeasurementType({\r\n                            measurement_type_id: modalData.measurement.perm_link_stub,\r\n                            ministry_id: modalData.ministry_id,\r\n                            locale: locale\r\n                        }, function (response) {\r\n                            $scope.measurement.localized_name = response.localize_name || response.localized_name;\r\n                            $scope.measurement.localized_description = response.localize_description || response.localized_description;\r\n                            $scope.isLocaleLoaded = true;\r\n                        }, function () {\r\n                            growl.error(gettextCatalog.getString('Unable to get measurement'));\r\n                            $scope.isLocaleLoaded = true;\r\n                        })\r\n                    };\r\n                    $scope.changeLocale($scope.measurement.locale);\r\n                },\r\n                resolve: {\r\n                    'modalData': function () {\r\n                        return {\r\n                            measurement: angular.copy(measurement),\r\n                            ministry_id: $scope.current.assignment.ministry_id,\r\n                            contentLocales: $scope.availableLanguages,\r\n                            supportedLanguages: $scope.ministry.content_locales || {}\r\n                        }\r\n                    }\r\n                }\r\n            }).result.then(function (form) {\r\n                    form.measurement_type_id = measurement.perm_link_stub;\r\n                    form.ministry_id = $scope.current.assignment.ministry_id;\r\n\r\n                    MeasurementTypes.updateMeasurementType(form, function (response) {\r\n                        growl.success(gettextCatalog.getString('Measurement was updated'));\r\n                    }, function () {\r\n                        growl.error(gettextCatalog.getString('Unable to update measurement'));\r\n                    });\r\n\r\n\r\n                });\r\n            scrollToTop();\r\n        };\r\n\r\n        /** functions for team-members tab **/\r\n\r\n        $scope.roles = [\r\n            {value: \"admin\", text: 'Admin'},\r\n            {value: \"inherited_admin\", text: 'Admin (inherited)'},\r\n            {value: \"leader\", text: 'Leader'},\r\n            {value: \"inherited_leader\", text: \"Leader (inherited)\"},\r\n            {value: \"member\", text: 'Member'},\r\n            {value: \"blocked\", text: 'Deleted'},\r\n            {value: \"former_member\", text: 'Former Member'},\r\n            {value: \"self_assigned\", text: 'Self Assigned'}\r\n        ];\r\n\r\n        $scope.initTeamAndMembers = function () {\r\n            $scope.allCurrentTeams = [];\r\n            $scope.allCurrentTeams.push(angular.copy($scope.current.assignment));\r\n\r\n            $scope.activeTeamMembers = {};\r\n            if ($scope.ministry.hasOwnProperty('team_members')) {\r\n                $scope.activeTeamMembers = angular.copy($scope.ministry.team_members);\r\n            }\r\n            //activate first top most team\r\n            $scope.activeTeam = angular.copy($scope.current.assignment);\r\n            $scope.membersLoaded = true;\r\n        };\r\n\r\n        $scope.setActiveTeam = function (team) {\r\n            //prevent ajax request if clicked team is already active\r\n            if ($scope.activeTeam.ministry_id === team.ministry_id) {\r\n                return false;\r\n            }\r\n\r\n            $scope.activeTeam = team;\r\n            //load selected ministry members\r\n            $scope.loadMinistryMembers(team.ministry_id);\r\n\r\n        };\r\n        $scope.loadMinistryMembers = function (ministry_id) {\r\n            $scope.membersLoaded = false;\r\n            //pull down the selected ministry team members, and update scope\r\n            Ministries.getMinistry({ministry_id: ministry_id}, function (response) {\r\n                $scope.activeTeamMembers = response.team_members;\r\n                $scope.membersLoaded = true;\r\n            }, function () {\r\n                growl.error(gettextCatalog.getString('Unable to load team members'));\r\n                $scope.membersLoaded = true;\r\n            });\r\n        };\r\n\r\n        $scope.filter = {\r\n            memberSearch: '',\r\n            inheritedLeader: true,\r\n            inheritedAdmin: true,\r\n            deletedUser: false,\r\n            formerMember: false,\r\n            checkFormer: function (item) {\r\n                return $scope.filter.formerMember ? true : item.team_role != 'former_member';\r\n            },\r\n            checkDeleted: function (item) {\r\n                return $scope.filter.deletedUser ? true : item.team_role != 'blocked';\r\n            },\r\n            checkLeader: function (item) {\r\n                return $scope.filter.inheritedLeader ? true : item.team_role != 'inherited_leader';\r\n            },\r\n            checkAdmin: function (item) {\r\n                return $scope.filter.inheritedAdmin ? true : item.team_role != 'inherited_admin';\r\n            }\r\n\r\n        };\r\n\r\n        $scope.addNewTeamMember = function () {\r\n            $modal.open({\r\n                templateUrl: 'partials/admin/add-team-member.html',\r\n                controller: function ($scope, $modalInstance, modalData) {\r\n                    $scope.roles = modalData.roles;\r\n                    $scope.activeTeamName = modalData.activeTeam;\r\n\r\n                    $scope.close = function () {\r\n                        $modalInstance.dismiss();\r\n                    };\r\n\r\n                    $scope.add = function () {\r\n                        $modalInstance.close($scope.newMember);\r\n                    };\r\n                },\r\n                resolve: {\r\n                    'modalData': function () {\r\n                        return {\r\n                            roles: $scope.roles,\r\n                            activeTeam: $scope.activeTeam.name\r\n                        }\r\n                    }\r\n                }\r\n            }).result.then(function (newMember) {\r\n                    if (typeof newMember === 'undefined') return false;\r\n                    newMember.ministry_id = $scope.activeTeam.ministry_id;\r\n                    Assignments.addTeamMember(newMember, function (response) {\r\n                        growl.success(gettextCatalog.getString('New member was added successfully'));\r\n                        //refresh members list\r\n                        //todo append new member to current member list instead of refreshing team list\r\n                        $scope.loadMinistryMembers($scope.activeTeam.ministry_id);\r\n\r\n                    }, function (response) {\r\n                        if (response.status === 404) {\r\n                            growl.error(gettextCatalog.getString('Failed, User not found'));\r\n                        } else {\r\n                            growl.error(gettextCatalog.getString('Unable to add new member'));\r\n                        }\r\n                    });\r\n                });\r\n            scrollToTop();\r\n        };\r\n\r\n        $scope.updateUserRole = function (old_role, user) {\r\n\r\n            if (old_role === user.team_role) {\r\n                return false;\r\n            }\r\n\r\n            $modal.open({\r\n                templateUrl: 'partials/admin/confirm-update-role.html',\r\n                controller: function ($scope, $modalInstance, userInfo) {\r\n                    $scope.userInfo = userInfo;\r\n\r\n                    $scope.no = function () {\r\n                        $modalInstance.dismiss();\r\n                    };\r\n\r\n                    $scope.yes = function () {\r\n                        $modalInstance.close(true);\r\n                    };\r\n                    $scope.getRoleName = function (role) {\r\n                        return getActualRoleName(role);\r\n                    }\r\n                },\r\n                resolve: {\r\n                    'userInfo': function () {\r\n                        return {\r\n                            old_role: angular.copy(old_role),\r\n                            user: angular.copy(user)\r\n                        };\r\n                    }\r\n                }\r\n            }).result.then(function (c) {\r\n                    //check if user has a real assignment\r\n                    if (typeof user.assignment_id !== 'undefined' && user.assignment_id.trim() !== '') {\r\n                        //update user role\r\n                        Assignments.saveAssignment({assignment_id: user.assignment_id}, {team_role: user.team_role}, function () {\r\n                            growl.success(gettextCatalog.getString('User role was updated'));\r\n                            //success so update old_role in scope also\r\n                            old_role = user.team_role;\r\n\r\n                        }, function () {\r\n                            growl.error(gettextCatalog.getString('Unable to update user role'));\r\n                            //if failed lets restore old role\r\n                            user.team_role = old_role;\r\n                        });\r\n                    } else {\r\n                        //if user does not hav a real assignment it should a new Assignment call\r\n                        var post_data = {\r\n                            ministry_id: $scope.activeTeam.ministry_id,\r\n                            key_guid: user.key_guid || '',\r\n                            username: user.key_username || '',\r\n                            team_role: user.team_role\r\n                        };\r\n                        Assignments.addTeamMember(post_data, function (response) {\r\n                            growl.success(gettextCatalog.getString('User role was updated'));\r\n                            //refresh members list\r\n                            //todo update user_role and assignment_id in scope instead of refreshing list\r\n                            $scope.loadMinistryMembers($scope.activeTeam.ministry_id);\r\n\r\n                        }, function () {\r\n                            growl.error(gettextCatalog.getString('Unable to update user role'));\r\n                            //if failed lets restore old role\r\n                            user.team_role = old_role;\r\n\r\n                        });\r\n                    }\r\n\r\n                }, function () {\r\n                    //restore user role upon cancel\r\n                    user.team_role = old_role;\r\n                });\r\n\r\n            scrollToTop();\r\n\r\n        };\r\n\r\n        $scope.addNewSubMinistry = function () {\r\n            $modal.open({\r\n                templateUrl: 'partials/admin/add-sub-ministry.html',\r\n                controller: function ($scope, $modalInstance, modalData) {\r\n                    $scope.newMinistry = {};\r\n                    $scope.activeTeamName = modalData.activeTeam;\r\n                    $scope.close = function () {\r\n                        $modalInstance.dismiss();\r\n                    };\r\n\r\n                    $scope.add = function () {\r\n                        $modalInstance.close($scope.newMinistry);\r\n                    };\r\n                },\r\n                resolve: {\r\n                    'modalData': function () {\r\n                        return {\r\n                            activeTeam: $scope.activeTeam.name\r\n                        };\r\n                    }\r\n                }\r\n            }).result.then(function (newMinistry) {\r\n                    if (typeof newMinistry === 'undefined') return false;\r\n\r\n                    newMinistry.parent_id = $scope.activeTeam.ministry_id;\r\n\r\n                    Ministries.createMinistry(newMinistry, function (response) {\r\n                        growl.success(gettextCatalog.getString('Sub ministry was created successfully'));\r\n\r\n                        var got_ministry = {\r\n                            ministry_id: response.id,\r\n                            name: response.name,\r\n                            min_code: response.min_code,\r\n                            parent_id: response.parent_id\r\n                        };\r\n                        //append newly created ministry to current select team\r\n                        if (angular.isDefined($scope.activeTeam.sub_ministries)) {\r\n                            $scope.activeTeam.sub_ministries.push(got_ministry);\r\n                        } else {\r\n                            $scope.activeTeam.sub_ministries = [got_ministry];\r\n                        }\r\n\r\n                    }, function () {\r\n                        growl.error(gettextCatalog.getString('Unable to add sub ministry'));\r\n                    });\r\n                });\r\n\r\n            scrollToTop();\r\n\r\n        };\r\n\r\n        function scrollToTop() {\r\n            window.setTimeout(function () {\r\n                window.parent.scrollTo(0, 0);\r\n            }, 10);\r\n        }\r\n\r\n        $scope.memberDraggableOptions = {\r\n            containment: \"#team-member-pane\",\r\n            refreshPositions: true,\r\n            cursorAt: {bottom: 0},\r\n            helper: function (event) {\r\n                var tr = $(event.target).closest('tr');\r\n                var first_name = tr.find('td:first').text();\r\n                var last_name = tr.find('td:nth-child(2)').text();\r\n                var email = tr.find('td:nth-child(3)').text();\r\n                var hide = (email === '') ? 'none' : 'hide';\r\n                return $('<tr class=\"drag-member\"><td><i class=\"glyphicon glyphicon-user\"></i></td><td>' + first_name + '</td><td>' + last_name + '</td><td style=\"display:' + hide + '\">' + email + '</td></tr>');\r\n\r\n            }\r\n        };\r\n        $scope.teamDraggableOptions = {\r\n            refreshPositions: true,\r\n            helper: function (event) {\r\n                var team = $(event.target).closest('span').text();\r\n                return $('<span class=\"drag-team\"><i class=\"glyphicon glyphicon-certificate\"></i> ' + team + '</span>');\r\n            }\r\n        };\r\n        $scope.teamOnStart = function (event, ui, team) {\r\n            $scope.draggedType = 'team';\r\n            $scope.draggedTeam = team;\r\n        };\r\n        $scope.memberOnStart = function (event, ui, member) {\r\n            $scope.draggedType = 'member';\r\n            $scope.draggedMember = member;\r\n        };\r\n\r\n        /**\r\n         * Function will be fired when a team/member is dropped on a team\r\n         * @param event\r\n         * @param ui\r\n         * @param team The team on which a team/member is being dropped\r\n         * @returns {boolean}\r\n         */\r\n        $scope.teamOnDrop = function (event, ui, team) {\r\n            $(event.target).removeClass('drag-on-over');\r\n\r\n            //case when moving team\r\n            if ($scope.draggedType === 'team') {\r\n                var draggedTeam = angular.copy($scope.draggedTeam);\r\n                //update ministry parent id\r\n                var ministry = {\r\n                    ministry_id: $scope.draggedTeam.ministry_id,\r\n                    min_code: $scope.draggedTeam.min_code,\r\n                    parent_id: team.ministry_id\r\n                };\r\n                Ministries.updateMinistry(ministry, function (response) {\r\n                    growl.success(gettextCatalog.getString('Ministry was moved successfully'));\r\n                    //append team to new location\r\n                    if (team.hasOwnProperty('sub_ministries')) {\r\n                        team.sub_ministries.push(draggedTeam);\r\n                    } else {\r\n                        team.sub_ministries = [];\r\n                        team.sub_ministries.push(draggedTeam);\r\n                    }\r\n                    //remove team from list\r\n                    if ($scope.draggedTeam.ministry_id === ministry.ministry_id) {\r\n                        $scope.draggedTeam.hide_after_drop = true;\r\n                    }\r\n                }, function () {\r\n                    growl.error(gettextCatalog.getString('Unable to move ministry'));\r\n                });\r\n\r\n                //case when moving member\r\n            } else if ($scope.draggedType === 'member') {\r\n                var member = {\r\n                    assignment_id: $scope.draggedMember.assignment_id,\r\n                    key_guid: $scope.draggedMember.key_guid,\r\n                    username: $scope.draggedMember.key_username,\r\n                    team_role: $scope.draggedMember.team_role,\r\n                    ministry_id: team.ministry_id\r\n                };\r\n\r\n                Assignments.addTeamMember(member, function () {\r\n                    $scope.draggedMember.team_role = 'former_member';\r\n                    growl.success(gettextCatalog.getString('Member was moved to ministry successfully'));\r\n                    //set user's old role to former_member\r\n                    Assignments.saveAssignment({assignment_id: member.assignment_id}, {team_role: 'former_member'}, function () {\r\n                        $scope.draggedMember.team_role = 'former_member';\r\n                    }, function () {\r\n                        //restore upon fail\r\n                        $scope.draggedMember.team_role = member.team_role;\r\n                    });\r\n                }, function () {\r\n                    growl.error(gettextCatalog.getString('Unable to move member'));\r\n                });\r\n            } else {\r\n                return false;\r\n            }\r\n\r\n        };\r\n\r\n        /**\r\n         * Function will be fired just before drop event\r\n         * @param event\r\n         * @param ui\r\n         * @param team Then team on which the object is being dropped\r\n         * @returns {boolean}\r\n         */\r\n        $scope.teamBeforeDrop = function (event, ui, team) {\r\n            $(event.target).removeClass('drag-on-over');\r\n            // detect what type of object is being dropped and show relate popup\r\n            if ($scope.draggedType == 'team') {\r\n                //check if team can be dropped or not\r\n                if (team.ministry_id === $scope.draggedTeam.parent_id) {\r\n                    growl.error(gettextCatalog.getString(\"Drop canceled, can't be dropped on parent team\"));\r\n                    return {\r\n                        then: function () {\r\n                            return false;\r\n                        }\r\n                    };\r\n                } else if (team.parent_id === $scope.draggedTeam.ministry_id) {\r\n                    growl.error(gettextCatalog.getString(\"Drop canceled, can't be dropped on child team\"));\r\n                    return {\r\n                        then: function () {\r\n                            return false;\r\n                        }\r\n                    };\r\n                } else if ($scope.draggedTeam.hasOwnProperty('sub_ministries') && checkIfDroppingOnChildTeam($scope.draggedTeam, team)) {\r\n                    growl.error(gettextCatalog.getString(\"Drop canceled, can't be dropped on child team\"));\r\n                    return {\r\n                        then: function () {\r\n                            return false;\r\n                        }\r\n                    };\r\n                } else {\r\n                    return confirmTeamDrop(team);\r\n                }\r\n\r\n            } else if ($scope.draggedType == 'member') {\r\n                //prevent member drop on current active team itself\r\n                if ($scope.activeTeam.ministry_id === team.ministry_id) {\r\n                    growl.error(gettextCatalog.getString(\"Drop canceled, can't be dropped on selected team\"));\r\n                    return {\r\n                        then: function () {\r\n                            return false;\r\n                        }\r\n                    };\r\n                } else {\r\n                    return confirmMemberDrop(team);\r\n                }\r\n\r\n            } else {\r\n                return false;\r\n            }\r\n\r\n        };\r\n\r\n        function confirmMemberDrop(team) {\r\n            var modalInstance = $modal.open({\r\n                templateUrl: 'partials/admin/confirm-member-drop.html',\r\n                controller: function ($scope, $modalInstance, modalData) {\r\n                    $scope.member = modalData.member;\r\n                    $scope.team = modalData.team;\r\n\r\n                    $scope.yes = function () {\r\n                        $modalInstance.close();\r\n                    };\r\n                    $scope.no = function () {\r\n                        $modalInstance.dismiss('cancel');\r\n                    };\r\n                    $scope.getRoleName = function (role) {\r\n                        return getActualRoleName(role);\r\n                    }\r\n                },\r\n                resolve: {\r\n                    modalData: function () {\r\n                        return {\r\n                            member: $scope.draggedMember,\r\n                            team: team\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            scrollToTop();\r\n            return modalInstance.result;\r\n\r\n        }\r\n\r\n        function confirmTeamDrop(team) {\r\n            var modalInstance = $modal.open({\r\n                templateUrl: 'partials/admin/confirm-team-drop.html',\r\n                controller: function ($scope, $modalInstance, modalData) {\r\n                    $scope.source_team = modalData.source;\r\n                    $scope.target_team = modalData.target;\r\n\r\n                    $scope.yes = function () {\r\n                        $modalInstance.close();\r\n                    };\r\n                    $scope.no = function () {\r\n                        $modalInstance.dismiss('cancel');\r\n                    };\r\n\r\n                },\r\n                resolve: {\r\n                    modalData: function () {\r\n                        return {\r\n                            source: $scope.draggedTeam.name,\r\n                            target: team.name\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            scrollToTop();\r\n            return modalInstance.result;\r\n\r\n        }\r\n\r\n        $scope.teamOnOver = function (event, ui, teamCollapsed) {\r\n            $(event.target).addClass('drag-on-over');\r\n            //expand tree if collapsed\r\n            if (teamCollapsed === true) {\r\n                angular.element(event.target).find('i').trigger('click');\r\n            }\r\n        };\r\n\r\n        $scope.teamOnOut = function (event) {\r\n            $(event.target).removeClass('drag-on-over');\r\n        };\r\n\r\n        $scope.isMemberDraggable = function (member) {\r\n            //if member does not have assignment id\r\n            if (typeof member.assignment_id === 'undefined' || member.assignment_id.trim() === '') {\r\n                return false;\r\n            }\r\n            //members who don't have key_guid or key_username are not be movable\r\n            else if (typeof member.key_guid === 'undefined') {\r\n                return false\r\n            } else if (typeof member.key_username === 'undefined') {\r\n                return false;\r\n            } else if (member.key_guid == '') {\r\n                return false;\r\n            } else if (member.key_username == '') {\r\n                return false;\r\n            }\r\n            //members who has these roles are not movable too\r\n            return !_.contains(['inherited_admin', 'inherited_leader', 'blocked', 'former_member'], member.team_role)\r\n        };\r\n\r\n\r\n        $scope.getCurrentUserRole = function (role) {\r\n            return getActualRoleName(role);\r\n        };\r\n\r\n        function getActualRoleName(role) {\r\n            var found_role = _.find($scope.roles, function (r) {\r\n                return r.value === role;\r\n            });\r\n\r\n            if (found_role !== undefined) {\r\n                return found_role.text;\r\n            }\r\n            return role;\r\n        }\r\n\r\n\r\n        function checkIfDroppingOnChildTeam(sourceTeam, targetTeam) {\r\n            var flatTeams = UserPreference.getFlatMinistry(angular.copy(sourceTeam.sub_ministries));\r\n            //check if target is in source team's list\r\n            var foundAsChild = _.find(flatTeams, function (team) {\r\n                return team.ministry_id === targetTeam.ministry_id;\r\n            });\r\n\r\n            return (foundAsChild !== undefined);\r\n        }\r\n\r\n    }\r\n\r\n    angular.module('gma.controllers.admin').controller('AdminCtrl', AdminCtrl);\r\n}());\r\n","(function () {\r\n\t'use strict';\r\n\r\n\tfunction ErrorCtrl( $scope, Settings ) {\r\n\t\t$scope.current.isLoaded = true;\r\n\r\n\t\t$scope.loginUrl = Settings.api.login;\r\n\t}\r\n\r\n\tangular.module( 'gma.controllers.error' ).controller( 'ErrorCtrl', ErrorCtrl );\r\n}());\r\n","(function ($) {\r\n    'use strict';\r\n\r\n    function MapCtrl($scope, $compile, Trainings, Churches, Ministries, Settings, GoogleAnalytics, UserPreference, $modal, growl, ISOCountries, TargetCity, Stories, gettextCatalog) {\r\n        $scope.current.isLoaded = false;\r\n        $scope.versionUrl = Settings.versionUrl;\r\n        $scope.area_codes = _.sortBy(Settings.area_codes, 'name');\r\n\r\n        $scope.new_church = {};\r\n        $scope.new_training = {};\r\n        $scope.new_targetCity = {};\r\n        $scope.edit_church = {};\r\n        //a flag for parent mode\r\n        $scope.SetParentMode = false;\r\n\r\n        $scope.church_lines = [];\r\n        $scope.churches = [];\r\n        $scope.trainings = [];\r\n        $scope.targetCities = [];\r\n        $scope.training_types = [\r\n            {value: \"MC2\", text: 'MC2'},\r\n            {value: \"T4T\", text: 'T4T'},\r\n            {value: \"CPMI\", text: 'CPMI'},\r\n            {value: \"\", text: 'Other'}\r\n        ];\r\n        //for filters/checkbox on sidebar\r\n        $scope.iconFilters = {\r\n            training: true,\r\n            targetCity: true,\r\n            target_point: true,\r\n            group: true,\r\n            church: true,\r\n            mult_church: true,\r\n            parent_lines: true,\r\n            jesus_film: true\r\n        };\r\n        //for radio button filter\r\n        $scope.map_scope_filter = 'min_only';\r\n        //sub-stages for target city\r\n        $scope.targetCitySubStages = [\r\n            {val: '0', name: '0 - Nothing yet', stage: 0},\r\n            {val: '0a', name: '0a - Pioneering', stage: 0},\r\n            {val: '1a', name: '1a - Startup (1-5 Groups)', stage: 1},\r\n            {val: '1b', name: '1b - Solidification (5-10 groups)', stage: 1},\r\n            {val: '2', name: '2 - Growth (> 10 groups)', stage: 2},\r\n            {val: '3', name: '3 - Partnering (>30 groups)', stage: 3}\r\n        ];\r\n\r\n        //default map options\r\n        var defaultMapOptions = {\r\n            zoom: 3,\r\n            center: new google.maps.LatLng(0, 0),\r\n            panControl: true,\r\n            zoomControl: true,\r\n            zoomControlOptions: {\r\n                position: google.maps.ControlPosition.LEFT_CENTER\r\n            },\r\n            mapTypeControl: true,\r\n            mapTypeControlOptions: {\r\n                style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,\r\n                position: google.maps.ControlPosition.TOP_RIGHT\r\n            },\r\n            streetViewControl: false,\r\n            overviewMapControl: false\r\n        };\r\n        $scope.supportsGeoLocation = typeof navigator.geolocation !== 'undefined';\r\n        setTimeout(initialize, 0);\r\n\r\n        var sendAnalytics = _.throttle(function () {\r\n\r\n            GoogleAnalytics.screen('Map', (function () {\r\n                var dimensions = {};\r\n                dimensions[GoogleAnalytics.DIM.guid] = $scope.current.user.key_guid;\r\n                if (angular.isDefined($scope.current.assignment.ministry_id)) {\r\n                    dimensions[GoogleAnalytics.DIM.ministry_id] = $scope.current.assignment.ministry_id;\r\n                }\r\n                if (angular.isDefined($scope.current.mcc)) {\r\n                    dimensions[GoogleAnalytics.DIM.mcc] = $scope.current.mcc;\r\n                }\r\n                if (angular.isDefined($scope.current.period)) {\r\n                    dimensions[GoogleAnalytics.DIM.period] = $scope.current.period.format('YYYY-MM');\r\n                }\r\n                return dimensions;\r\n            })());\r\n        }, 1000, {leading: false});\r\n\r\n        function initialize() {\r\n            //init google map\r\n            $scope.map = new google.maps.Map(document.getElementById('map_canvas'), defaultMapOptions);\r\n            $scope.map.setOptions({draggableCursor: ''});\r\n\r\n            google.maps.event.addListener($scope.map, \"idle\", function () {\r\n                $scope.current.isLoaded = true;\r\n                var bounds = $scope.map.getBounds(),\r\n                    ne = bounds.getNorthEast(),\r\n                    sw = bounds.getSouthWest();\r\n\r\n                if (ne.lat() == sw.lat() && ne.lng() == sw.lng()) {\r\n                    // Trigger a resize if bounds have 0 area\r\n                    google.maps.event.trigger($scope.map, 'resize');\r\n                }\r\n                else {\r\n                    $scope.loadChurches();\r\n                }\r\n            });\r\n            $scope.map.markers = [];\r\n            $scope.church = {name: \"\"};\r\n            //edit church\r\n            $scope.churchWindow = new google.maps.InfoWindow();\r\n            $scope.churchWindowContent = $compile('<div id=\"church_window_content\" ng-include=\"\\'partials/map/edit-church.html\\'\"></div>')($scope)\r\n            $scope.churchWindow.setOptions({maxWidth: 300});\r\n            //edit training\r\n            $scope.trainingWindow = new google.maps.InfoWindow();\r\n            $scope.trainingWindowContent = $compile('<div id=\"training_window_content\" ng-include=\"\\'partials/map/edit-training.html\\'\"></div>')($scope)\r\n            $scope.trainingWindow.setOptions({maxWidth: 400});\r\n            //edit target city\r\n            $scope.targetCityWindow = new google.maps.InfoWindow();\r\n            $scope.targetCityWindowContent = $compile('<div id=\"traget_city_window_content\" ng-include=\"\\'partials/map/edit-target-city.html\\'\"></div>')($scope)\r\n            $scope.targetCityWindow.setOptions({maxWidth: 300});\r\n\r\n            //new church\r\n            $scope.newChurchWindow = new google.maps.InfoWindow();\r\n            google.maps.event.addListener($scope.newChurchWindow, 'closeclick', function () {\r\n                $scope.cancelAddNewIcon();\r\n            });\r\n            $scope.newChurchWindowContent = $compile('<div id=\"new_church_window_content\" ng-include=\"\\'partials/map/new-church.html\\'\"></div>')($scope);\r\n            $scope.newChurchWindow.setOptions({maxWidth: 300});\r\n            //new training\r\n            $scope.newTrainingWindow = new google.maps.InfoWindow();\r\n            google.maps.event.addListener($scope.newTrainingWindow, 'closeclick', function () {\r\n                $scope.cancelAddNewIcon();\r\n            });\r\n            $scope.newTrainingContent = $compile('<div id=\"new_training_window_content\" ng-include=\"\\'partials/map/new-training.html\\'\"></div>')($scope);\r\n            $scope.newTrainingWindow.setOptions({maxWidth: 300});\r\n            //new target city\r\n            $scope.newTargetCityWindow = new google.maps.InfoWindow();\r\n            google.maps.event.addListener($scope.newTargetCityWindow, 'closeclick', function () {\r\n                $scope.cancelAddNewIcon();\r\n            });\r\n            $scope.newTargetCityContent = $compile('<div id=\"new_target_city_window_content\" ng-include=\"\\'partials/map/new-target-city.html\\'\"></div>')($scope);\r\n            $scope.newTargetCityWindow.setOptions({maxWidth: 300});\r\n\r\n\r\n            $scope.map.church_lines = [];\r\n\r\n            $scope.map.icons = {\r\n                church: new google.maps.MarkerImage(\r\n                    Settings.versionUrl('img/icon/church.png'),\r\n                    new google.maps.Size(60, 60),\r\n                    new google.maps.Point(0, 0),\r\n                    new google.maps.Point(30, 58)\r\n                ),\r\n                cluster: new google.maps.MarkerImage(\r\n                    Settings.versionUrl('img/icon/cluster.png'),\r\n                    new google.maps.Size(60, 60),\r\n                    new google.maps.Point(0, 0),\r\n                    new google.maps.Point(30, 31)\r\n                ),\r\n                multiplying: new google.maps.MarkerImage(\r\n                    Settings.versionUrl('img/icon/multiplying.png'),\r\n                    new google.maps.Size(60, 60),\r\n                    new google.maps.Point(0, 0),\r\n                    new google.maps.Point(30, 53)\r\n                ),\r\n                group: new google.maps.MarkerImage(\r\n                    Settings.versionUrl('img/icon/group.png'),\r\n                    new google.maps.Size(60, 60),\r\n                    new google.maps.Point(0, 0),\r\n                    new google.maps.Point(30, 55)\r\n                ),\r\n                targetpoint: new google.maps.MarkerImage(\r\n                    Settings.versionUrl('img/icon/target.png'),\r\n                    new google.maps.Size(60, 60),\r\n                    new google.maps.Point(0, 0),\r\n                    new google.maps.Point(32, 56)\r\n                ),\r\n                training: new google.maps.MarkerImage(\r\n                    Settings.versionUrl('img/icon/training.png'),\r\n                    new google.maps.Size(60, 60),\r\n                    new google.maps.Point(0, 0),\r\n                    new google.maps.Point(30, 43)\r\n                ),\r\n                targetCity: new google.maps.MarkerImage(\r\n                    Settings.versionUrl('img/icon/target-city.png'),\r\n                    new google.maps.Size(60, 60), //size in pixel\r\n                    new google.maps.Point(0, 0), //The origin for this image is 0,0\r\n                    new google.maps.Point(30, 43)  // The anchor for this image\r\n                )\r\n            };\r\n\r\n            //map sidebar and controls\r\n            $scope.map.side = document.getElementById('side');\r\n            $scope.map.side.index = -1;\r\n            $scope.map.side.style.display = 'block';\r\n            $scope.map.search = document.getElementById('map_controls');\r\n            $scope.map.search.index = 3;\r\n            $scope.map.search.style.display = 'block';\r\n\r\n            $scope.map.controls[google.maps.ControlPosition.TOP_RIGHT].push($scope.map.side);\r\n            $scope.map.controls[google.maps.ControlPosition.TOP_LEFT].push($scope.map.search);\r\n            //search box control\r\n            $scope.autocomplete = new google.maps.places.Autocomplete(document.getElementById('searchBox'));\r\n            $scope.autocomplete.bindTo('bounds', $scope.map);\r\n\r\n            google.maps.event.addListener($scope.autocomplete, 'place_changed', function () {\r\n                var place = $scope.autocomplete.getPlace();\r\n                if (!place.geometry) {\r\n                    return;\r\n                }\r\n\r\n                if (place.geometry.viewport) {\r\n                    $scope.map.fitBounds(place.geometry.viewport);\r\n                } else {\r\n                    $scope.map.setCenter(place.geometry.location);\r\n                    $scope.map.setZoom(15);\r\n                }\r\n                //close any newIcon window\r\n                $scope.cancelAddNewIcon();\r\n            });\r\n\r\n            if ($scope.current.assignment) {\r\n                load_training_markers();\r\n            }\r\n\r\n            $scope.$watch('current.assignment', function (assignment, oldVal) {\r\n                if (typeof assignment !== 'undefined') {\r\n                    //set default, be fail safe\r\n                    var latitude, longitude, zoom;\r\n\r\n                    if (assignment && assignment.hasOwnProperty('location')) {\r\n                        latitude = assignment.location.latitude;\r\n                        longitude = assignment.location.longitude;\r\n                    }\r\n                    if (assignment && assignment.hasOwnProperty('location_zoom')) {\r\n                        zoom = assignment.location_zoom;\r\n                    }\r\n\r\n                    //checking if user preference is set\r\n                    if (typeof $scope.current.user_preferences === 'object' && typeof $scope.current.user_preferences.default_map_views === 'object') {\r\n\r\n                        //if user preference has default view\r\n                        var default_map_view = _.find($scope.current.user_preferences.default_map_views, function (view) {\r\n                            return (view.ministry_id === $scope.current.assignment.ministry_id);\r\n                        });\r\n\r\n                        if (typeof default_map_view !== 'undefined') {\r\n                            //overriding default view by user preference\r\n                            latitude = default_map_view.location.latitude;\r\n                            longitude = default_map_view.location.longitude;\r\n                            zoom = default_map_view.location_zoom;\r\n                        }\r\n\r\n                    }\r\n\r\n                    //lastly set map view\r\n                    if (typeof latitude !== 'undefined' && typeof longitude !== 'undefined' && typeof zoom !== 'undefined') {\r\n                        $scope.map.setCenter(new google.maps.LatLng(latitude, longitude));\r\n                        $scope.map.setZoom(parseInt(zoom));\r\n                    }\r\n\r\n                }\r\n            }, true);\r\n        }//end init function\r\n\r\n        //if user changes ministry\r\n        $scope.$watch('current.assignment.ministry_id', function (ministry_id) {\r\n            if (typeof ministry_id === 'undefined') {\r\n                $scope.trainings = [];\r\n            } else {\r\n                sendAnalytics();\r\n                $scope.loadTrainings();\r\n                $scope.isTargetCitiesVisible = isTargetCityVisible();\r\n                $scope.loadTargetCities();\r\n            }\r\n        });\r\n\r\n        $scope.$watch('map_scope_filter', function (filter) {\r\n            if(filter === undefined) return;\r\n            $scope.loadChurches();\r\n            $scope.loadTrainings();\r\n        });\r\n\r\n        //if user changes mcc\r\n        $scope.$watch('current.mcc', function (mcc) {\r\n            if (typeof mcc === 'undefined') {\r\n                $scope.trainings = [];\r\n            } else {\r\n                sendAnalytics();\r\n                $scope.loadChurches();\r\n                $scope.loadTrainings();\r\n                $scope.isTargetCitiesVisible = isTargetCityVisible();\r\n                $scope.loadTargetCities();\r\n            }\r\n        });\r\n\r\n        //hit the API and update scope with response\r\n        $scope.loadTargetCities = _.debounce(function () {\r\n            //some additional checks\r\n            if ($scope.isTargetCitiesVisible && typeof $scope.current.assignment !== 'undefined' && $scope.current.mcc === 'llm' && $scope.current.assignment.area_code !== 'undefined') {\r\n                var bounds = $scope.map.getBounds(),\r\n                    ne = bounds.getNorthEast(),\r\n                    sw = bounds.getSouthWest(),\r\n                    params = {\r\n                        lat_min: sw.lat(),\r\n                        lat_max: ne.lat(),\r\n                        long_min: sw.lng(),\r\n                        long_max: ne.lng(),\r\n                        period: $scope.current.period.format('YYYY-MM'),\r\n                        area_code: $scope.current.assignment.area_code\r\n                    };\r\n                TargetCity.searchTargetCities(params)\r\n                    .success(function (response) {\r\n                        $scope.targetCities = response\r\n                    })\r\n                    .error(function (e) {\r\n                        growl.error(gettextCatalog.getString('Unable to load target cities'));\r\n                    })\r\n            }\r\n            else {\r\n                $scope.targetCities = [];\r\n            }\r\n        }, 500);\r\n\r\n        $scope.loadTrainings = _.debounce(function () {\r\n            // Everyone can view trainings\r\n            var show_tree = false;\r\n            var show_all = false; //false means show past 12 months activity only, this does not relate to map_scope_filter, please see api wiki docs\r\n            if ($scope.map_scope_filter === 'everything' || $scope.map_scope_filter === 'tree') {\r\n                show_tree = true;\r\n            }\r\n            if (typeof $scope.current.assignment !== 'undefined' && $scope.current.mcc !== 'undefined') {\r\n                Trainings.getTrainings($scope.current.sessionToken, $scope.current.assignment.ministry_id, $scope.current.mcc, show_all, show_tree).then(function (trainings) {\r\n                    $scope.trainings = trainings;\r\n                }, function () {\r\n                    growl.error(gettextCatalog.getString('Unable to load trainings'));\r\n                });\r\n            }\r\n            else {\r\n                $scope.trainings = [];\r\n            }\r\n        }, 500);\r\n\r\n        $scope.loadChurches = _.debounce(function () {\r\n\r\n            if (typeof $scope.current.assignment === 'undefined') return;\r\n\r\n            var bounds = $scope.map.getBounds(),\r\n                ne = bounds.getNorthEast(),\r\n                sw = bounds.getSouthWest(),\r\n                params = {\r\n                    ministry_id: $scope.current.assignment.ministry_id,\r\n                    lat_min: sw.lat(),\r\n                    lat_max: ne.lat(),\r\n                    long_min: sw.lng(),\r\n                    long_max: ne.lng(),\r\n                    period: $scope.current.period.format('YYYY-MM')\r\n                };\r\n            if (!$scope.iconFilters.target_point) params['hide_target_point'] = 'true';\r\n            if (!$scope.iconFilters.group) params['hide_group'] = 'true';\r\n            if (!$scope.iconFilters.church) params['hide_church'] = 'true';\r\n            if (!$scope.iconFilters.mult_church) params['hide_mult_church'] = 'true';\r\n\r\n            if ($scope.map_scope_filter === 'everything') {\r\n                params['show_all'] = 'true';\r\n            } else if ($scope.map_scope_filter === 'tree') {\r\n                params['show_tree'] = 'true';\r\n            }\r\n\r\n            // Disable clustering at Zoom 14 and higher\r\n            if ($scope.map.getZoom() >= 14) params['should_cluster'] = 'false';\r\n\r\n            Churches.getChurches(params).$promise.then($scope.onGetChurches);\r\n        }, 500);\r\n\r\n\r\n        $scope.$watch('iconFilters.parent_lines', function () {\r\n            if (typeof $scope.map !== 'undefined') {\r\n                angular.forEach($scope.map.church_lines, function (line) {\r\n                    line.setVisible($scope.iconFilters.parent_lines);\r\n                });\r\n            }\r\n        });\r\n\r\n        $scope.$watch('iconFilters.jesus_film', function () {\r\n            if ($scope.iconFilters.jesus_film) {\r\n                $('.jf_label').show();\r\n            } else {\r\n                $('.jf_label').hide();\r\n            }\r\n        });\r\n\r\n        $scope.onAddChurch = function (church) {\r\n            GoogleAnalytics.event('church', 'create', (function () {\r\n                var dimensions = {};\r\n                dimensions[GoogleAnalytics.DIM.guid] = $scope.current.user.key_guid;\r\n                if (angular.isDefined($scope.current.assignment.ministry_id)) {\r\n                    dimensions[GoogleAnalytics.DIM.ministry_id] = $scope.current.assignment.ministry_id;\r\n                }\r\n                if (angular.isDefined($scope.current.mcc)) {\r\n                    dimensions[GoogleAnalytics.DIM.mcc] = $scope.current.mcc;\r\n                }\r\n                if (angular.isDefined($scope.current.period)) {\r\n                    dimensions[GoogleAnalytics.DIM.period] = $scope.current.period.format('YYYY-MM');\r\n                }\r\n                dimensions[GoogleAnalytics.DIM.church_id] = church.id;\r\n                return dimensions;\r\n            })());\r\n            $scope.loadChurches();\r\n        };\r\n        //creating new church icon, hit the API\r\n        $scope.addChurch = function () {\r\n            $scope.newChurchWindow.close();\r\n            angular.forEach($scope.map.markers, function (m) {\r\n\r\n                if (m.id == -1) {\r\n                    var newChurch = angular.copy($scope.new_church);\r\n                    newChurch.ministry_id = $scope.current.assignment.ministry_id;\r\n                    newChurch.latitude = m.getPosition().lat();\r\n                    newChurch.longitude = m.getPosition().lng();\r\n                    newChurch.jf_contrib = ($scope.new_church.jf_contrib == 1);\r\n\r\n                    Churches.addChurch(newChurch).$promise.then(function (response) {\r\n                            growl.success(gettextCatalog.getString('Church was created'));\r\n                            $scope.onAddChurch(response);\r\n                        }, function (e) {\r\n                            growl.error(gettextCatalog.getString('Unable to create church'));\r\n                        }\r\n                    );\r\n\r\n                    m.setMap(null);\r\n                    var removedObject = $scope.map.markers.splice($scope.map.markers.indexOf(m), 1);\r\n\r\n                    removedObject = null;\r\n                }\r\n            });\r\n        };\r\n        //create new training icon, hit the API\r\n        $scope.addTraining = function () {\r\n            angular.forEach($scope.map.markers, function (m) {\r\n\r\n                if (m.id == -2) {\r\n                    $scope.new_training.ministry_id = $scope.current.assignment.ministry_id;\r\n                    $scope.new_training.latitude = m.getPosition().lat();\r\n                    $scope.new_training.longitude = m.getPosition().lng();\r\n                    $scope.new_training.mcc = $scope.current.mcc;\r\n                    Trainings.addTraining($scope.current.sessionToken, $scope.new_training).then(function () {\r\n                            growl.success(gettextCatalog.getString('Training was created'));\r\n                            $scope.loadTrainings();\r\n                        }\r\n                    );\r\n\r\n                    m.setMap(null);\r\n                    var removedObject = $scope.map.markers.splice($scope.map.markers.indexOf(m), 1);\r\n\r\n                    removedObject = null;\r\n                }\r\n            });\r\n        };\r\n        //create new target city, hit the API\r\n        $scope.addTargetCity = function (new_targetCity) {\r\n            angular.forEach($scope.map.markers, function (m) {\r\n\r\n                if (m.id == -3) {\r\n                    new_targetCity.latitude = m.getPosition().lat();\r\n                    new_targetCity.longitude = m.getPosition().lng();\r\n                    new_targetCity.period = $scope.current.period.format('YYYY-MM');\r\n                    //send current ministry area_code to server\r\n                    if ($scope.current.assignment.area_code !== 'GLBL') {\r\n                        new_targetCity.area_code = $scope.current.assignment.area_code;\r\n                    }\r\n\r\n                    TargetCity.createTargetCity(new_targetCity)\r\n                        .success(function () {\r\n                            growl.success(gettextCatalog.getString('Target city was created successfully'));\r\n                            new_targetCity = {};\r\n                            //refresh target city icons\r\n                            $scope.loadTargetCities();\r\n                        }).error(function (e) {\r\n                            if (e.status === 400) {\r\n                                growl.error(gettextCatalog.getString('Bad Request: Unable to create target city'));\r\n                            } else {\r\n                                growl.error(gettextCatalog.getString('Error: Unable to create target city'));\r\n                            }\r\n\r\n                        });\r\n\r\n                    m.setMap(null);\r\n                    var removedObject = $scope.map.markers.splice($scope.map.markers.indexOf(m), 1);\r\n\r\n                    removedObject = null;\r\n                }\r\n            })\r\n        };\r\n\r\n        $scope.cancelAddNewIcon = function () {\r\n            angular.forEach($scope.map.markers, function (m) {\r\n                //cause all dialog windows has ids like -1,-2,-3\r\n                if (m.id < 0) {\r\n\r\n                    m.setMap(null);\r\n                    var removedObject = $scope.map.markers.splice($scope.map.markers.indexOf(m), 1);\r\n\r\n                    removedObject = null;\r\n                }\r\n            });\r\n            $scope.new_church = {};\r\n            $scope.new_training = {};\r\n            $scope.new_targetCity = {};\r\n        };\r\n        //show create new training dialog\r\n        $scope.onAddTraining = function () {\r\n            if ($scope.map.markers.filter(function (c) {\r\n                    return c.id < 0\r\n                }).length == 0) {\r\n                $scope.new_training = {};\r\n\r\n                var marker = new MarkerWithLabel({\r\n                    position: $scope.map.getCenter(),\r\n                    map: $scope.map,\r\n                    title: \"new_training\",\r\n                    id: -2,\r\n                    cluster_count: 1,\r\n                    zIndex: 9999,\r\n                    icon: $scope.map.icons.training,\r\n                    labelContent: 'MOVE ME!',\r\n                    labelAnchor: new google.maps.Point(50, -5),\r\n                    labelClass: \"labelMoveMarker\", // the CSS class for the label\r\n                    labelInBackground: false,\r\n                    draggable: true\r\n                });\r\n\r\n                marker.setAnimation(google.maps.Animation.BOUNCE);\r\n\r\n                if (!$scope.newTrainingWindow.getContent()) {\r\n                    $scope.newTrainingWindow.setContent($scope.newTrainingContent[0].nextSibling);\r\n                }\r\n                $scope.newTrainingWindow.open($scope.map, marker);\r\n\r\n                $scope.map.markers.push(marker);\r\n            }\r\n        };\r\n        //show create new target city dialog\r\n        $scope.onAddTargetCity = function () {\r\n            if ($scope.map.markers.filter(function (c) {\r\n                    return c.id < 0\r\n                }).length == 0) {\r\n                $scope.new_targetCity = {};\r\n\r\n                var marker = new MarkerWithLabel({\r\n                    position: $scope.map.getCenter(),\r\n                    map: $scope.map,\r\n                    title: \"new_targetCity\",\r\n                    id: -3, //unique id for each type of icons used on the map\r\n                    cluster_count: 1,\r\n                    zIndex: 9999,\r\n                    icon: $scope.map.icons.targetCity,\r\n                    labelContent: 'MOVE ME!',\r\n                    labelAnchor: new google.maps.Point(50, -5),\r\n                    labelClass: \"labelMoveMarker\", // the CSS class for the label\r\n                    labelInBackground: false,\r\n                    draggable: true\r\n                });\r\n                marker.setAnimation(google.maps.Animation.BOUNCE);\r\n\r\n                if (!$scope.newTargetCityWindow.getContent()) {\r\n                    $scope.newTargetCityWindow.setContent($scope.newTargetCityContent[0].nextSibling);\r\n                }\r\n                $scope.newTargetCityWindow.open($scope.map, marker);\r\n                //get iso countries if not loaded yet\r\n                getISOCountries();\r\n                $scope.map.markers.push(marker);\r\n            }\r\n        };\r\n\r\n        function getISOCountries() {\r\n\r\n            //don't not hit api if we already have ISOCountries\r\n            if (typeof $scope.ISOCountries !== 'undefined' && $scope.ISOCountries.length !== 0) {\r\n                return $scope.ISOCountries;\r\n            } else {\r\n                ISOCountries.getCountries()\r\n                    .success(function (response) {\r\n                        $scope.ISOCountries = response;\r\n                        $scope.ISOCountries = _.sortBy($scope.ISOCountries, 'name');\r\n                    })\r\n                    .error(function () {\r\n                        growl.error(gettextCatalog.getString('Unable to load countries list'));\r\n                    });\r\n            }\r\n\r\n        }\r\n\r\n        $scope.onSaveChurch = function (response) {\r\n            $scope.loadChurches();\r\n        };\r\n        // show create new church icon dialog\r\n        $scope.onAddIcon = function () {\r\n            if ($scope.map.markers.filter(function (c) {\r\n                    return c.id < 0\r\n                }).length == 0) {\r\n                $scope.new_church = {security: 2};\r\n\r\n                var marker = new MarkerWithLabel({\r\n                    position: $scope.map.getCenter(),\r\n                    map: $scope.map,\r\n                    title: \"new church\",\r\n                    id: -1,\r\n                    cluster_count: 1,\r\n                    zIndex: 9999,\r\n                    icon: $scope.map.icons.targetpoint,\r\n                    labelContent: 'Move me!',\r\n                    labelAnchor: new google.maps.Point(50, -20),\r\n                    labelClass: \"labelMoveMarker\", // the CSS class for the label\r\n                    labelInBackground: false,\r\n                    draggable: true\r\n                });\r\n\r\n                marker.setAnimation(google.maps.Animation.BOUNCE);\r\n\r\n                if (!$scope.newChurchWindow.getContent()) {\r\n                    $scope.newChurchWindow.setContent($scope.newChurchWindowContent[0].nextSibling);\r\n                }\r\n                $scope.newChurchWindow.open($scope.map, marker);\r\n\r\n                $scope.map.markers.push(marker);\r\n            }\r\n        };\r\n\r\n        $scope.SetParent = function () {\r\n            $scope.SetParentMode = true;\r\n            $scope.churchWindow.close();\r\n            $scope.new_parentLine = new google.maps.Polyline({\r\n                path: [new google.maps.LatLng($scope.edit_church.latitude, $scope.edit_church.longitude), new google.maps.LatLng($scope.edit_church.latitude, $scope.edit_church.longitude)],\r\n                geodesic: true,\r\n                strokeColor: '#777',\r\n                strokeOpacity: 1.0,\r\n                strokeWeight: 2,\r\n                icons: [{\r\n                    icon: {\r\n                        path: google.maps.SymbolPath.FORWARD_OPEN_ARROW,\r\n                        strokeWeight: 1.5\r\n                    },\r\n                    offset: '12px',\r\n                    repeat: '25px'\r\n                }]\r\n            });\r\n\r\n            $scope.move_event = google.maps.event.addListener($scope.map, 'mousemove', function (e) {\r\n                $scope.new_parentLine.setPath([e.latLng, new google.maps.LatLng($scope.edit_church.latitude, $scope.edit_church.longitude)]);\r\n            });\r\n\r\n            $scope.new_parentLine.setMap($scope.map);\r\n        };\r\n\r\n        /**\r\n         * Press ESC to cancel SetParent for churches\r\n         * @param evt\r\n         */\r\n        document.onkeydown = function (evt) {\r\n            evt = evt || window.event;\r\n            if ($scope.SetParentMode && evt.keyCode == 27) {\r\n                google.maps.event.removeListener($scope.move_event);\r\n                $scope.SetParentMode = false;\r\n                $scope.new_parentLine.setMap(null);\r\n            }\r\n        };\r\n\r\n        $scope.$on('$destroy', function () {\r\n            document.onkeydown = null\r\n        });\r\n\r\n\r\n        $scope.RemoveParent = function () {\r\n            $scope.churchWindow.close();\r\n            $scope.edit_church.parent_id = null;\r\n            $scope.edit_church.parents = [];\r\n            Churches.saveChurch({\r\n                id: $scope.edit_church.id,\r\n                parent_id: -1\r\n            }).$promise.then($scope.onSaveChurch);\r\n\r\n        };\r\n\r\n        $scope.makeMovableIcon = {\r\n\r\n            MoveChurch: function () {\r\n                angular.forEach($scope.map.markers, function (m) {\r\n                    if (m.id === $scope.edit_church.id) {\r\n                        m.setAnimation(google.maps.Animation.BOUNCE);\r\n                        m.setDraggable(true);\r\n                        $scope.churchWindow.close();\r\n                    }\r\n                });\r\n            },\r\n            MoveTraining: function () {\r\n                var id = $scope.edit_training.id;\r\n                angular.forEach($scope.map.markers, function (m) {\r\n                    if (m.id === 't' + id) {\r\n                        m.setAnimation(google.maps.Animation.BOUNCE);\r\n                        m.setDraggable(true);\r\n                        $scope.trainingWindow.close();\r\n                    }\r\n                });\r\n            },\r\n            MoveTargetCity: function () {\r\n                var id = $scope.edit_targetCity.target_city_id;\r\n                angular.forEach($scope.map.markers, function (m) {\r\n                    if (m.id === 'c' + id) {\r\n                        m.setAnimation(google.maps.Animation.BOUNCE);\r\n                        m.setDraggable(true);\r\n                        $scope.targetCityWindow.close();\r\n                    }\r\n                });\r\n            }\r\n\r\n        };\r\n\r\n        $scope.updateChurch = function () {\r\n            $scope.churchWindow.close();\r\n            var church = angular.copy($scope.edit_church);\r\n            church.jf_contrib = ($scope.edit_church.jf_contrib == 1);\r\n            delete church.editable;\r\n            Churches.saveChurch(church).$promise\r\n                .then(function (response) {\r\n                    growl.success(gettextCatalog.getString('Church was updated successfully'));\r\n                    $scope.onSaveChurch(response)\r\n                },\r\n                function () {\r\n                    growl.error(gettextCatalog.getString('Unable to update church'));\r\n                }\r\n            );\r\n        };\r\n\r\n        $scope.DeleteChurch = function () {\r\n\r\n            //before delete opening a confirmation dialog\r\n            $modal.open({\r\n                templateUrl: 'partials/map/_confirmation-dialog.html',\r\n                controller: confirmModalCtrl\r\n            }).result.then(function (result) {\r\n                    // Set end_date to the last day of the previous month\r\n                    $scope.edit_church.end_date = moment().subtract(1, 'months').endOf('month').format('YYYY-MM-DD');\r\n                    Churches.saveChurch($scope.edit_church).$promise.then(\r\n                        function (response) {\r\n                            growl.success(gettextCatalog.getString('Church was deleted successfully'));\r\n                            $scope.onSaveChurch(response)\r\n                        }, function () {\r\n                            growl.error(gettextCatalog.getString('Unable to delete church'));\r\n                        });\r\n                });\r\n            scrollToTop();\r\n        };\r\n\r\n        $scope.updateTraining = function () {\r\n            Trainings.updateTraining($scope.current.sessionToken, $scope.edit_training).then(\r\n                function (response) {\r\n                    growl.success(gettextCatalog.getString('Training was updated'));\r\n                    $scope.onSaveChurch(response);\r\n                }, function () {\r\n                    growl.error(gettextCatalog.getString('Unable to update training'));\r\n                }\r\n            );\r\n            $scope.trainingWindow.close();\r\n        };\r\n\r\n        $scope.updateTrainingCompletion = function (data) {\r\n            Trainings.updateTrainingCompletion($scope.current.sessionToken, data).then(function () {\r\n                growl.success(gettextCatalog.getString('Training was updated'));\r\n            });\r\n        };\r\n\r\n        $scope.updateTargetCity = function (targetCity) {\r\n            //send current ministry area_code to server\r\n            if ($scope.current.assignment.area_code !== 'GLBL') {\r\n                targetCity.area_code = $scope.current.assignment.area_code;\r\n            }\r\n            TargetCity.updateTargetCity(targetCity)\r\n                .success(function (response) {\r\n                    growl.success(gettextCatalog.getString('Target city was updated'));\r\n                }).error(function (e) {\r\n                    growl.error(gettextCatalog.getString('Unable to update target city'));\r\n                });\r\n            $scope.targetCityWindow.close();\r\n        };\r\n\r\n        $scope.$watch('trainings', function () {\r\n            if ($scope.map) {\r\n                load_training_markers();\r\n            }\r\n        });\r\n\r\n        function load_training_markers() {\r\n            if (typeof $scope.map === 'undefined') return;\r\n            var toDelete = [];\r\n\r\n            angular.forEach($scope.map.markers, function (training) {\r\n                if (training.id[0] == 't' && $scope.trainings.filter(function (t) {\r\n                        return t.id == training.id\r\n                    }).length == 0) {\r\n                    toDelete.push(training);\r\n                }\r\n                else if (training.id[0] == 't' && !$scope.iconFilters.training) toDelete.push(training);\r\n            });\r\n\r\n            angular.forEach(toDelete, function (training) {\r\n                training.setMap(null);\r\n                var removedObject = $scope.map.markers.splice($scope.map.markers.indexOf(training), 1);\r\n                removedObject = null;\r\n            });\r\n\r\n            if ($scope.iconFilters.training) {\r\n                angular.forEach($scope.trainings, function (training) {\r\n                    if ($scope.map.markers.filter(function (c) {\r\n                            return c.id === 't' + training.id\r\n                        }).length == 0) {\r\n                        if (training.longitude) {\r\n                            var marker = new MarkerWithLabel({\r\n                                position: new google.maps.LatLng(training.latitude, training.longitude),\r\n                                map: $scope.map,\r\n                                id: 't' + training.id,\r\n                                title: training.name + ' (' + training.type + ')',\r\n                                icon: $scope.map.icons.training,\r\n                                labelContent: '', //training.type + '<span class=\"map-trained-count\">' + training.leaders_trained + '</span>',\r\n                                labelAnchor: new google.maps.Point(30, 0),\r\n                                labelClass: \"labelMarker\", // the CSS class for the label\r\n                                labelInBackground: false,\r\n                                draggable: false\r\n                            });\r\n                            marker.setAnimation(google.maps.Animation.DROP);\r\n                            if (!$scope.trainingWindow.getContent()) {\r\n                                $scope.trainingWindow.setContent($scope.trainingWindowContent[0].nextSibling);\r\n                            }\r\n\r\n                            google.maps.event.addListener(marker, 'click', (function (training, marker) {\r\n                                return function () {\r\n                                    $scope.edit_training = training;\r\n\r\n                                    //checking if training is editable\r\n                                    $scope.edit_training.editable = false;\r\n\r\n                                    var parent_ids = getParentMinistryIds($scope.current.assignments, $scope.edit_training);\r\n\r\n                                    //if training ministry id is child or equal to parent id\r\n                                    var parent_id = _.find(parent_ids, function (id) {\r\n                                        return id === $scope.current.assignment.ministry_id;\r\n                                    });\r\n\r\n                                    //checking if parent id is not empty\r\n                                    if (typeof parent_id !== 'undefined') {\r\n\r\n                                        //if training ministry id is same as parent id\r\n                                        if ($scope.edit_training.ministry_id === parent_id) {\r\n\r\n                                            if ($scope.edit_training.created_by === $scope.current.user.person_id || isLeaderAdmin() === true) {\r\n                                                $scope.edit_training.editable = true;\r\n                                            }\r\n\r\n                                            //case for parent ministry trying to edit(checking user role before giving permission)\r\n                                        } else if (isLeaderAdmin() === true) {\r\n                                            $scope.edit_training.editable = true;\r\n                                        }\r\n                                    }\r\n\r\n                                    $scope.$apply();\r\n                                    $scope.trainingWindow.close();\r\n                                    $scope.trainingWindow.setOptions({maxWidth: 400});\r\n                                    $scope.trainingWindow.open($scope.map, marker);\r\n\r\n                                }\r\n                            }(training, marker, $scope)));\r\n\r\n                            google.maps.event.addListener(marker, 'dragend', (function () {\r\n                                training.latitude = marker.getPosition().lat();\r\n                                training.longitude = marker.getPosition().lng();\r\n                                Trainings.updateTraining($scope.current.sessionToken, training).then($scope.onSaveChurch);\r\n                                marker.setAnimation(null);\r\n                                marker.setDraggable(false);\r\n                            }));\r\n\r\n                            $scope.map.markers.push(marker);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        //watch for icon filters\r\n        $scope.$watch('iconFilters.training', load_training_markers, true);\r\n        $scope.$watch('iconFilters.targetCity', function () {\r\n            load_target_city_markers();\r\n        }, true);\r\n\r\n        //watch for server response\r\n        $scope.$watch('targetCities', function () {\r\n            if ($scope.map) {\r\n                load_target_city_markers();\r\n            }\r\n        });\r\n\r\n        function load_target_city_markers() {\r\n            if (typeof $scope.map === 'undefined') return;\r\n            //note: using 'c' as a prefix in target city markers id\r\n            var toDelete = [];\r\n            //collect cities to be deleted\r\n            angular.forEach($scope.map.markers, function (targetCity) {\r\n                if (targetCity.id[0] == 'c' && $scope.targetCities.filter(function (t) {\r\n                        return targetCity.id === 'c' + t.target_city_id;\r\n                    }).length == 0) {\r\n                    toDelete.push(targetCity);\r\n                }\r\n                else if (targetCity.id[0] == 'c' && !$scope.iconFilters.targetCity) toDelete.push(targetCity);\r\n            });\r\n            //remove target cities from markers\r\n            angular.forEach(toDelete, function (targetCity) {\r\n                targetCity.setMap(null);\r\n                var removedObject = $scope.map.markers.splice($scope.map.markers.indexOf(targetCity), 1);\r\n                removedObject = null;\r\n            });\r\n\r\n            if ($scope.isTargetCitiesVisible && $scope.iconFilters.targetCity) {\r\n                angular.forEach($scope.targetCities, function (targetCity) {\r\n                    if ($scope.map.markers.filter(function (c) {\r\n                            return c.id === 'c' + targetCity.target_city_id;\r\n                        }).length == 0) {\r\n                        if (targetCity.longitude) {\r\n                            var marker = new MarkerWithLabel({\r\n                                position: new google.maps.LatLng(targetCity.latitude, targetCity.longitude),\r\n                                map: $scope.map,\r\n                                id: 'c' + targetCity.target_city_id,\r\n                                title: targetCity.name,\r\n                                icon: $scope.map.icons.targetCity,\r\n                                labelContent: '',\r\n                                labelAnchor: new google.maps.Point(30, 0),\r\n                                labelClass: \"labelMarker\", // the CSS class for the label\r\n                                labelInBackground: false,\r\n                                draggable: false\r\n                            });\r\n                            marker.setAnimation(google.maps.Animation.DROP);\r\n                            if (!$scope.targetCityWindow.getContent()) {\r\n                                $scope.targetCityWindow.setContent($scope.targetCityWindowContent[0].nextSibling);\r\n                            }\r\n                            //register events on icon/marker\r\n                            google.maps.event.addListener(marker, 'click', (function (targetCity, marker) {\r\n                                return function () {\r\n                                    $scope.edit_targetCity = targetCity;\r\n\r\n                                    $scope.$apply();\r\n                                    $scope.targetCityWindow.close();\r\n                                    $scope.targetCityWindow.setOptions({maxWidth: 300});\r\n\r\n                                    getISOCountries();\r\n                                    $scope.targetCityWindow.open($scope.map, marker);\r\n\r\n                                }\r\n                            }(targetCity, marker, $scope)));\r\n\r\n                            //update marker lat and lang (position) upon drag\r\n                            google.maps.event.addListener(marker, 'dragend', (function () {\r\n                                targetCity.latitude = marker.getPosition().lat();\r\n                                targetCity.longitude = marker.getPosition().lng();\r\n\r\n                                TargetCity.updateTargetCity(targetCity)\r\n                                    .success(function (response) {\r\n                                        growl.success(gettextCatalog.getString('Target city position was updated'));\r\n                                    }).error(function (e) {\r\n                                        growl.error(gettextCatalog.getString('Unable to update target city'))\r\n                                    });\r\n                                marker.setAnimation(null);\r\n                                marker.setDraggable(false);\r\n                            }));\r\n\r\n                            $scope.map.markers.push(marker);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n        }\r\n\r\n        $scope.onGetChurches = function (response) {\r\n            if ($scope.current.mcc === 'gcm') {\r\n                $scope.churches = response;\r\n            } else {\r\n                response = [];\r\n                $scope.churches = [];\r\n            }\r\n\r\n            //remove church lines\r\n            angular.forEach($scope.map.church_lines, function (l) {\r\n                l.setMap(null);\r\n            });\r\n\r\n            // do more intelligent replace\r\n            //remove elements that are not in the new one.\r\n            var toDelete = [];\r\n\r\n            angular.forEach($scope.map.markers, function (church) {\r\n                if (church.id > 0) {\r\n                    if (response.filter(function (c) {\r\n                            return c.id == church.id && c.cluster_count == 1\r\n                        }).length == 0 || church.cluster_count > 1) {\r\n                        toDelete.push(church);\r\n                    }\r\n                }\r\n            });\r\n\r\n            angular.forEach(toDelete, function (church) {\r\n                //remove jf icons one by one\r\n                angular.element('div#map_canvas div#jf_icon_' + church.id + '.jf_label').remove();\r\n                church.setMap(null);\r\n                var removedObject = $scope.map.markers.splice($scope.map.markers.indexOf(church), 1);\r\n\r\n                removedObject = null;\r\n            });\r\n\r\n\r\n            angular.forEach($scope.churches, function (church) {\r\n                if ($scope.map.markers.filter(function (c) {\r\n                        return c.id == church.id\r\n                    }).length == 0) {\r\n                    var marker = {};\r\n\r\n                    if (church.cluster_count == 1) {\r\n                        var churchIconToUse = {};\r\n                        if (church.development == 5) {\r\n                            churchIconToUse = $scope.map.icons.multiplying;\r\n                        }\r\n                        else if (church.development == 4) {\r\n                            churchIconToUse = $scope.map.icons.church;\r\n                        }\r\n                        else if (church.development == 3) {\r\n                            churchIconToUse = $scope.map.icons.church;\r\n                        }\r\n                        else if (church.development == 2) {\r\n                            churchIconToUse = $scope.map.icons.group;\r\n                        }\r\n                        else if (church.development == 1) {\r\n                            churchIconToUse = $scope.map.icons.targetpoint;\r\n                        }\r\n                        else {\r\n                            churchIconToUse = $scope.map.icons.church;\r\n                        }\r\n\r\n                        marker = new MarkerWithLabel({\r\n                            position: new google.maps.LatLng(church.latitude, church.longitude),\r\n                            map: $scope.map,\r\n                            title: church.name,\r\n                            id: church.id,\r\n                            cluster_count: church.cluster_count,\r\n                            icon: churchIconToUse,\r\n                            labelContent: church.name,\r\n                            labelAnchor: new google.maps.Point(30, 0),\r\n                            labelClass: \"labelMarker\", // the CSS class for the label\r\n                            labelInBackground: false,\r\n                            draggable: false\r\n                        });\r\n                        marker.setAnimation(google.maps.Animation.DROP);\r\n                        if (church.jf_contrib >= 1) {\r\n                            new $scope.jesusFilmSign(new google.maps.LatLng(church.latitude, church.longitude), church.jf_contrib, church.development, church.id);\r\n                        }\r\n                    }\r\n                    else {\r\n                        marker = new MarkerWithLabel({\r\n                            position: new google.maps.LatLng(church.latitude, church.longitude),\r\n                            map: $scope.map,\r\n                            title: 'Click to zoom',\r\n                            id: church.id,\r\n                            cluster_count: church.cluster_count,\r\n                            icon: $scope.map.icons.cluster,\r\n                            labelContent: church.cluster_count.toString(),\r\n                            labelAnchor: new google.maps.Point(30, 15),\r\n                            labelClass: \"clusterMarker\", // the CSS class for the label\r\n                            labelInBackground: false\r\n\r\n                        });\r\n                        if (church.jf_contrib > 1) {\r\n                            new $scope.jesusFilmSign(new google.maps.LatLng(church.latitude, church.longitude), church.jf_contrib, 'cluster', church.id);\r\n                        }\r\n\r\n                    }\r\n                    if (!$scope.churchWindow.getContent()) {\r\n                        $scope.churchWindow.setContent($scope.churchWindowContent[0].nextSibling);\r\n                    }\r\n\r\n                    google.maps.event.addListener(marker, 'click', (function (church, marker) {\r\n                        return function () {\r\n                            if ($scope.SetParentMode) {\r\n                                if (church.cluster_count == 1 && church.id !== $scope.edit_church.id && !_.contains(church.parents, $scope.edit_church.id)) {\r\n                                    google.maps.event.removeListener($scope.move_event);\r\n                                    $scope.SetParentMode = false;\r\n                                    $scope.new_parentLine.setPath([new google.maps.LatLng(church.latitude, church.longitude), new google.maps.LatLng($scope.edit_church.latitude, $scope.edit_church.longitude)]);\r\n                                    //update church's parent\r\n                                    var new_church = {};\r\n                                    new_church.id = $scope.edit_church.id;\r\n                                    new_church.parent_id = church.id;\r\n                                    $scope.edit_church.parent_id = church.id;\r\n                                    $scope.edit_church.parents = [church.id];\r\n                                    Churches.saveChurch(new_church).$promise.then($scope.onSaveChurch);\r\n                                }\r\n                                else {\r\n                                    google.maps.event.removeListener($scope.move_event);\r\n                                    $scope.SetParentMode = false;\r\n                                    $scope.new_parentLine.setMap(null);\r\n                                }\r\n                                return;\r\n                            }\r\n\r\n                            if (church.cluster_count == 1) {\r\n                                $scope.edit_church = church;\r\n                                $scope.edit_church.jf_contrib = ($scope.edit_church.jf_contrib >= 1 ) ? 1 : 0;\r\n\r\n                                //checking if church is editable\r\n                                $scope.edit_church.editable = false;\r\n                                var parent_ids = getParentMinistryIds($scope.current.assignments, $scope.edit_church);\r\n\r\n                                //if training ministry id is child or equal to parent id\r\n                                var parent_id = _.find(parent_ids, function (id) {\r\n                                    return id === $scope.current.assignment.ministry_id;\r\n                                });\r\n\r\n                                //checking if parent id is not empty\r\n                                if (typeof parent_id !== 'undefined') {\r\n\r\n                                    //if ministry id is same as parent id\r\n                                    if ($scope.edit_church.ministry_id === parent_id) {\r\n\r\n                                        if ($scope.edit_church.created_by === $scope.current.user.person_id || isLeaderAdmin() === true) {\r\n                                            $scope.edit_church.editable = true;\r\n                                        }\r\n\r\n                                        //case for parent ministry trying to edit(checking user role before giving permission)\r\n                                    } else if (isLeaderAdmin() === true) {\r\n                                        $scope.edit_church.editable = true;\r\n                                    }\r\n                                }\r\n\r\n                                $scope.$apply();\r\n                                $scope.churchWindow.close();\r\n                                $scope.churchWindow.setOptions({maxWidth: 300});\r\n                                $scope.churchWindow.open($scope.map, marker);\r\n                            }\r\n                            else {\r\n                                $scope.map.setCenter(marker.position);\r\n                                $scope.map.setZoom($scope.map.getZoom() + 2);\r\n                            }\r\n                        }\r\n                    }(church, marker, $scope)));\r\n\r\n                    google.maps.event.addListener(marker, 'dragend', (function (church, marker) {\r\n                        return function () {\r\n\r\n                            if (church.cluster_count == 1) {\r\n                                var new_church = {};\r\n                                new_church.id = church.id;\r\n                                new_church.latitude = marker.getPosition().lat();\r\n                                new_church.longitude = marker.getPosition().lng();\r\n                                church.latitude = new_church.latitude;\r\n                                church.longitude = new_church.longitude;\r\n                                Churches.saveChurch(new_church).$promise.then($scope.onSaveChurch);\r\n\r\n                                marker.setAnimation(null);\r\n                                marker.setDraggable(false);\r\n                            }\r\n\r\n                        }\r\n                    }(church, marker)));\r\n                    $scope.map.markers.push(marker);\r\n                }\r\n\r\n\r\n                //now create the parent lines\r\n                angular.forEach(church.parents, function (p) {\r\n                    var par = $scope.churches.filter(function (c) {\r\n                        return c.id == p\r\n                    });\r\n                    if (par.length > 0) {\r\n                        var parentLine = new google.maps.Polyline({\r\n                            path: [new google.maps.LatLng(par[0].latitude, par[0].longitude), new google.maps.LatLng(church.latitude, church.longitude)],\r\n                            geodesic: true,\r\n                            strokeColor: '#777',\r\n                            strokeOpacity: 1.0,\r\n                            strokeWeight: 2,\r\n                            icons: [{\r\n                                icon: {\r\n                                    path: google.maps.SymbolPath.FORWARD_OPEN_ARROW,\r\n                                    strokeWeight: 1.5\r\n                                },\r\n                                offset: '12px',\r\n                                repeat: '25px'\r\n                            }]\r\n                        });\r\n                        parentLine.setMap($scope.map);\r\n                        $scope.map.church_lines.push(parentLine);\r\n                    }\r\n                });\r\n\r\n\r\n            });\r\n\r\n\r\n        };\r\n\r\n        /**\r\n         * Draws a jesus film rectangle icon on map\r\n         * @param coordinates\r\n         * @param number\r\n         * @param type\r\n         * @param id church id\r\n         */\r\n        $scope.jesusFilmSign = function (coordinates, number, type, id) {\r\n            this.div_ = null;\r\n            this.setMap($scope.map);\r\n            if (number == 1) number = \"JF\";\r\n\r\n            // onADD\r\n            this.onAdd = function () {\r\n                var div = document.createElement('div');\r\n                div.className = 'jf_label';\r\n                div.id = 'jf_icon_' + id;\r\n                div.innerHTML = number;\r\n                this.div_ = div;\r\n                var panes = this.getPanes();\r\n                panes.overlayMouseTarget.appendChild(div);\r\n            };\r\n\r\n            // draw\r\n            this.draw = function () {\r\n                var div = this.div_;\r\n                var overlayProjection = this.getProjection();\r\n                var position = overlayProjection.fromLatLngToDivPixel(coordinates);\r\n\r\n                // displacement of sign\r\n                var x;\r\n                var y;\r\n\r\n                if (type == 'cluster') {\r\n                    x = -20;\r\n                    y = 8;\r\n                }\r\n\r\n                else if (type >= 0 && type <= 1) {\r\n                    x = -23;\r\n                    y = -12;\r\n                }\r\n\r\n                else if (type == 2) {\r\n                    x = -22;\r\n                    y = -13;\r\n                }\r\n\r\n                else if (type >= 3) {\r\n                    x = -20;\r\n                    y = -13;\r\n                }\r\n\r\n                else {\r\n                    x = 0;\r\n                    y = 0;\r\n                }\r\n\r\n                div.style.left = position.x + x + \"px\";\r\n                div.style.top = position.y + y + \"px\";\r\n            };\r\n\r\n            this.onRemove = function () {\r\n                this.div_.parentNode.removeChild($scope.div_);\r\n                this.div_ = null;\r\n            }\r\n        };\r\n        $scope.jesusFilmSign.prototype = new google.maps.OverlayView();\r\n\r\n        $scope.addTrainingStage = function (training) {\r\n            if (training.insert === undefined || training.insert.date === undefined || training.insert.number_completed === undefined) return false;\r\n            var newPhase = {\r\n                phase: training.current_stage,\r\n                date: training.insert.date,\r\n                number_completed: training.insert.number_completed,\r\n                training_id: training.id\r\n\r\n            };\r\n            Trainings.addTrainingCompletion($scope.current.sessionToken, newPhase).then($scope.onAddTrainingCompletion);\r\n\r\n            training.insert.date = \"\";\r\n            training.insert.number_completed = 0;\r\n\r\n        };\r\n\r\n        $scope.onAddTrainingCompletion = function (response) {\r\n            response.editMode = false;\r\n            growl.success(gettextCatalog.getString('Training was saved successfully'));\r\n            angular.forEach($scope.trainings, function (training) {\r\n                var id = training.hasOwnProperty('Id') ? training.Id : training.id;\r\n                if (id == response.training_id) {\r\n                    training.gcm_training_completions.push(response);\r\n                    training.current_stage = response.phase + 1;\r\n                }\r\n            });\r\n        };\r\n\r\n        //function deletes the training\r\n        $scope.DeleteTraining = function () {\r\n\r\n            //opening a confirmation dialog before deleting\r\n            $modal.open({\r\n                templateUrl: 'partials/map/_confirmation-dialog.html',\r\n                controller: confirmModalCtrl\r\n            }).result.then(function (result) {\r\n\r\n                    Trainings.deleteTraining($scope.current.sessionToken, $scope.edit_training)\r\n                        .then(function (data) {\r\n                            growl.success(gettextCatalog.getString('Training was deleted successfully'));\r\n                            $scope.trainingWindow.close();\r\n                            $scope.loadTrainings();\r\n                        }, function (e) {\r\n                            growl.error(gettextCatalog.getString('Unable to delete training'));\r\n                        });\r\n                });\r\n            scrollToTop();\r\n        };\r\n\r\n        //function deletes the target city\r\n        $scope.DeleteTargetCity = function (target_city) {\r\n\r\n            //opening a confirmation dialog before deleting\r\n            $modal.open({\r\n                templateUrl: 'partials/map/_confirmation-dialog.html',\r\n                controller: confirmModalCtrl\r\n            }).result.then(function (result) {\r\n\r\n                    TargetCity.deleteTargetCity(target_city.target_city_id)\r\n                        .success(function (data) {\r\n                            growl.success(gettextCatalog.getString('Target city was deleted successfully'));\r\n                            $scope.targetCityWindow.close();\r\n                            $scope.loadTargetCities();\r\n                        })\r\n                        .error(function (e) {\r\n                            growl.error(gettextCatalog.getString('Unable to delete target city'));\r\n\r\n                        });\r\n                });\r\n            scrollToTop();\r\n\r\n        };\r\n\r\n        //function deletes stages of training\r\n        $scope.deleteTrainingComplete = function (training_complete, index) {\r\n\r\n            //opening a confirmation dialog before deleting\r\n            $modal.open({\r\n                templateUrl: 'partials/map/_confirmation-dialog.html',\r\n                controller: confirmModalCtrl\r\n            }).result.then(function (result) {\r\n\r\n                    Trainings.deleteTrainingCompletion($scope.current.sessionToken, training_complete)\r\n                        .then(function (data) {\r\n                            growl.success(gettextCatalog.getString('Training stage was deleted successfully'));\r\n                            $scope.edit_training.gcm_training_completions.splice(index, 1);\r\n                        });\r\n\r\n                });\r\n            scrollToTop();\r\n        };\r\n\r\n        $scope.setMyDefaultMapView = function () {\r\n\r\n            var center = $scope.map.getCenter();\r\n\r\n            //save user preference\r\n            var post_data = {\r\n                \"default_map_views\": [{\r\n                    \"ministry_id\": $scope.current.assignment.ministry_id,\r\n                    \"location\": {\r\n                        \"latitude\": center.lat(),\r\n                        \"longitude\": center.lng()\r\n                    },\r\n                    \"location_zoom\": $scope.map.getZoom()\r\n                }\r\n                ]\r\n            };\r\n            //save user preference\r\n            UserPreference.savePreference(post_data).success(function (data) {\r\n                growl.success(gettextCatalog.getString('Your default map view has been set'));\r\n                $scope.current.user_preferences = data;\r\n            }, function () {\r\n                growl.error(gettextCatalog.getString('Unable to save default map view'));\r\n            });\r\n\r\n        };\r\n\r\n        $scope.setMinistryDefaultView = function () {\r\n            var center = $scope.map.getCenter();\r\n\r\n            // Save changes to API\r\n            Ministries.updateMinistry({\r\n                ministry_id: $scope.current.assignment.ministry_id,\r\n                min_code: $scope.current.assignment.min_code.trim(),\r\n                location: {\r\n                    latitude: center.lat(),\r\n                    longitude: center.lng()\r\n                },\r\n                location_zoom: $scope.map.getZoom()\r\n            }, function (d) {\r\n                growl.success(gettextCatalog.getString('Default ministry map view has been set'));\r\n            }, function () {\r\n                growl.error(gettextCatalog.getString('Unable to save default map view'));\r\n            });\r\n        };\r\n\r\n        $scope.myLocation = function () {\r\n            if (navigator.geolocation) {\r\n                navigator.geolocation.getCurrentPosition(function (position) {\r\n                    var center = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);\r\n                    $scope.map.setCenter(center);\r\n                    $scope.map.setZoom(15);\r\n                }, function () {\r\n                    growl.error(gettextCatalog.getString('Failed to get your current location'))\r\n                });\r\n            }\r\n            else {\r\n                growl.error(gettextCatalog.getString('Your browser does not support GeoLocation'));\r\n            }\r\n        };\r\n\r\n        //function creates array of all parent ids of ministry id including id of item to check\r\n        function getParentMinistryIds(assignments, item) {\r\n            var ministries = UserPreference.getFlatMinistry(assignments);\r\n            var ids = [];\r\n            ids.push(item.ministry_id);\r\n            parentId(item.ministry_id, ministries);\r\n            ids = _.uniq(ids);\r\n            return ids;\r\n\r\n            //recursive parent id fetch loop function\r\n            function parentId(id, ministries) {\r\n                angular.forEach(ministries, function (ministry) {\r\n                    if (ministry.ministry_id === id) {\r\n                        ids.push(ministry.parent_id);\r\n                        parentId(ministry.parent_id, ministries);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        //function checks whether the current user is a leader/admin for current assignment\r\n        function isLeaderAdmin() {\r\n            return ($scope.current.hasRole(['admin', 'inherited_admin', 'leader', 'inherited_leader']));\r\n        }\r\n\r\n        function confirmModalCtrl($scope, $modalInstance) {\r\n            $scope.yes = function () {\r\n                $modalInstance.close(true);\r\n            };\r\n\r\n            $scope.no = function () {\r\n                $modalInstance.dismiss('cancel');\r\n            };\r\n        }\r\n\r\n        /**\r\n         * Check if target cities can be view/create/edit\r\n         * @returns {boolean}\r\n         */\r\n        function isTargetCityVisible() {\r\n            //if no assignment return early\r\n            if (typeof $scope.current.assignment === 'undefined') {\r\n                return false;\r\n            }\r\n            //check for required role\r\n            if (!$scope.current.hasRole(['admin', 'inherited_admin', 'leader', 'inherited_leader', 'member'])) {\r\n                return false;\r\n            }\r\n            if (typeof $scope.current.mcc === 'undefined') {\r\n                return false;\r\n            }\r\n            //only visible to llm\r\n            if ($scope.current.mcc === 'llm') {\r\n                //ministry must have an area code\r\n                if (typeof $scope.current.assignment.area_code !== 'undefined' && typeof $scope.current.assignment.ministry_scope !== 'undefined') {\r\n                    //ministry_scope should be 'Area' or 'Global'\r\n                    if ($scope.current.assignment.ministry_scope == 'Area' || $scope.current.assignment.ministry_scope == 'National') {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            return false;\r\n        }\r\n\r\n        $scope.addStoryToIcon = function (icon, type) {\r\n            $modal.open({\r\n                templateUrl: 'partials/stories/new-story-dialog.html',\r\n                size: 'lg',\r\n                controller: function ($scope, $modalInstance, modalData) {\r\n                    $scope.imageFile = {};\r\n                    $scope.storiesConfig = modalData.storiesConfig;\r\n                    $scope.iconName = modalData.iconName;\r\n\r\n                    $scope.close = function () {\r\n                        $modalInstance.dismiss('cancel');\r\n                    };\r\n\r\n                    $scope.saveStory = function (story) {\r\n                        $modalInstance.close({\r\n                            story: story,\r\n                            imageFile: $scope.imageFile\r\n                        });\r\n                    };\r\n                },\r\n                resolve: {\r\n                    modalData: function () {\r\n                        return {\r\n                            iconName: angular.copy(icon.name),\r\n                            storiesConfig: angular.copy(Settings.stories)\r\n                        }\r\n                    }\r\n                }\r\n            }).result.then(function (data) {\r\n\r\n                    //prepare story data to send\r\n                    data.story[type + '_id'] = icon.id;\r\n                    data.story.location = {\r\n                        latitude: icon.latitude,\r\n                        longitude: icon.longitude\r\n                    };\r\n\r\n                    Stories.createStory(data.story)\r\n                        .success(function (response) {\r\n                            growl.success('Story saved successfully');\r\n                            if (typeof data.imageFile.resized !== 'undefined') {\r\n                                //prepare form data for image file\r\n                                var form_data = new FormData();\r\n                                form_data.append('image-file', data.imageFile.resized.blob, data.imageFile.file.name);\r\n                                //Start uploading image file\r\n                                Stories.uploadStoryImage(response.story_id, form_data)\r\n                                    .success(function (img) {\r\n                                        growl.success(gettextCatalog.getString('Image file was uploaded'));\r\n                                    })\r\n                                    .error(function (e) {\r\n                                        if (e.status === 400) {\r\n                                            growl.error(gettextCatalog.getString('Upload failed, Invalid file input'));\r\n                                        } else {\r\n                                            growl.error(gettextCatalog.getString('Unable to upload image file'));\r\n                                        }\r\n                                    });\r\n                            }\r\n                        })\r\n                        .error(function () {\r\n                            growl.error(gettextCatalog.getString('Failed to save story'));\r\n                        });\r\n\r\n                });\r\n            //close all dialogWindow\r\n            $scope.churchWindow.close();\r\n            $scope.trainingWindow.close();\r\n            scrollToTop();\r\n        };\r\n\r\n        function scrollToTop() {\r\n            window.setTimeout(function () {\r\n                window.parent.scrollTo(0, 0);\r\n            }, 10);\r\n        }\r\n\r\n        $scope.canAddStories = function (icon) {\r\n            if (typeof icon === 'undefined') return false;\r\n            if (typeof icon.ministry_id === 'undefined') return false;\r\n            //old churches or training which does not have ministry_id can not be tagged\r\n            if (icon.ministry_id === null || icon.ministry_id === '') return false;\r\n\r\n            if (icon.ministry_id !== $scope.current.assignment.ministry_id) {\r\n                return false;\r\n            }\r\n            return $scope.current.hasRole(['admin', 'inherited_admin', 'leader', 'inherited_leader', 'member']);\r\n        }\r\n    }\r\n\r\n    angular.module('gma.controllers.map').controller('MapCtrl', MapCtrl);\r\n})(jQuery);\r\n","(function () {\r\n    'use strict';\r\n\r\n    function MeasurementDetailsCtrl($scope, $modalInstance, Measurements, Assignments, measurement, details, Settings, GoogleAnalytics) {\r\n        $scope.spinner = true;\r\n        $scope.measurement = measurement;\r\n        $scope.details = details;\r\n        $scope.ns = Settings.gmaNamespace;\r\n\r\n        var sendAnalytics = _.throttle(function () {\r\n            GoogleAnalytics.screen('Measurement Details', (function () {\r\n                var dimensions = {};\r\n                dimensions[GoogleAnalytics.DIM.guid] = $scope.current.user.key_guid;\r\n                if (angular.isDefined($scope.current.assignment.ministry_id)) {\r\n                    dimensions[GoogleAnalytics.DIM.ministry_id] = $scope.current.assignment.ministry_id;\r\n                }\r\n                if (angular.isDefined($scope.current.mcc)) {\r\n                    dimensions[GoogleAnalytics.DIM.mcc] = $scope.current.mcc;\r\n                }\r\n                if (angular.isDefined($scope.current.period)) {\r\n                    dimensions[GoogleAnalytics.DIM.period] = $scope.current.period.format('YYYY-MM');\r\n                }\r\n                if (angular.isDefined($scope.details.perm_link_stub)) {\r\n                    dimensions[GoogleAnalytics.DIM.perm_link] = $scope.details.perm_link_stub;\r\n                }\r\n                return dimensions;\r\n            })());\r\n        }, 1000, {leading: false});\r\n\r\n        $scope.details.$promise.then(function () {\r\n            $scope.spinner = false;\r\n            sendAnalytics();\r\n\r\n            var da = [['Period', 'Personal', 'Local Team', 'Total']];\r\n            angular.forEach(details.total, function (t, period) {\r\n                angular.forEach(details.local, function (l, p) {\r\n                    if (p === period) {\r\n                        angular.forEach(details.my_measurements, function (m, p) {\r\n                            if (p === period) da.push([p, m, l, t])\r\n                        });\r\n                    }\r\n                });\r\n            });\r\n            $scope.trend = google.visualization.arrayToDataTable(da);\r\n        });\r\n\r\n        $scope.filterSource = function (items) {\r\n            var result = {};\r\n            angular.forEach(items, function (value, key) {\r\n                if (key != Settings.gmaNamespace && key != 'total') {\r\n                    result[key] = value;\r\n                }\r\n            });\r\n            return result;\r\n        };\r\n\r\n        $scope.saveDetails = function () {\r\n            $scope.spinner = true;\r\n            var measurements = [];\r\n            angular.forEach(['local', 'person'], function (type) {\r\n                if ($scope.editForm.hasOwnProperty(type) && $scope.editForm[type].$dirty && typeof $scope.editForm[type] !== 'undefined') {\r\n                    measurements.push({\r\n                        period: $scope.current.period.format('YYYY-MM'),\r\n                        mcc: $scope.current.mcc,\r\n                        source: Settings.gmaNamespace,\r\n                        measurement_type_id: $scope.details.measurement_type_ids[type],\r\n                        related_entity_id: type == 'local'\r\n                            ? $scope.current.assignment.ministry_id\r\n                            : $scope.current.assignment.id,\r\n                        value: $scope.editForm[type].$modelValue\r\n                    });\r\n                }\r\n            });\r\n\r\n            if (measurements.length > 0) {\r\n                Measurements.saveMeasurement({}, measurements, function () {\r\n                    $modalInstance.close();\r\n                });\r\n            }\r\n            else {\r\n                $modalInstance.dismiss('cancel');\r\n            }\r\n        };\r\n\r\n        $scope.close = function () {\r\n            $modalInstance.dismiss('cancel');\r\n        };\r\n\r\n        $scope.approveSelfAssigned = function (user, role) {\r\n            var user = user;\r\n            user.state = 'pending';\r\n            Assignments.saveAssignment({\r\n                assignment_id: user.assignment_id\r\n            }, {team_role: role}, function () {\r\n                if (role == 'blocked') {\r\n                    user.state = 'blocked';\r\n                    user.blocked = true;\r\n                } else {\r\n                    user.success = true;\r\n                    user.state = 'member';\r\n                }\r\n            }, function () {\r\n                delete user.state;\r\n            });\r\n        };\r\n    }\r\n\r\n    angular.module('gma.controllers.measurements').controller('MeasurementDetailsCtrl', MeasurementDetailsCtrl);\r\n})();\r\n","(function () {\r\n    'use strict';\r\n\r\n    function MeasurementsCtrl($scope, $modal, $location, Measurements, UserPreference, Settings, GoogleAnalytics, $interval, growl, gettextCatalog) {\r\n\r\n        var defaultLocale = 'en-US';\r\n        $scope.current.isLoaded = false;\r\n        $scope.currentLanguage = defaultLocale;\r\n        $scope.ns = Settings.gmaNamespace;\r\n\r\n        var sendAnalytics = _.throttle(function () {\r\n            GoogleAnalytics.screen('Measurements', (function () {\r\n                var dimensions = {};\r\n                dimensions[GoogleAnalytics.DIM.guid] = $scope.current.user.key_guid;\r\n                if (angular.isDefined($scope.current.assignment.ministry_id)) {\r\n                    dimensions[GoogleAnalytics.DIM.ministry_id] = $scope.current.assignment.ministry_id;\r\n                }\r\n                if (angular.isDefined($scope.current.mcc)) {\r\n                    dimensions[GoogleAnalytics.DIM.mcc] = $scope.current.mcc;\r\n                }\r\n                if (angular.isDefined($scope.current.period)) {\r\n                    dimensions[GoogleAnalytics.DIM.period] = $scope.current.period.format('YYYY-MM');\r\n                }\r\n                return dimensions;\r\n            })());\r\n        }, 1000, {leading: false});\r\n\r\n        $scope.$watch('current.assignment.ministry_id', function (old, newVal) {\r\n            if (typeof old !== 'undefined') {\r\n                if ($scope.current.canAccessCurrentTab() && typeof $scope.current.mcc !== 'undefined') {\r\n                    //only need to decide preferred language if user changes the ministry\r\n                    $scope.currentLanguage = decideLocaleToLoad();\r\n                    getMeasurements();\r\n                    sendAnalytics();\r\n                    $scope.current.loadLanguages();\r\n                    setMeasurementStates();\r\n                }\r\n                else {\r\n                    $scope.current.redirectToHomeTab();\r\n                }\r\n            }\r\n        });\r\n\r\n        $scope.$watch('current.mcc', function (old) {\r\n            getMeasurements();\r\n            sendAnalytics();\r\n            if (old !== undefined) {\r\n                setMeasurementStates();\r\n            }\r\n        });\r\n\r\n        $scope.$watch('current.period', function () {\r\n            getMeasurements();\r\n            sendAnalytics();\r\n        });\r\n\r\n        // Debounced method to fetch Measurements at most once every 100 milliseconds\r\n        var getMeasurements = _.debounce(function () {\r\n            if (typeof $scope.current.assignment !== 'undefined' && typeof $scope.current.period !== 'undefined' && typeof $scope.current.mcc !== 'undefined') {\r\n\r\n                $scope.loadMeasurements($scope.currentLanguage);\r\n            }\r\n        }, 100);\r\n\r\n        /**\r\n         * Also fires on change event of language selector\r\n         * Always pass a language, default = en-us\r\n         * @param language\r\n         */\r\n        $scope.loadMeasurements = function (language) {\r\n            //be fail safe\r\n            if (language === undefined || language === '') {\r\n                language = defaultLocale;\r\n            }\r\n            $scope.current.isLoaded = false;\r\n            $scope.measurements = Measurements.getMeasurements({\r\n                ministry_id: $scope.current.assignment.ministry_id,\r\n                mcc: $scope.current.mcc,\r\n                locale: language,\r\n                period: $scope.current.period.format('YYYY-MM')\r\n            }, function () {\r\n                $scope.current.isLoaded = true;\r\n            }, function () {\r\n                $scope.current.isLoaded = true;\r\n                growl.error(gettextCatalog.getString('Unable to load measurements'));\r\n            });\r\n        };\r\n\r\n\r\n        function decideLocaleToLoad() {\r\n            //check for user-preferred locale , if not found then load default\r\n            if (typeof $scope.current.user_preferences === 'undefined') {\r\n                return defaultLocale;\r\n            }\r\n            if (typeof $scope.current.user_preferences.content_locales === 'undefined') {\r\n                return defaultLocale;\r\n            }\r\n            if (typeof $scope.current.user_preferences.content_locales[$scope.current.assignment.ministry_id] !== 'undefined') {\r\n                return $scope.current.user_preferences.content_locales[$scope.current.assignment.ministry_id];\r\n            }\r\n\r\n            return defaultLocale;\r\n        }\r\n\r\n\r\n        $scope.hasOther = function () {\r\n            return _.where($scope.measurements, {section: 'other', column: 'other'}).length > 0;\r\n        };\r\n\r\n        // Method used to save measurements\r\n        $scope.saveMeasurements = function () {\r\n            var measurements = [];\r\n            angular.forEach($scope.measurements, function (measurement) {\r\n                angular.forEach(['person', 'local'], function (type) {\r\n                    if ($scope.lmiForm.hasOwnProperty(measurement.measurement_type_ids[type])) {\r\n                        var type_id = measurement.measurement_type_ids[type],\r\n                            input = $scope.lmiForm[type_id];\r\n\r\n                        if (input.$dirty && input.$valid) {\r\n                            measurements.push({\r\n                                period: $scope.current.period.format('YYYY-MM'),\r\n                                mcc: $scope.current.mcc,\r\n                                source: Settings.gmaNamespace,\r\n                                measurement_type_id: type_id,\r\n                                related_entity_id: type === 'person' ? $scope.current.assignment.id : $scope.current.assignment.ministry_id,\r\n                                value: input.$modelValue\r\n                            });\r\n                        }\r\n                    }\r\n                });\r\n            });\r\n\r\n            if (measurements.length > 0) {\r\n                Measurements.saveMeasurement({}, measurements, function (response) {\r\n                    growl.success(gettextCatalog.getString('Measurements saved successfully'));\r\n                    getMeasurements();\r\n                    $scope.lmiForm.$setPristine();\r\n                }, function () {\r\n                    growl.error(gettextCatalog.getString('Unable to save measurements'));\r\n                });\r\n            }\r\n        };\r\n\r\n        $scope.filterByLangCode = function (lang) {\r\n            if (typeof $scope.current.assignment.content_locales !== 'undefined') {\r\n                return (_.contains($scope.current.assignment.content_locales, lang.iso_code)) ? lang : false;\r\n            } else {\r\n                return false;\r\n            }\r\n        };\r\n\r\n        $scope.editMeasurementDetails = function (measurement) {\r\n            var instance = $modal.open({\r\n                templateUrl: 'partials/measurements/details.html',\r\n                controller: 'MeasurementDetailsCtrl',\r\n                keyboard: true,\r\n                backdrop: true,\r\n                resolve: {\r\n                    'measurement': function () {\r\n                        return measurement;\r\n                    },\r\n                    'details': function () {\r\n                        // Return the promise so resolve waits\r\n                        return Measurements.getMeasurement({\r\n                            perm_link_stub: measurement.perm_link_stub,\r\n                            ministry_id: $scope.current.assignment.ministry_id,\r\n                            mcc: $scope.current.mcc,\r\n                            period: $scope.current.period.format('YYYY-MM')\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n            instance.result.then(function () {\r\n                //setting confirmation message\r\n                growl.success(gettextCatalog.getString('Measurements updated successfully'));\r\n                getMeasurements();\r\n            });\r\n            window.setTimeout(function () {\r\n                window.parent.scrollTo(0, 0);\r\n            }, 10);\r\n        };\r\n\r\n\r\n        function setMeasurementStates() {\r\n\r\n            $scope.measurementState = {};\r\n            //get settings from config.php\r\n            var states_from_config = {};\r\n            if (typeof Settings.default_measurement_states[$scope.current.mcc] !== 'undefined') {\r\n                states_from_config = angular.copy(Settings.default_measurement_states[$scope.current.mcc]);\r\n            }\r\n\r\n            //get user preference from user profile\t, will override default (defined in config.php)\r\n            if (typeof $scope.current.user_preferences !== 'undefined' && typeof $scope.current.user_preferences.default_measurement_states !== \"undefined\") {\r\n\r\n                //check if current mcc exists in default_measurement_states\r\n                if (typeof $scope.current.user_preferences.default_measurement_states[$scope.current.mcc] !== 'undefined') {\r\n                    $scope.measurementState = $scope.current.user_preferences.default_measurement_states[$scope.current.mcc];\r\n                }\r\n                else {\r\n                    $scope.measurementState = states_from_config;\r\n                }\r\n\r\n            } else {\r\n                $scope.measurementState = states_from_config;\r\n            }\r\n        }\r\n\r\n        var autoSave = $interval(function () {\r\n            //if user in inside measurement tab and view has been loaded\r\n            if ($scope.current.isLoaded && $location.path() === '/measurements') {\r\n\r\n                if ($scope.current.mcc !== 'undefined' && (_.size($scope.measurementState) > 0)) {\r\n\r\n                    var post_data = {\"default_measurement_states\": {}};\r\n                    post_data.default_measurement_states[$scope.current.mcc] = $scope.measurementState;\r\n                    UserPreference.savePreference(post_data).success(function (data) {\r\n\r\n                    }, function (e) {\r\n                        //stop auto-saving if server sends 500 or 400\r\n                        if (e.status === 500 || e.status === 400) {\r\n                            $interval.cancel(autoSave);\r\n                        }\r\n                    });\r\n\r\n                }\r\n            }\r\n        }, 60000);\r\n\r\n        $scope.$on('$destroy', function () {\r\n            $interval.cancel(autoSave);\r\n        });\r\n\r\n        $scope.toggleMeasurementState = function (measurementState, perm_link_stub) {\r\n            measurementState[perm_link_stub] = (measurementState[perm_link_stub] === 1) ? 0 : 1;\r\n        };\r\n\r\n        $scope.checkMeasureState = function (measurement) {\r\n\r\n            if (measurement.supported_staff_only === true) {\r\n                if ($scope.current.user_preferences.supported_staff !== 'undefined') {\r\n                    if ($scope.current.user_preferences.supported_staff == '1') {\r\n                        if (measurement.leader_only === true) {\r\n\r\n                            return $scope.current.hasRole(['admin', 'inherited_admin', 'leader', 'inherited_leader']);\r\n\r\n                        }\r\n                        return true;\r\n                    }\r\n                    else {\r\n                        return false;\r\n                    }\r\n\r\n                }\r\n                else {\r\n                    return false;\r\n                }\r\n            }\r\n            if (measurement.leader_only === true) {\r\n                return $scope.current.hasRole(['admin', 'inherited_admin', 'leader', 'inherited_leader']);\r\n            }\r\n\r\n            return true;\r\n        };\r\n\r\n    }\r\n\r\n    angular.module('gma.controllers.measurements').controller('MeasurementsCtrl', MeasurementsCtrl);\r\n})();\r\n","(function () {\r\n    'use strict';\r\n    function UserPreferenceCtrl($scope, $location, $modalInstance, modelData, UserPreference, growl, Settings, gettextCatalog) {\r\n        //set some defaults\r\n        $scope.options = {\r\n            supported_staff: '0',\r\n            hide_reports_tab: '0', //0 means visible\r\n            static_locale: 'en-us',\r\n            content_locales: {}\r\n        };\r\n        //collect data for looping\r\n        $scope.ministries = _.sortBy(UserPreference.getFlatMinistry($scope.current.assignments), 'name');\r\n        $scope.mccs = _.sortBy(UserPreference.getMappedMCCS($scope.current.assignment.mccs, modelData.mccLabels), 'mccLabel');\r\n        $scope.staticLocales = angular.copy(Settings.static_locales);\r\n\r\n        $scope.current.loadLanguages();\r\n\r\n        //override user preferences from token response\r\n        if (typeof $scope.current.user_preferences === 'object') {\r\n            $scope.options = angular.extend({}, $scope.options, angular.copy($scope.current.user_preferences));\r\n        }\r\n        //get supported languages by this ministry\r\n        var supportedLanguages = {};\r\n        if (typeof $scope.current.assignment.content_locales !== 'undefined') {\r\n            supportedLanguages = angular.copy($scope.current.assignment.content_locales);\r\n        }\r\n        $scope.filterByLangCode = function (lang) {\r\n\r\n            return (_.contains(supportedLanguages, lang.iso_code)) ? lang : false;\r\n\r\n        };\r\n\r\n        $scope.savePreference = function (options) {\r\n            //reduce payload weight\r\n            delete options.default_map_views;\r\n            delete options.default_measurement_states;\r\n            UserPreference.savePreference(options)\r\n                .success(function (data) {\r\n                    growl.success(gettextCatalog.getString('Your preferences were saved'));\r\n                    //if user want to hide reports tab and is on reports tab so\r\n                    if (options.hide_reports_tab == 1 && $location.path() == '/reports') {\r\n                        $scope.current.redirectToHomeTab();\r\n                    }\r\n                    //update root scope\r\n                    $scope.current.user_preferences = data;\r\n                })\r\n                .error(function () {\r\n                    growl.error(gettextCatalog.getString('Unable to save preferences'));\r\n                });\r\n            $modalInstance.close(true);\r\n        };\r\n\r\n        $scope.changeMCCS = function (ministry_id) {\r\n            if (ministry_id === \"\" || ministry_id === null) {\r\n                $scope.mccs = [];\r\n                $scope.options.preferred_mcc = \"\";\r\n                return false;\r\n            }\r\n            var ministry = _.find($scope.ministries, function (mini) {\r\n                return (mini.ministry_id === ministry_id);\r\n            });\r\n            if (typeof ministry !== 'undefined') {\r\n                $scope.mccs = _.sortBy(UserPreference.getMappedMCCS(ministry.mccs, modelData.mccLabels), 'mccLabel');\r\n                //additional check if there is no mccs then default_mcc should be empty in every case\r\n                if (_.size($scope.mccs) == 0) {\r\n                    $scope.options.preferred_mcc = \"\";\r\n                }\r\n            } else {\r\n                $scope.options.preferred_mcc = \"\";\r\n                $scope.mccs = [];\r\n            }\r\n\r\n        };\r\n        $scope.changeMCCS($scope.options.preferred_ministry);\r\n\r\n        $scope.close = function () {\r\n            $modalInstance.dismiss('cancel');\r\n        };\r\n\r\n    }\r\n\r\n    angular.module('gma.controllers.preference').controller('UserPreferenceCtrl', UserPreferenceCtrl);\r\n})();\r\n","(function () {\r\n    'use strict';\r\n\r\n    function ReportsCtrl($scope, Measurements, GoogleAnalytics, gettextCatalog, growl) {\r\n        $scope.chart = new google.visualization.LineChart(document.getElementById('reports-chart'));\r\n        $scope.table = new google.visualization.Table(document.getElementById('reports-table'));\r\n\r\n        var sendAnalytics = _.throttle(function () {\r\n            GoogleAnalytics.screen('Reports', (function () {\r\n                var dimensions = {};\r\n                dimensions[GoogleAnalytics.DIM.guid] = $scope.current.user.key_guid;\r\n                if (angular.isDefined($scope.current.assignment.ministry_id)) {\r\n                    dimensions[GoogleAnalytics.DIM.ministry_id] = $scope.current.assignment.ministry_id;\r\n                }\r\n                if (angular.isDefined($scope.current.mcc)) {\r\n                    dimensions[GoogleAnalytics.DIM.mcc] = $scope.current.mcc;\r\n                }\r\n                if (angular.isDefined($scope.current.period)) {\r\n                    dimensions[GoogleAnalytics.DIM.period] = $scope.current.period.format('YYYY-MM');\r\n                }\r\n                return dimensions;\r\n            })());\r\n        }, 1000, {leading: false});\r\n\r\n        // Debounced method to fetch Measurements at most once every 100 milliseconds\r\n        var getMeasurements = _.debounce(function () {\r\n            if (typeof $scope.current.assignment !== 'undefined' && typeof $scope.current.period !== 'undefined' && typeof $scope.current.mcc !== 'undefined') {\r\n                delete $scope.dataTable;\r\n                $scope.current.isLoaded = false;\r\n                $scope.measurements = Measurements.getMeasurements({\r\n                    ministry_id: $scope.current.assignment.ministry_id,\r\n                    mcc: $scope.current.mcc,\r\n                    period: $scope.current.period.format('YYYY-MM'),\r\n                    historical: true\r\n                }, function () {\r\n                    $scope.current.isLoaded = true;\r\n                    sendAnalytics();\r\n\r\n                    var chartData = new google.visualization.DataTable(),\r\n                        tableData = new google.visualization.DataTable(),\r\n                        rows = [];\r\n                    chartData.addColumn('string', 'Date');\r\n                    angular.forEach($scope.dates, function (date, index) {\r\n                        rows[index] = [date];\r\n                        angular.forEach($scope.measurements, function (measurement) {\r\n                            if (index === 0) {\r\n                                chartData.addColumn('number', measurement.name);\r\n                            }\r\n                            rows[index].push(measurement.total[date]);\r\n                        });\r\n                    });\r\n                    chartData.addRows(rows);\r\n                    $scope.dataTable = chartData;\r\n\r\n                    tableData.addColumn('string', 'Measurement');\r\n                    angular.forEach($scope.measurements, function (measurement, index) {\r\n                        var row = [];\r\n                        angular.forEach($scope.dates, function (date) {\r\n                            if (index === 0) tableData.addColumn('number', date);\r\n                            row.push(measurement.total[date]);\r\n                        });\r\n                        if (index === 0) tableData.addColumn('number', 'Total');\r\n                        tableData.addRow([measurement.name].concat(row, [walterMeanAvg(row)]));\r\n                    });\r\n                    $scope.tableDataTable = tableData;\r\n                }, function () {\r\n                    $scope.current.isLoaded = true;\r\n                    delete $scope.dataTable;\r\n                    growl.error(gettextCatalog.getString('Unable to load measurements for reporting'))\r\n                });\r\n            }\r\n        }, 100);\r\n\r\n        $scope.$watch('current.assignment.ministry_id', function (ministry_id) {\r\n            if (typeof ministry_id !== 'undefined') {\r\n                if ($scope.current.canAccessCurrentTab()) {\r\n                    getMeasurements();\r\n                } else {\r\n                    $scope.current.redirectToHomeTab();\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        $scope.$watch('current.mcc', function () {\r\n            getMeasurements();\r\n        });\r\n\r\n        $scope.$watch('current.period', function (period) {\r\n            if (typeof period === 'undefined') return;\r\n            getMeasurements();\r\n\r\n            var now = period.clone(),\r\n                dates = [];\r\n            for (var i = 0; i < 12; i++) {\r\n                dates.push(now.clone().format('YYYY-MM'));\r\n                now.subtract(1, 'M');\r\n            }\r\n            $scope.dates = dates.reverse();\r\n        });\r\n\r\n        $scope.$watch('dataTable', function (data) {\r\n            if (typeof data === 'undefined') return;\r\n            $scope.chart.draw(data, {\r\n                chartArea: {\r\n                    top: 20,\r\n                    left: 50,\r\n                    width: '80%',\r\n                    height: '90%'\r\n                },\r\n                legend: {\r\n                    alignment: 'start',\r\n                    position: 'right'\r\n                },\r\n                orientation: 'horizontal'\r\n            });\r\n        });\r\n\r\n        $scope.$watch('tableDataTable', function (data) {\r\n            if (typeof data === 'undefined') return;\r\n            $scope.table.draw(data, {});\r\n        });\r\n\r\n        function walterMeanAvg(data) {\r\n            // Drop zeros\r\n            var values = [],\r\n                total = 0;\r\n            angular.forEach(data, function (val) {\r\n                if (val === 0) return;\r\n                values.push(val);\r\n            });\r\n\r\n            if (values.length === 0) return 0;\r\n\r\n            if (values.length > 4) {\r\n                // Sort array\r\n                values.sort(function (a, b) {\r\n                    return a - b;\r\n                });\r\n\r\n                // Remove first element, lowest\r\n                values.shift();\r\n\r\n                // Remove last element, highest\r\n                values.pop();\r\n            }\r\n\r\n            // Sum the values\r\n            angular.forEach(values, function (val) {\r\n                total = total + val;\r\n            });\r\n\r\n            // Return the average\r\n            return Math.round((total / values.length) * 100) / 100;\r\n        }\r\n    }\r\n\r\n    angular.module('gma.controllers.reports').controller('ReportsCtrl', ReportsCtrl);\r\n})();\r\n","(function () {\r\n    'use strict';\r\n\r\n    function StoriesCtrl($scope, $modal, growl, Stories, Settings, $filter, gettextCatalog) {\r\n        $scope.current.isLoaded = false;\r\n        $scope.storiesLoaded = false;\r\n        $scope.feedsLoaded = false;\r\n        //get configs from settings\r\n        $scope.versionUrl = Settings.versionUrl;\r\n        $scope.storiesConfig = angular.copy(Settings.stories);\r\n        //init story pagination\r\n        $scope.storiesNav = {\r\n            currentPage: 1,\r\n            perPage: $scope.storiesConfig.stories_per_page || 5\r\n        };\r\n        //init feeds pagination\r\n        $scope.feedsNav = {\r\n            currentPage: 1,\r\n            perPage: $scope.storiesConfig.feeds_count || 10\r\n        };\r\n        //lets keep some story search params in scope,  we may add some more in future\r\n        $scope.storiesParams = {\r\n            self_only: false\r\n        };\r\n\r\n        $scope.$watch('current.assignment.ministry_id', function (assignment, oldVal) {\r\n\r\n            if (typeof assignment !== 'undefined') {\r\n                if ($scope.current.canAccessCurrentTab()) {\r\n                    $scope.current.isLoaded = true;\r\n                    //load data from server\r\n                    $scope.searchStories(1, $scope.storiesParams); //load first page\r\n                    $scope.loadNewsFeeds(1);\r\n                } else {\r\n                    $scope.current.redirectToHomeTab();\r\n                }\r\n            }\r\n        });\r\n\r\n        function scrollToTop() {\r\n            window.setTimeout(function () {\r\n                window.parent.scrollTo(0, 0);\r\n            }, 10);\r\n        }\r\n\r\n        $scope.loadNewsFeeds = function (page) {\r\n            $scope.feedsLoaded = false;\r\n            var params = {\r\n                ministry_id: $scope.current.assignment.ministry_id,\r\n                per_page: $scope.storiesConfig.feeds_count || 10,\r\n                page: page || 1\r\n            };\r\n            Stories.getNewsFeeds(params).\r\n                success(function (response) {\r\n                    $scope.feedsLoaded = true;\r\n                    $scope.recentNewsFeeds = response.entries;\r\n                    //update pagination nav\r\n                    $scope.feedsNav.totalItems = response.meta.total;\r\n                    $scope.feedsNav.currentPage = response.meta.page;\r\n                })\r\n                .error(function (e) {\r\n                    $scope.feedsLoaded = true;\r\n                    growl.error(gettextCatalog.getString('Error loading news feeds'));\r\n                });\r\n\r\n        };\r\n\r\n        $scope.searchStories = function (page, storiesParams) {\r\n            $scope.storiesLoaded = false;\r\n            var params = {\r\n                ministry_id: $scope.current.assignment.ministry_id,\r\n                per_page: $scope.storiesConfig.stories_per_page || 5,\r\n                page: page || 1,\r\n                self_only: false\r\n            };\r\n            //fail safe\r\n            if (typeof storiesParams !== 'undefined') {\r\n                params.self_only = storiesParams.self_only\r\n            }\r\n\r\n            Stories.searchStories(params)\r\n                .success(function (response) {\r\n                    $scope.storiesLoaded = true;\r\n                    $scope.visibleStories = response.stories;\r\n                    //update pagination nav\r\n                    $scope.storiesNav.totalItems = response.meta.total;\r\n                    $scope.storiesNav.currentPage = response.meta.page;\r\n\r\n                })\r\n                .error(function (e) {\r\n                    $scope.storiesLoaded = true;\r\n                    growl.error(gettextCatalog.getString('Unable to load stories'));\r\n                });\r\n        };\r\n\r\n        $scope.newStory = function () {\r\n\r\n            $modal.open({\r\n                templateUrl: 'partials/stories/new-story-dialog.html',\r\n                size: 'lg',\r\n                controller: function ($scope, $modalInstance, modalData) {\r\n                    $scope.story = {};\r\n                    $scope.imageFile = {};\r\n                    $scope.storiesConfig = modalData.storiesConfig;\r\n\r\n                    $scope.close = function () {\r\n                        $modalInstance.dismiss('cancel');\r\n                    };\r\n                    $scope.removeImage = function () {\r\n                        angular.element(\"#image-file\").val('');\r\n                        $scope.imageFile = {};\r\n                    };\r\n                    $scope.saveStory = function (story) {\r\n                        $modalInstance.close({\r\n                            story: story,\r\n                            imageFile: $scope.imageFile\r\n                        });\r\n                    }\r\n\r\n                },\r\n                resolve: {\r\n                    modalData: function () {\r\n                        return {\r\n                            storiesConfig: angular.copy($scope.storiesConfig)\r\n                        }\r\n                    }\r\n                }\r\n            }).result.then(function (data) {\r\n                    var originalParams = angular.copy($scope.storiesParams);\r\n                    Stories.createStory(data.story)\r\n                        .success(function (response) {\r\n                            response.created_at = $filter('date')(new Date(), 'yyyy-MM-dd');\r\n                            growl.success(gettextCatalog.getString('Story saved successfully'));\r\n                            if (typeof data.imageFile.resized !== 'undefined') {\r\n                                //Start uploading image file\r\n                                uploadStoryImage(response.story_id, data.imageFile)\r\n                                    .success(function (img) {\r\n                                        growl.success(gettextCatalog.getString('Image file was uploaded'));\r\n                                        //find new story in list and update image url\r\n                                        var found_story = _.findWhere($scope.visibleStories, {story_id: img.story_id});\r\n                                        if (found_story !== undefined) {\r\n                                            found_story.image_url = img.image_url;\r\n                                        }\r\n                                    })\r\n                                    .error(function (e) {\r\n                                        showUploadError(e)\r\n                                    });\r\n\r\n                            }\r\n                            //if user is on first page, and params are same as before\r\n                            if ($scope.storiesNav.currentPage === 1 && angular.equals(originalParams, $scope.storiesParams)) {\r\n                                if ($scope.visibleStories.length === 0) {\r\n                                    $scope.visibleStories = response\r\n                                } else {\r\n                                    $scope.visibleStories.push(response);\r\n                                }\r\n                            }\r\n                        })\r\n                        .error(function () {\r\n                            growl.error(gettextCatalog.getString('Failed to save story'));\r\n                        });\r\n                });\r\n            scrollToTop();\r\n\r\n        };\r\n\r\n        $scope.viewStory = function (story) {\r\n            $modal.open({\r\n                templateUrl: 'partials/stories/view-story-dialog.html',\r\n                size: 'lg',\r\n                controller: function ($scope, $modalInstance, modalData) {\r\n                    $scope.story = modalData.story;\r\n                    $scope.versionUrl = modalData.versionUrl;\r\n                    $scope.isSelfOnlyEnabled = modalData.self_only;\r\n\r\n                    $scope.close = function () {\r\n                        $modalInstance.dismiss('cancel');\r\n                    };\r\n                },\r\n                resolve: {\r\n                    modalData: function () {\r\n                        return {\r\n                            story: angular.copy(story),\r\n                            versionUrl: $scope.versionUrl,\r\n                            self_only: angular.copy($scope.storiesParams.self_only)\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            scrollToTop();\r\n        };\r\n\r\n        $scope.editStory = function (story) {\r\n            var originalStory = story;\r\n            $modal.open({\r\n                templateUrl: 'partials/stories/edit-story-dialog.html',\r\n                size: 'lg',\r\n                controller: function ($scope, $modalInstance, modalData) {\r\n\r\n                    $scope.story = modalData.story;\r\n                    $scope.storiesConfig = modalData.storiesConfig;\r\n\r\n                    $scope.imageFile = {};\r\n                    if (typeof $scope.story.image_url !== 'undefined' && $scope.story.image_url !== '') {\r\n                        $scope.imageFile.url = $scope.story.image_url + '?v=' + $scope.story.updated_at;\r\n                    }\r\n\r\n                    $scope.close = function () {\r\n                        $modalInstance.dismiss('cancel');\r\n                    };\r\n\r\n                    $scope.updateStory = function (editStory) {\r\n                        $modalInstance.close({\r\n                            editStory: editStory,\r\n                            imageFile: $scope.imageFile\r\n                        });\r\n                    };\r\n                },\r\n                resolve: {\r\n                    modalData: function () {\r\n                        return {\r\n                            storiesConfig: angular.copy($scope.storiesConfig),\r\n                            story: angular.copy(story)\r\n                        }\r\n                    }\r\n                }\r\n            }).result.then(function (data) {\r\n                    //fixed a bug , that was causing a 500\r\n                    delete data.editStory.church_id;\r\n                    delete data.editStory.training_id;\r\n\r\n                    Stories.updateStory(data.editStory)\r\n                        .success(function (response) {\r\n                            growl.success(gettextCatalog.getString('Story was updated'));\r\n                            //update current story list with new contents\r\n                            angular.extend(originalStory, response);\r\n                            if (typeof data.imageFile.resized !== 'undefined') {\r\n                                //Start uploading image file\r\n                                uploadStoryImage(response.story_id, data.imageFile)\r\n                                    .success(function (img) {\r\n                                        angular.extend(originalStory, img);\r\n                                        growl.success(gettextCatalog.getString('Image file was uploaded'));\r\n                                    })\r\n                                    .error(function (e) {\r\n                                        showUploadError(e)\r\n                                    });\r\n\r\n                            }\r\n                        })\r\n                        .error(function (e) {\r\n                            growl.error(gettextCatalog.getString('Unable to update story'));\r\n                        });\r\n                });\r\n            scrollToTop();\r\n        };\r\n\r\n        function uploadStoryImage(story_id, imageFile) {\r\n            var form_data = new FormData();\r\n            form_data.append('image-file', imageFile.resized.blob, imageFile.file.name);\r\n\r\n            return Stories.uploadStoryImage(story_id, form_data);\r\n\r\n        }\r\n\r\n        function showUploadError(e) {\r\n            if (e.status === 400) {\r\n                growl.error(gettextCatalog.getString('Upload failed, Invalid file input'));\r\n            } else {\r\n                growl.error(gettextCatalog.getString('Unable to upload image file'));\r\n            }\r\n        }\r\n\r\n        $scope.isStoryEditable = function (story) {\r\n\r\n            if (story.ministry_id === $scope.current.assignment.ministry_id) {\r\n                //admin and leaders can edit any story but within his ministry\r\n                if ($scope.current.hasRole(['admin', 'inherited_admin', 'leader', 'inherited_leader'])) {\r\n                    return true;\r\n                }\r\n            }\r\n\r\n            //you can always edit your own story\r\n            return ($scope.current.user.person_id === story.created_by);\r\n        };\r\n\r\n\r\n    }\r\n\r\n    angular.module('gma.controllers.stories').controller('StoriesCtrl', StoriesCtrl);\r\n}());","(function () {\r\n\t'use strict';\r\n\r\n\tfunction GoogleAnalyticsService( $location, Settings ) {\r\n\t\treturn {\r\n\t\t\tDIM: {\r\n\t\t\t\tguid:        'dimension1',\r\n\t\t\t\tministry_id: 'dimension2',\r\n\t\t\t\tmcc:         'dimension3',\r\n\t\t\t\tperiod:      'dimension4',\r\n\t\t\t\tperm_link:   'dimension5',\r\n\t\t\t\tchurch_id:   'dimension6',\r\n\t\t\t\ttraining_id: 'dimension7'\r\n\t\t\t},\r\n\t\t\tinit:   function () {\r\n\t\t\t\tif ( Settings.googleAnalytics === false ) return;\r\n\r\n\t\t\t\t// Initialize Google Analytics\r\n\t\t\t\tga( 'create', Settings.googleAnalytics, 'auto' );\r\n\t\t\t\tga( 'set', {\r\n\t\t\t\t\t'appName':        'GMA (' + Settings.appEnvironment + ')',\r\n\t\t\t\t\t'appId':          'com.expidev.javascript.' + Settings.appEnvironment,\r\n\t\t\t\t\t'appVersion':     Settings.version,\r\n\t\t\t\t\t'appInstallerId': $location.host()\r\n\t\t\t\t} );\r\n\t\t\t},\r\n\t\t\tscreen: function ( screen, dimensions ) {\r\n\t\t\t\tif ( Settings.googleAnalytics === false ) return;\r\n\r\n\t\t\t\tdimensions = typeof dimensions !== 'undefined' ? dimensions : {};\r\n\t\t\t\tdimensions.screenName = screen;\r\n\t\t\t\tga( 'send', 'screenview', dimensions );\r\n\t\t\t},\r\n\t\t\tevent:  function ( category, action, dimensions ) {\r\n\t\t\t\tif ( Settings.googleAnalytics === false ) return;\r\n\r\n\t\t\t\tdimensions = typeof dimensions !== 'undefined' ? dimensions : {};\r\n\t\t\t\tga( 'send', 'event', category, action, dimensions );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tangular.module( 'gma.services.googleAnalytics' ).factory( 'GoogleAnalytics', GoogleAnalyticsService );\r\n})();\r\n","(function () {\n\t'use strict';\n\n\tfunction Assignments( $resource, Settings ) {\n\t\treturn $resource( Settings.api.measurements( '/assignments/:assignment_id' ), {assignment_id: '@assignment_id'}, {\n\t\t\tgetAssignment:  {method: 'GET'},\n\t\t\tgetAssignments: {method: 'GET', isArray: true},\n\t\t\tsaveAssignment: {method: 'PUT'},\n\t\t\taddTeamMember:  {method: 'POST'}\n\t\t} );\n\t}\n\n\tangular.module( 'gma.services.measurements' ).factory( 'Assignments', Assignments );\n})();\n","(function () {\n\t'use strict';\n\n\tfunction Churches( $resource, Settings ) {\n\t\treturn $resource( Settings.api.measurements( '/churches/:church_id' ), {}, {\n\t\t\tgetChurch:   {method: 'GET'},\n\t\t\tgetChurches: {method: 'GET', isArray: true},\n\t\t\taddChurch:   {method: 'POST'},\n\t\t\tsaveChurch:  {method: 'PUT', params: {church_id: '@id'}}\n\t\t} );\n\t}\n\n\tangular.module( 'gma.services.measurements' ).factory( 'Churches', Churches );\n})();\n","(function () {\r\n    'use strict';\r\n\r\n    function ISOCountries( $http, Settings ) {\r\n        return{\r\n            getCountries : function(){\r\n                return $http.get(Settings.api.measurements('/iso_countries'))\r\n            }\r\n        }\r\n    }\r\n\r\n    angular.module( 'gma.services.measurements' ).factory( 'ISOCountries', ISOCountries );\r\n})();\r\n","(function () {\r\n    'use strict';\r\n\r\n    function Languages($http, Settings) {\r\n        return {\r\n            getLanguages: function () {\r\n                return $http.get(Settings.api.measurements('/languages'))\r\n            }\r\n        }\r\n    }\r\n\r\n    angular.module('gma.services.measurements').factory('Languages', Languages);\r\n})();\r\n","(function () {\r\n    'use strict';\r\n\r\n    function MeasurementTypes($resource, Settings) {\r\n        return $resource(Settings.api.measurements('/measurement_types/:measurement_type_id'), {}, {\r\n            getMeasurementType: {\r\n                method: 'GET',\r\n                params: {measurement_type_id: '@measurement_type_id', ministry_id: '@ministry_id', locale: '@locale'}\r\n            },\r\n            getMeasurementTypes: {\r\n                method: 'GET',\r\n                isArray: true,\r\n                params: {ministry_id: '@ministry_id', locale: '@locale'}\r\n            },\r\n            updateMeasurementType: {\r\n                method: 'PUT',\r\n                params: {measurement_type_id: '@measurement_type_id', ministry_id: '@ministry_id', locale: '@locale'}\r\n            },\r\n            addMeasurementType: {\r\n                method: 'POST',\r\n                params: {ministry_id: '@ministry_id', locale: '@locale'}\r\n            }\r\n        });\r\n    }\r\n\r\n    angular.module('gma.services.measurements').factory('MeasurementTypes', MeasurementTypes);\r\n})();\r\n","(function () {\n\t'use strict';\n\n\tfunction Measurements( $resource, Settings ) {\n\t\treturn $resource( Settings.api.measurements( '/measurements/:perm_link_stub' ), {}, {\n\t\t\tgetMeasurement:  {method: 'GET'},\n\t\t\tgetMeasurements: {method: 'GET', isArray: true, params: {source: Settings.gmaNamespace}},\n\t\t\tsaveMeasurement: {method: 'POST'}\n\t\t} );\n\t}\n\n\tangular.module( 'gma.services.measurements' ).factory( 'Measurements', Measurements );\n})();\n","(function () {\n\t'use strict';\n\n\tfunction Ministries( $resource, Settings ) {\n\t\treturn $resource( Settings.api.measurements( '/ministries/:ministry_id' ), {}, {\n\t\t\tgetMinistry:    {method: 'GET'},\n\t\t\tgetMinistries:  {method: 'GET', isArray: true},\n\t\t\tupdateMinistry: {method: 'PUT', params: {ministry_id: '@ministry_id'}},\n\t\t\tcreateMinistry: {method: 'POST'}\n\t\t} );\n\t}\n\n\tangular.module( 'gma.services.measurements' ).factory( 'Ministries', Ministries );\n\n})();\n","(function () {\r\n\t'use strict';\r\n\r\n\tfunction Session( $rootScope, $injector, $q, $log, Settings, $location ) {\r\n\t\tvar token;\r\n\r\n\t\tvar startSession = function ( ticket ) {\r\n\t\t\tif ( \"false\" === ticket ) {\r\n\t\t\t\twindow.location = Settings.api.login;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn $injector.get( '$http' ).get( Settings.api.measurements( '/token' ), {params: {st: ticket}} )\r\n\t\t\t\t.then( function ( response ) {\r\n\t\t\t\t\t$rootScope.current.user = response.data.user;\r\n\t\t\t\t\t$rootScope.current.sessionToken = response.data.session_ticket;\r\n                    //additional check, be fail safe\r\n                    if (typeof response.data.user_preferences === 'object') {\r\n                        $rootScope.current.user_preferences = response.data.user_preferences;\r\n                    } else {\r\n                        delete $rootScope.current.user_preferences;\r\n                    }\r\n\r\n\t\t\t\t\ttoken = response.data.session_ticket;\r\n\t\t\t\t\tif ( typeof response.data.assignments === 'object' && response.data.assignments.length) {\r\n\t\t\t\t\t\t$rootScope.current.assignments = response.data.assignments;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdelete $rootScope.current.assignments;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$rootScope.$broadcast( 'sessionStart', response.data );\r\n\r\n\t\t\t\t\treturn response.data;\r\n\t\t\t\t} );\r\n\t\t};\r\n\r\n\t\treturn {\r\n\t\t\tstartSession:  function ( ticket ) {\r\n\t\t\t\tstartSession( ticket );\r\n\t\t\t},\r\n\t\t\tlogout:        function () {\r\n\t\t\t\treturn $injector.get( '$http' ).delete( Settings.api.measurements( '/token' ) );\r\n\t\t\t},\r\n\t\t\t// Request Interceptor\r\n\t\t\trequest:       function ( config ) {\r\n\t\t\t\tif ( config.url.indexOf( Settings.api.measurements() ) !== -1 ) {\r\n\t\t\t\t\t// All API requests must pass along HTTP credentials\r\n\t\t\t\t\tconfig.withCredentials = true;\r\n\r\n\t\t\t\t\t// If we have a token, add it to the request\r\n\t\t\t\t\tif ( typeof token !== 'undefined' ) {\r\n\t\t\t\t\t\tconfig.headers['Authorization'] = 'Bearer ' + token;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconfig.attempts = ( typeof config.attempts === 'number' ) ? config.attempts + 1 : 1;\r\n\t\t\t\t}\r\n\t\t\t\treturn config;\r\n\t\t\t},\r\n\t\t\t// Error Response Interceptor\r\n\t\t\tresponseError: function ( response ) {\r\n\t\t\t\tif ( response.status === 401 && response.config.url.indexOf( Settings.api.measurements() ) !== -1 && response.config.attempts < 2 ) {\r\n\t\t\t\t\tvar deferred = $q.defer();\r\n\t\t\t\t\t$injector.get( '$http' ).get( Settings.api.refresh, {withCredentials: true} ).then( function ( loginResponse ) {\r\n\t\t\t\t\t\tif ( loginResponse.data ) {\r\n\t\t\t\t\t\t\t//get new token\r\n\t\t\t\t\t\t\tstartSession( loginResponse.data.service_ticket ).then( function () {\r\n\t\t\t\t\t\t\t\t//retry request with new token\r\n\t\t\t\t\t\t\t\t$injector.get( '$http' )( response.config ).then( function ( response ) {\r\n\t\t\t\t\t\t\t\t\tdeferred.resolve( response );\r\n\t\t\t\t\t\t\t\t}, function ( response ) {\r\n\t\t\t\t\t\t\t\t\tdeferred.reject();\r\n\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\t}, function() {\r\n\t\t\t\t\t\t\t\t$location.path('/error/invalid_session');\r\n\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdeferred.reject();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, function ( response ) {\r\n\t\t\t\t\t\tdeferred.reject();\r\n\t\t\t\t\t\t$location.path('/error/invalid_session');\r\n\t\t\t\t\t} );\r\n\t\t\t\t\treturn deferred.promise;\r\n\t\t\t\t}\r\n\t\t\t\treturn $q.reject( response );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tangular.module( 'gma.services.measurements' ).factory( 'Session', Session );\r\n})();\r\n","(function () {\r\n    'use strict';\r\n\r\n    function TargetCity($http, Settings) {\r\n        return {\r\n            createTargetCity: function (data) {\r\n                return $http.post(Settings.api.measurements('/target_cities'), data)\r\n            },\r\n            updateTargetCity: function (data) {\r\n                return $http.put(Settings.api.measurements('/target_cities' + '/' + data.target_city_id), data)\r\n            },\r\n            getTargetCity: function (target_city_id) {\r\n                return $http.get(Settings.api.measurements('/target_cities' + '/' + target_city_id))\r\n            },\r\n            deleteTargetCity: function (target_city_id) {\r\n                return $http.delete(Settings.api.measurements('/target_cities' + '/' + target_city_id))\r\n            },\r\n            searchTargetCities: function (params) {\r\n                return $http.get(Settings.api.measurements('/target_cities'), {params: params})\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    angular.module('gma.services.measurements').factory('TargetCity', TargetCity);\r\n})();\r\n","(function () {\r\n\t'use strict';\r\n\r\n\tfunction Trainings( $http, Settings ) {\r\n\t\tfunction getHighest( array ) {\r\n\t\t\tvar max = 0;\r\n\t\t\tif ( !array ) return 0;\r\n\t\t\tfor ( var i = 0; i < array.length; i++ ) {\r\n\t\t\t\tif ( array[i].phase > (max || 0) ) {\r\n\t\t\t\t\tmax = array[i].phase;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn max;\r\n\t\t}\r\n\r\n\t\tfunction getHighestCount( array ) {\r\n\t\t\tvar max = 0;\r\n\t\t\tfor ( var i = 0; i < array.length; i++ ) {\r\n\t\t\t\tif ( array[i].number_completed > (max || 0) ) {\r\n\t\t\t\t\tmax = array[i].number_completed;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn max;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tgetTrainings:             function ( session_ticket, ministry_id, mcc, show_all, show_tree ) {\r\n\t\t\t\treturn $http\r\n\t\t\t\t\t.get( Settings.api.measurements( '/training' ), {\r\n\t\t\t\t\t\tparams: {\r\n\t\t\t\t\t\t\tministry_id: ministry_id,\r\n\t\t\t\t\t\t\tshow_all:    show_all,\r\n\t\t\t\t\t\t\tshow_tree:   show_tree,\r\n\t\t\t\t\t\t\tmcc:         mcc\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} )\r\n\t\t\t\t\t.then( function ( response ) {\r\n\r\n\t\t\t\t\t\tangular.forEach( response.data, function ( training ) {\r\n\t\t\t\t\t\t\ttraining.current_stage = getHighest( training.gcm_training_completions ) + 1;\r\n\t\t\t\t\t\t\ttraining.leaders_trained = getHighestCount( training.gcm_training_completions );\r\n\t\t\t\t\t\t\ttraining.editMode = false;\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\treturn response.data;\r\n\t\t\t\t\t} );\r\n\t\t\t},\r\n\t\t\tupdateTraining:           function ( session_ticket, training ) {\r\n\t\t\t\treturn $http.put( Settings.api.measurements( '/training/' + training.id ), training )\r\n\t\t\t\t\t.then( function ( response ) {\r\n\t\t\t\t\t\treturn response.data;\r\n\t\t\t\t\t} );\r\n\t\t\t},\r\n\t\t\taddTraining:              function ( session_ticket, training ) {\r\n\t\t\t\treturn $http.post( Settings.api.measurements( '/training' ), training )\r\n\t\t\t\t\t.then( function ( response ) {\r\n\t\t\t\t\t\treturn response.data;\r\n\t\t\t\t\t} );\r\n\t\t\t},\r\n\t\t\tdeleteTraining:           function ( session_ticket, training ) {\r\n\t\t\t\treturn $http.delete( Settings.api.measurements( '/training/' + training.id ) )\r\n\t\t\t\t\t.then( function ( response ) {\r\n\t\t\t\t\t\t//checking if response is 204 for successful delete\r\n\t\t\t\t\t\tif(response.status === 204){\r\n\t\t\t\t\t\t\treturn response;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// if response is not 204 then throwing error\r\n\t\t\t\t\t\tthrow response;\r\n\t\t\t\t\t} );\r\n\t\t\t},\r\n\t\t\taddTrainingCompletion:    function ( session_ticket, training_completion ) {\r\n\t\t\t\treturn $http.post( Settings.api.measurements( '/training_completion' ), training_completion )\r\n\t\t\t\t\t.then( function ( response ) {\r\n\t\t\t\t\t\treturn response.data;\r\n\t\t\t\t\t} );\r\n\t\t\t},\r\n\t\t\tupdateTrainingCompletion: function ( session_ticket, training_completion ) {\r\n\t\t\t\treturn $http.put( Settings.api.measurements( '/training_completion/' + training_completion.id ), training_completion )\r\n\t\t\t\t\t.then( function ( response ) {\r\n\t\t\t\t\t\treturn response.data;\r\n\t\t\t\t\t} );\r\n\t\t\t},\r\n\t\t\tdeleteTrainingCompletion: function ( session_ticket, training_completion ) {\r\n\t\t\t\treturn $http.delete( Settings.api.measurements( '/training_completion/' + training_completion.id ) )\r\n\t\t\t\t\t.then( function ( response ) {\r\n\t\t\t\t\t\t//checking if response is 204 for successful delete\r\n\t\t\t\t\t\tif(response.status === 204){\r\n\t\t\t\t\t\t\treturn response;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// if response is not 204 then throwing response as error\r\n\t\t\t\t\t\tthrow response;\r\n\t\t\t\t\t} );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tangular.module( 'gma.services.measurements' ).factory( 'Trainings', Trainings );\r\n})();\r\n","(function () {\r\n    'use strict';\r\n\r\n    function UserPreference($http, Settings) {\r\n\r\n        return {\r\n            getPreference: function () {\r\n                return $http.get(Settings.api.measurements('/user_preferences'))\r\n            },\r\n            savePreference: function (data) {\r\n                return $http.post(Settings.api.measurements('/user_preferences'), data)\r\n            },\r\n            getFlatMinistry: function (assignments) {\r\n                var ministries = [];\r\n                angular.forEach(assignments, flattenMinistry);\r\n\r\n                function flattenMinistry(ministry) {\r\n                    ministries.push(ministry);\r\n                    if (ministry.hasOwnProperty('sub_ministries') && _.size(ministry.sub_ministries) > 0) {\r\n                        angular.forEach(ministry.sub_ministries, flattenMinistry);\r\n                    }\r\n                }\r\n\r\n                //remove duplicates\r\n                return _.uniq( ministries, false, function ( m ) {\r\n                    return m.ministry_id;\r\n                } );\r\n\r\n            },\r\n            getMappedMCCS: function (mccs, mccLabels) {\r\n                var mapped_mccs = [];\r\n                _.each(mccs, function (mcc) {\r\n                    var customObject = {};\r\n                    customObject.mcc = mcc;\r\n                    customObject.mccLabel = mccLabels[mcc];\r\n                    mapped_mccs.push(customObject);\r\n                });\r\n                return mapped_mccs;\r\n            }\r\n\r\n        };\r\n\r\n    }\r\n\r\n    angular.module('gma.services.preference').factory('UserPreference', UserPreference);\r\n})();\r\n","(function () {\r\n\t'use strict';\r\n\r\n\tfunction SettingsService() {\r\n\t\tvar config = {},\r\n\t\t\ttabs   = [];\r\n\r\n\t\tthis.setConfig = function ( c ) {\r\n\t\t\tconfig = c;\r\n\t\t};\r\n\r\n\t\tvar versionUrl = function ( path ) {\r\n\t\t\treturn path.indexOf( '?' ) === -1\r\n\t\t\t\t? path + '?ver=' + config.version\r\n\t\t\t\t: path + '&ver=' + config.version;\r\n\t\t};\r\n\r\n\t\tvar appUrl = function ( path, version ) {\r\n\t\t\tversion = typeof version === 'undefined' ? true : version;\r\n\t\t\tvar url = apiUrl( config.appUrl, path );\r\n\t\t\tif ( version ) {\r\n\t\t\t\treturn versionUrl( url );\r\n\t\t\t}\r\n\t\t\treturn url;\r\n\t\t};\r\n\r\n\t\tvar measurementsApi = function ( path ) {\r\n\t\t\treturn apiUrl( config.api.measurements, path );\r\n\t\t};\r\n\r\n\t\tfunction apiUrl( base, path ) {\r\n\t\t\tif ( typeof path === 'undefined' ) return base;\r\n\t\t\treturn ( path.indexOf( '/' ) === 0 )\r\n\t\t\t\t? base + path\r\n\t\t\t\t: base + '/' + path;\r\n\t\t}\r\n\r\n\t\tvar mobileApps = function () {\r\n\t\t\tif ( typeof config.mobileapps === 'undefined' ) return false;\r\n\t\t\treturn config.mobileapps.length > 0 ? config.mobileapps : false;\r\n\t\t};\r\n\r\n\t\tthis.routes = function () {\r\n\t\t\tangular.forEach( config.tabs, function ( tab ) {\r\n\t\t\t\tswitch ( tab ) {\r\n\t\t\t\t\tcase 'map':\r\n\t\t\t\t\t\tthis.push( {\r\n\t\t\t\t\t\t\tname:          'Map',\r\n\t\t\t\t\t\t\tpath:          '/map',\r\n\t\t\t\t\t\t\ticon:          'glyphicon-map-marker',\r\n\t\t\t\t\t\t\ttemplateUrl:   'partials/map/map.html',\r\n\t\t\t\t\t\t\tcontroller:    'MapCtrl',\r\n\t\t\t\t\t\t\trequiredRoles: ['admin', 'inherited_admin', 'self_assigned', 'member', 'inherited_leader', 'leader']\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'measurements':\r\n\t\t\t\t\t\tthis.push( {\r\n\t\t\t\t\t\t\tname:          'Measurements',\r\n\t\t\t\t\t\t\tpath:          '/measurements',\r\n\t\t\t\t\t\t\ticon:          'glyphicon-stats',\r\n\t\t\t\t\t\t\ttemplateUrl:   'partials/measurements/measurements.html',\r\n\t\t\t\t\t\t\tcontroller:    'MeasurementsCtrl',\r\n\t\t\t\t\t\t\trequiredRoles: ['admin', 'inherited_admin', 'self_assigned', 'member', 'inherited_leader', 'leader']\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'reports':\r\n\t\t\t\t\t\tthis.push( {\r\n\t\t\t\t\t\t\tname:          'Reports',\r\n\t\t\t\t\t\t\tpath:          '/reports',\r\n\t\t\t\t\t\t\ticon:          'glyphicon-list-alt',\r\n\t\t\t\t\t\t\ttemplateUrl:   'partials/reports/reports.html',\r\n\t\t\t\t\t\t\tcontroller:    'ReportsCtrl',\r\n\t\t\t\t\t\t\trequiredRoles: ['admin', 'inherited_admin', 'inherited_leader', 'leader']\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'admin':\r\n\t\t\t\t\t\tthis.push( {\r\n\t\t\t\t\t\t\tname:          'Admin',\r\n\t\t\t\t\t\t\tpath:          '/admin',\r\n\t\t\t\t\t\t\ticon:          'glyphicon-cog',\r\n\t\t\t\t\t\t\ttemplateUrl:   'partials/admin/admin.html',\r\n\t\t\t\t\t\t\tcontroller:    'AdminCtrl',\r\n\t\t\t\t\t\t\trequiredRoles: ['admin', 'inherited_admin', 'leader', 'inherited_leader']\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'news':\r\n\t\t\t\t\t\tthis.push( {\r\n\t\t\t\t\t\t\tname:          'Home',\r\n\t\t\t\t\t\t\tpath:          '/news',\r\n\t\t\t\t\t\t\ticon:          'glyphicon-home',\r\n\t\t\t\t\t\t\ttemplateUrl:   'partials/stories/stories.html',\r\n\t\t\t\t\t\t\tcontroller:    'StoriesCtrl',\r\n\t\t\t\t\t\t\trequiredRoles: ['admin', 'inherited_admin', 'inherited_leader', 'leader', 'member']\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}, tabs );\r\n\t\t\treturn tabs;\r\n\t\t};\r\n\r\n\t\tthis.$get = function () {\r\n\t\t\treturn {\r\n\t\t\t\tappUrl:                     appUrl,\r\n\t\t\t\tversionUrl:                 versionUrl,\r\n\t\t\t\tversion:                    config.version,\r\n\t\t\t\tname:                       config.name,\r\n\t\t\t\tticket:                     config.ticket,\r\n\t\t\t\tappEnvironment:             config.environment,\r\n\t\t\t\tapi:                        {\r\n\t\t\t\t\tmeasurements: measurementsApi,\r\n\t\t\t\t\trefresh:      config.api.refresh,\r\n\t\t\t\t\tlogout:       config.api.logout,\r\n\t\t\t\t\tlogin:        config.api.login\r\n\t\t\t\t},\r\n\t\t\t\tmobileApps:                 ( typeof config.mobileapps === 'object' && Object.keys( config.mobileapps ).length > 0  ) ? config.mobileapps : false,\r\n\t\t\t\tgmaNamespace:               config.namespace,\r\n\t\t\t\ttabs:                       tabs,\r\n\t\t\t\tgoogleAnalytics:            config.googleanalytics,\r\n\t\t\t\tdefault_measurement_states: config.default_measurement_states || {},\r\n\t\t\t\tstories:                    config.stories,\r\n\t\t\t\tarea_codes:                 config.area_codes,\r\n\t\t\t\tstatic_locales:             config.static_locales\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tangular.module( 'gma.services.settings' ).provider( 'Settings', SettingsService );\r\n})();\r\n","(function () {\r\n    'use strict';\r\n    /*\r\n     * Contains services for 'stories' ,'news feeds' and 'images'\r\n     */\r\n    function Stories($http, Settings) {\r\n\r\n        return {\r\n            getStory: function (story_id) {\r\n                return $http.get(Settings.api.measurements('/stories') + '/' + story_id)\r\n            },\r\n            searchStories: function (params) {\r\n                return $http.get(Settings.api.measurements('/stories'), {params: params})\r\n            },\r\n            createStory: function (story) {\r\n                return $http.post(Settings.api.measurements('/stories'), story)\r\n            },\r\n            updateStory: function (story) {\r\n                return $http.put(Settings.api.measurements('/stories') + '/' + story.story_id, story)\r\n            },\r\n            /*\r\n            * @source http://stackoverflow.com/questions/13963022/angularjs-how-to-implement-a-simple-file-upload-with-multipart-form\r\n            */\r\n            uploadStoryImage: function (story_id,formData) {\r\n                return $http.post(Settings.api.measurements('/images'+'?story_id='+story_id),\r\n                    formData,\r\n                    {\r\n                        headers: {'Content-Type': undefined},\r\n                        transformRequest: angular.identity\r\n                    }\r\n                )\r\n            },\r\n            getNewsFeeds : function(params){\r\n                return $http.get(Settings.api.measurements('/audit'), {params: params})\r\n            }\r\n        };\r\n\r\n    }\r\n\r\n    angular.module('gma.services.stories').factory('Stories', Stories);\r\n})();\r\n"],"sourceRoot":"/source/"}