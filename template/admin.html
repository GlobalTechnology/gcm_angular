<div class="row admin-columns" ng-show="ministry">

	<div class="admin-item">
		<div class="panel panel-default">
			<div class="panel-heading">
				<button type="button" class="pull-right btn btn-primary btn-sm" data-toggle="modal" data-target="#newTeamMember">Add Team Member</button>
				<h3 class="panel-title">Team Members</h3>

				<div class="clearfix"></div>
			</div>
			<div class="panel-body">
				<table class="table table-striped">
					<thead>
					<tr>
						<th>First Name</th>
						<th>Last Name</th>
						<th>Role</th>
						<th></th>
					</tr>
					</thead>
					<tbody>
					<tr ng-repeat="staff in ministry.team_members | orderBy:['first_name', 'last_name']">
						<td>{{staff.first_name}}</td>
						<td>{{staff.last_name}}</td>
						<td>
							<select class="form-control" style="width: 150px;" ng-model="staff.team_role" ng-options="r.value as r.text for r in roles" ng-disabled="!staff.editMode"></select>
						</td>
						<td>
							<a href ng-click="staff.editMode=true; staff.orig_role=staff.team_role;" ng-show="!staff.editMode">Edit</a>
							<a href ng-click="staff.editMode=false; saveRole(staff);" ng-show="staff.editMode">Save</a>
							<a href ng-click="staff.editMode=false; staff.team_role=staff.orig_role" ng-show="staff.editMode">Cancel</a>
						</td>
					</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>

	<div class="admin-item">
		<form name="changeParentForm">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h3 class="panel-title">Parent Ministry</h3>

					<div class="clearfix"></div>
				</div>
				<div class="panel-body">
					<select
						name="prent"
						class="form-control"
						ng-model="ministry.parent_id"
						ng-options="m.ministry_id as m.name for m in current.ministries | roleFilter:['leader','inherited_leader'] | orderBy:'name'">
						<option value="">No Parent Ministry</option>
					</select>
				</div>
				<div class="panel-footer">
					<button type="button" class="btn btn-primary pull-right" ng-disabled="!changeParentForm.$dirty" ng-click="changeParent()">Change Parent Ministry</button>
					<div class="clearfix"></div>
				</div>
			</div>
		</form>
	</div>

	<div class="admin-item">
		<div class="panel panel-default">
			<div class="panel-heading">
				<button type="button" class="pull-right btn btn-primary btn-sm">Add Sub Ministry</button>
				<h3 class="panel-title">Child Ministries / Sub Teams</h3>

				<div class="clearfix"></div>
			</div>
			<div class="panel-body">
				<div ng-repeat="min in current.assignment.sub_ministries">
					<a href ng-click="loadAssignment(min)">{{min.name}}</a>
				</div>
			</div>
		</div>
	</div>

</div>

<div class="modal fade" id="newTeamMember" tabindex="-1" role="dialog" aria-labelledby="newTeamMember" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">
					<span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
				<h4 class="modal-title">Add a new Team Member</h4>
			</div>
			<div class="modal-body form-horizontal">
				<div class="form-group">
					<label for="tbUserName" class="col-sm-4 control-label">TheKey username:</label>

					<div class="col-sm-8">
						<input id="tbUserName" type="email" class="form-control" placeholder="e.g. user@ccci.org" ng-model="newMember.username" />
					</div>

				</div>
				<div class="form-group">
					<label class="col-sm-4 control-label">Role</label>

					<div class="col-sm-8">
						<select class="form-control" style="width: 150px;" ng-model="newMember.team_role" ng-options="r.value as r.text for r  in roles"></select>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="addTeamMember()">Save changes</button>
			</div>
		</div>
	</div>
</div>




