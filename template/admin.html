<div class="row admin-columns" ng-show="ministry">

	<div class="admin-item">
		<div class="panel panel-default">
			<div class="panel-heading">
				<button type="button" class="pull-right btn btn-primary btn-sm" ng-click="addTeamMember()">Add Team Member</button>
				<h3 class="panel-title">Team Members</h3>

				<div class="clearfix"></div>
			</div>
			<div class="panel-body">
				<table class="table table-striped">
					<thead>
					<tr>
						<th>First Name</th>
						<th>Last Name</th>
						<th>Role</th>
						<th></th>
					</tr>
					</thead>
					<tbody>
					<tr ng-repeat="staff in ministry.team_members | orderBy:['first_name', 'last_name']" ng-if="current.user.person_id !== staff.person_id">
						<td>{{staff.first_name}}</td>
						<td>{{staff.last_name}}</td>
						<td>
							<select class="form-control" style="width: 150px;" ng-model="staff.team_role" ng-options="r.value as r.text for r in roles" ng-disabled="!staff.editMode"></select>
						</td>
						<td>
							<a href ng-click="staff.editMode=true; staff.orig_role=staff.team_role;" ng-show="!staff.editMode">Edit</a>
							<a href ng-click="staff.editMode=false; saveRole(staff);" ng-show="staff.editMode">Save</a>
							<a href ng-click="staff.editMode=false; staff.team_role=staff.orig_role" ng-show="staff.editMode">Cancel</a>
						</td>
					</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>

	<div class="admin-item">
		<div class="panel panel-default">
			<div class="panel-heading">
				<button type="button" class="pull-right btn btn-primary btn-sm" ng-click="addSubMinistry()">Add Sub Ministry</button>
				<h3 class="panel-title">Child Ministries / Sub Teams</h3>

				<div class="clearfix"></div>
			</div>
			<div class="panel-body">
				<div ng-repeat="min in current.assignment.sub_ministries">
					<a href ng-click="loadAssignment(min)">{{min.name}}</a>
				</div>
			</div>
		</div>
	</div>

	<div class="admin-item">
		<div class="panel panel-default">
			<div class="panel-heading">
				<button type="button" class="pull-right btn btn-primary btn-sm" ng-click="addMeasurement()">Add Measurement</button>
				<h3 class="panel-title">Measurements</h3>

				<div class="clearfix"></div>
			</div>
			<div class="panel-body">
				<table class="table">
					<tr ng-repeat="type in measurementTypes">
						<td>{{type.english}}</td>
						<td class="text-right">
							<div class="btn-group">
								<label class="btn btn-default" ng-model="type.visible" btn-radio="true">Show</label>
								<label class="btn btn-default" ng-model="type.visible" btn-radio="false">Hide</label>
							</div>
						</td>
					</tr>
				</table>
			</div>
			<div class="panel-footer">
				<button type="button" class="btn btn-primary pull-right" ng-click="saveDetails()" ng-disabled="saveDetailsResource && !saveDetailsResource.$resolved">Save</button>
				<div class="clearfix"></div>
			</div>
		</div>
	</div>

    <div class="admin-item">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Details</h3>

                <div class="clearfix"></div>
            </div>
            <div class="panel-body">
                <alert type="{{saveDetailsAlert.type}}" ng-show="saveDetailsAlert" close="saveDetailsAlert = null">{{saveDetailsAlert.msg}}</alert>

                <div class="form-group row">
                    <label for="ministryName" class="col-sm-4 control-label">Ministry Name:</label>

                    <div class="col-sm-8">
                        <input id="ministryName" type="text" class="form-control" ng-model="ministry.name" />
                    </div>
                </div>

				<div class="form-group row" ng-show="ableToChangeParentMinistry(ministry.parent_id)">
					<label class="col-sm-4 control-label">Parent Ministry:</label>

					<div class="col-sm-8">
						<select
							name="prent"
							class="form-control"
							ng-model="ministry.parent_id"
							ng-options="m.ministry_id as m.name for m in current.ministries | roleFilter:['leader','inherited_leader'] | orderBy:'name'">
							<option value="">No Parent Ministry</option>
						</select>
					</div>
				</div>

                <div class="form-group row">
                    <label class="col-sm-4 control-label">MCCs:</label>

                    <div class="col-sm-8">
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" ng-model="ministry.has_ds">
                                Digital Strategies
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" ng-model="ministry.has_gcm">
                                Global Church Movements
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" ng-model="ministry.has_llm">
                                Leader Led
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" ng-model="ministry.has_slm">
                                Student Led
                            </label>
                        </div>
                    </div>
                </div>

                <div class="form-group row">
                    <label class="col-sm-4 control-label">Privacy:</label>

                    <div class="col-sm-8">
                        <div class="checkbox">
                            <label>
                                <input type="checkbox" ng-model="ministry.private">
                                Private Ministry
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="panel-footer">
                <button type="button" class="btn btn-primary pull-right" ng-click="saveDetails()" ng-disabled="saveDetailsResource && !saveDetailsResource.$resolved">Save Ministry</button>
                <div class="clearfix"></div>
            </div>
        </div>
    </div>

</div>

<script type="text/ng-template" id="add_team_member.html">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" ng-click="close()">
                <span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <h4 class="modal-title">Add a new Team Member</h4>
        </div>
        <div class="modal-body form-horizontal">
            <div class="form-group">
                <label for="tbUserName" class="col-sm-4 control-label">TheKey username:</label>

                <div class="col-sm-8">
                    <input id="tbUserName" type="email" class="form-control" placeholder="e.g. user@ccci.org" ng-model="newMember.username" />
                </div>

            </div>
            <div class="form-group">
                <label class="col-sm-4 control-label">Role</label>

                <div class="col-sm-8">
                    <select class="form-control" style="width: 150px;" ng-model="newMember.team_role" ng-options="r.value as r.text for r  in roles"></select>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" ng-click="close()">Close</button>
            <button type="button" class="btn btn-primary" ng-click="add()">Save changes</button>
        </div>
    </div>
</script>

<script type="text/ng-template" id="add_sub_ministry.html">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" ng-click="close()">
                <span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <h4 class="modal-title">Add a new Sub Ministry</h4>
        </div>
        <div class="modal-body form-horizontal">
            <div class="form-group">
                <label for="sbName" class="col-sm-4 control-label">Ministry name:</label>

                <div class="col-sm-8">
                    <input id="sbName" type="text" class="form-control" ng-model="newMinistry.name" />
                </div>
            </div>
            <div class="form-group">
                <label for="sbCode" class="col-sm-4 control-label">Ministry code:</label>

                <div class="col-sm-8">
                    <input id="sbCode" type="text" class="form-control" ng-model="newMinistry.min_code" />
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" ng-click="close()">Close</button>
            <button type="button" class="btn btn-primary" ng-click="add()">Create</button>
        </div>
    </div>
</script>

<script type="text/ng-template" id="add_measurement_type.html">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" ng-click="close()">
                <span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <h4 class="modal-title">Add Measurement</h4>
        </div>
        <div class="modal-body form-horizontal">
            <div class="form-group">
                <label for="newMeasurementName" class="col-sm-4 control-label">Name:</label>

                <div class="col-sm-8">
                    <input id="newMeasurementName" type="text" class="form-control" ng-model="newMeasurement.english" />
                </div>
            </div>
            <div class="form-group">
                <label for="newMeasurementPermalink" class="col-sm-4 control-label">Permalink:</label>

                <div class="col-sm-8">
                    <input id="newMeasurementPermalink" type="text" class="form-control" ng-model="newMeasurement.perm_link_stub" />
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-4 control-label">Column:</label>

                <div class="col-sm-8">
                    <select class="form-control" style="width: 150px;" ng-model="newMeasurement.column">
                        <option value="faith">Faith</option>
                        <option value="fruit">Fruit</option>
                        <option value="outcome">Outcome</option>
                        <option value="other">Other</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-4 control-label">Section:</label>

                <div class="col-sm-8">
                    <select class="form-control" style="width: 150px;" ng-model="newMeasurement.section">
                        <option value="win">Win</option>
                        <option value="build">Build</option>
                        <option value="send">Send</option>
                        <option value="other">Other</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" ng-click="close()">Close</button>
            <button type="button" class="btn btn-primary" ng-click="add()">Create</button>
        </div>
    </div>
</script>
